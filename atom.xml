<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Lee çš„ç¬”è®°æœ¬</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://davidleee.com/"/>
  <updated>2021-03-05T06:03:51.581Z</updated>
  <id>http://davidleee.com/</id>
  
  <author>
    <name>Lee</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>å¤šå–æ°´æŠ€æœ¯æ”¯æŒ</title>
    <link href="http://davidleee.com/2021/03/05/techsupport-drinkmore/"/>
    <id>http://davidleee.com/2021/03/05/techsupport-drinkmore/</id>
    <published>2021-03-05T05:52:42.000Z</published>
    <updated>2021-03-05T06:03:51.581Z</updated>
    
    <content type="html"><![CDATA[<p><img src="/uploads/techsupport-drinkmore/drinkmore-presentation.png" alt></p><a id="more"></a><p>ä½ æ˜¯å¦æ›¾ç»æœ‰è¿‡è¿™æ ·çš„å›°æ‰°ï¼š<br>ç™½å¤©æ°´å–å°‘äº†æˆ–è€…åƒå’¸äº†å¯¼è‡´æ™šä¸Šç¡å‰æ€»å£æ¸´ï¼Œ<br>ä½†æ˜¯ç¡å‰æ°´å–å¤šäº†åˆä¼šå¯¼è‡´ç¡ç€ä¹‹åè€èµ·å¤œï¼Ÿ</p><p>å¤šå–æ°´ å°±æ˜¯æ¥å¸®ä½ è§£å†³èº«ä½“æ°´å¹³è¡¡é—®é¢˜çš„ï¼Œè®©ä½ çš„èº«ä½“ä»æ­¤æ°´åˆ†æ»¡æ»¡æ²¡çƒ¦æ¼ï¼</p><p>== åŠŸèƒ½ ==</p><ul><li>ç§‘å­¦è®¡ç®—ä½ æ‰€éœ€çš„å–æ°´é‡</li><li>åœ¨åˆé€‚çš„æ—¶æœºæé†’ä½ å–æ°´</li><li>æ–¹ä¾¿å¿«æ·åœ°è®°å½•æ¯æ¬¡æ°´åˆ†æ‘„å…¥</li><li>è®©ä½ ä¸€ç›®äº†ç„¶è‡ªå·±è¿‡å»çš„è¡¨ç°</li></ul><p>è·å–æŠ€æœ¯æ”¯æŒï¼š</p><ul><li>é‚®ä»¶ï¼šonetap@foxmail.com</li><li>æˆ–ç›´æ¥åœ¨ä¸‹æ–¹è¯„è®ºåŒºæµè¨€</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;&lt;img src=&quot;/uploads/techsupport-drinkmore/drinkmore-presentation.png&quot; alt&gt;&lt;/p&gt;
    
    </summary>
    
    
      <category term="æŠ€æœ¯æ”¯æŒ" scheme="http://davidleee.com/tags/%E6%8A%80%E6%9C%AF%E6%94%AF%E6%8C%81/"/>
    
      <category term="å¤šå–æ°´" scheme="http://davidleee.com/tags/%E5%A4%9A%E5%96%9D%E6%B0%B4/"/>
    
  </entry>
  
  <entry>
    <title>éšç§åè®®</title>
    <link href="http://davidleee.com/2021/03/05/privacy/"/>
    <id>http://davidleee.com/2021/03/05/privacy/</id>
    <published>2021-03-05T05:44:12.000Z</published>
    <updated>2021-03-05T05:45:59.947Z</updated>
    
    <content type="html"><![CDATA[<p>æœ¬è½¯ä»¶å°Šé‡å¹¶ä¿æŠ¤æ‰€æœ‰ä½¿ç”¨æœåŠ¡ç”¨æˆ·çš„ä¸ªäººéšç§æƒã€‚ä¸ºäº†ç»™æ‚¨æä¾›æ›´å‡†ç¡®ã€æ›´æœ‰ä¸ªæ€§åŒ–çš„æœåŠ¡ï¼Œæœ¬è½¯ä»¶ä¼šæŒ‰ç…§æœ¬éšç§æƒæ”¿ç­–çš„è§„å®šä½¿ç”¨å’ŒæŠ«éœ²æ‚¨çš„ä¸ªäººä¿¡æ¯ã€‚ä½†æœ¬è½¯ä»¶å°†ä»¥é«˜åº¦çš„å‹¤å‹‰ã€å®¡æ…ä¹‰åŠ¡å¯¹å¾…è¿™äº›ä¿¡æ¯ã€‚é™¤æœ¬éšç§æƒæ”¿ç­–å¦æœ‰è§„å®šå¤–ï¼Œåœ¨æœªå¾å¾—æ‚¨äº‹å…ˆè®¸å¯çš„æƒ…å†µä¸‹ï¼Œæœ¬è½¯ä»¶ä¸ä¼šå°†è¿™äº›ä¿¡æ¯å¯¹å¤–æŠ«éœ²æˆ–å‘ç¬¬ä¸‰æ–¹æä¾›ã€‚æœ¬è½¯ä»¶ä¼šä¸æ—¶æ›´æ–°æœ¬éšç§æƒæ”¿ç­–ã€‚æ‚¨åœ¨åŒæ„æœ¬è½¯ä»¶æœåŠ¡ä½¿ç”¨åè®®ä¹‹æ—¶ï¼Œå³è§†ä¸ºæ‚¨å·²ç»åŒæ„æœ¬éšç§æƒæ”¿ç­–å…¨éƒ¨å†…å®¹ã€‚æœ¬éšç§æƒæ”¿ç­–å±äºæœ¬è½¯ä»¶æœåŠ¡ä½¿ç”¨åè®®ä¸å¯åˆ†å‰²çš„ä¸€éƒ¨åˆ†ã€‚</p><p>1.é€‚ç”¨èŒƒå›´</p><p>a)åœ¨æ‚¨ä½¿ç”¨æœ¬è½¯ä»¶ç½‘ç»œæœåŠ¡ï¼Œæœ¬è½¯ä»¶è‡ªåŠ¨æ¥æ”¶å¹¶è®°å½•çš„æ‚¨çš„æ‰‹æœºä¸Šçš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºæ‚¨çš„å¥åº·æ•°æ®ã€ä½¿ç”¨çš„è¯­è¨€ã€è®¿é—®æ—¥æœŸå’Œæ—¶é—´ã€è½¯ç¡¬ä»¶ç‰¹å¾ä¿¡æ¯åŠæ‚¨éœ€æ±‚çš„ç½‘é¡µè®°å½•ç­‰æ•°æ®ï¼›</p><p>2.ä¿¡æ¯çš„ä½¿ç”¨</p><p>a)åœ¨è·å¾—æ‚¨çš„æ•°æ®ä¹‹åï¼Œæœ¬è½¯ä»¶ä¼šå°†å…¶ä¸Šä¼ è‡³æœåŠ¡å™¨ï¼Œä»¥ç”Ÿæˆæ‚¨çš„æ’è¡Œæ¦œæ•°æ®ï¼Œä»¥ä¾¿æ‚¨èƒ½å¤Ÿæ›´å¥½åœ°ä½¿ç”¨æœåŠ¡ã€‚</p><p>3.ä¿¡æ¯æŠ«éœ²</p><p>a)æœ¬è½¯ä»¶ä¸ä¼šå°†æ‚¨çš„ä¿¡æ¯æŠ«éœ²ç»™ä¸å—ä¿¡ä»»çš„ç¬¬ä¸‰æ–¹ã€‚</p><p>b)æ ¹æ®æ³•å¾‹çš„æœ‰å…³è§„å®šï¼Œæˆ–è€…è¡Œæ”¿æˆ–å¸æ³•æœºæ„çš„è¦æ±‚ï¼Œå‘ç¬¬ä¸‰æ–¹æˆ–è€…è¡Œæ”¿ã€å¸æ³•æœºæ„æŠ«éœ²ï¼›</p><p>c)å¦‚æ‚¨å‡ºç°è¿åä¸­å›½æœ‰å…³æ³•å¾‹ã€æ³•è§„æˆ–è€…ç›¸å…³è§„åˆ™çš„æƒ…å†µï¼Œéœ€è¦å‘ç¬¬ä¸‰æ–¹æŠ«éœ²ï¼›</p><p>4.ä¿¡æ¯å­˜å‚¨å’Œäº¤æ¢</p><p>æœ¬è½¯ä»¶æ”¶é›†çš„æœ‰å…³æ‚¨çš„ä¿¡æ¯å’Œèµ„æ–™å°†ä¿å­˜åœ¨æœ¬è½¯ä»¶åŠï¼ˆæˆ–ï¼‰å…¶å…³è”å…¬å¸çš„æœåŠ¡å™¨ä¸Šï¼Œè¿™äº›ä¿¡æ¯å’Œèµ„æ–™å¯èƒ½ä¼ é€è‡³æ‚¨æ‰€åœ¨å›½å®¶ã€åœ°åŒºæˆ–æœ¬è½¯ä»¶æ”¶é›†ä¿¡æ¯å’Œèµ„æ–™æ‰€åœ¨åœ°çš„å¢ƒå¤–å¹¶åœ¨å¢ƒå¤–è¢«è®¿é—®ã€å­˜å‚¨å’Œå±•ç¤ºã€‚</p><p>5.ä¿¡æ¯å®‰å…¨</p><p>a)åœ¨ä½¿ç”¨æœ¬è½¯ä»¶ç½‘ç»œæœåŠ¡è¿›è¡Œç½‘ä¸Šäº¤æ˜“æ—¶ï¼Œæ‚¨ä¸å¯é¿å…çš„è¦å‘äº¤æ˜“å¯¹æ–¹æˆ–æ½œåœ¨çš„äº¤æ˜“å¯¹æ–¹æŠ«éœ²è‡ªå·±çš„ä¸ªäººä¿¡æ¯ï¼Œå¦‚è”ç»œæ–¹å¼æˆ–è€…é‚®æ”¿åœ°å€ã€‚è¯·æ‚¨å¦¥å–„ä¿æŠ¤è‡ªå·±çš„ä¸ªäººä¿¡æ¯ï¼Œä»…åœ¨å¿…è¦çš„æƒ…å½¢ä¸‹å‘ä»–äººæä¾›ã€‚å¦‚æ‚¨å‘ç°è‡ªå·±çš„ä¸ªäººä¿¡æ¯æ³„å¯†ï¼Œè¯·æ‚¨ç«‹å³è”ç»œæœ¬è½¯ä»¶å®¢æœï¼Œä»¥ä¾¿æœ¬è½¯ä»¶é‡‡å–ç›¸åº”æªæ–½ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æœ¬è½¯ä»¶å°Šé‡å¹¶ä¿æŠ¤æ‰€æœ‰ä½¿ç”¨æœåŠ¡ç”¨æˆ·çš„ä¸ªäººéšç§æƒã€‚ä¸ºäº†ç»™æ‚¨æä¾›æ›´å‡†ç¡®ã€æ›´æœ‰ä¸ªæ€§åŒ–çš„æœåŠ¡ï¼Œæœ¬è½¯ä»¶ä¼šæŒ‰ç…§æœ¬éšç§æƒæ”¿ç­–çš„è§„å®šä½¿ç”¨å’ŒæŠ«éœ²æ‚¨çš„ä¸ªäººä¿¡æ¯ã€‚ä½†æœ¬è½¯ä»¶å°†ä»¥é«˜åº¦çš„å‹¤å‹‰ã€å®¡æ…ä¹‰åŠ¡å¯¹å¾…è¿™äº›ä¿¡æ¯ã€‚é™¤æœ¬éšç§æƒæ”¿ç­–å¦æœ‰è§„å®šå¤–ï¼Œåœ¨æœªå¾å¾—æ‚¨äº‹å…ˆè®¸å¯çš„æƒ…å†µä¸‹ï¼Œæœ¬è½¯ä»¶ä¸ä¼šå°†è¿™äº›ä¿¡æ¯å¯¹å¤–æŠ«éœ²æˆ–å‘ç¬¬ä¸‰
      
    
    </summary>
    
    
      <category term="åè®®" scheme="http://davidleee.com/tags/%E5%8D%8F%E8%AE%AE/"/>
    
  </entry>
  
  <entry>
    <title>åœ¨ macOS ä¸­å¦‚ä½•ä½¿ç”¨ XPC å®ç°è·¨è¿›ç¨‹é€šè®¯ï¼Ÿ</title>
    <link href="http://davidleee.com/2020/07/20/ipc-for-macOS/"/>
    <id>http://davidleee.com/2020/07/20/ipc-for-macOS/</id>
    <published>2020-07-20T04:45:38.000Z</published>
    <updated>2020-08-09T14:42:54.698Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘éœ€è¦åœ¨ Electron é¡¹ç›®ä¸Šå¼•å…¥ä¸€ä¸ªæ¯”è¾ƒåƒæ€§èƒ½çš„å¤§å¤´åŠŸèƒ½ï¼Œå› ä¸ºå·²ç»ç”¨ Objective-C å®ç°è¿‡ä¸€å¥—ç¨³å®šä¸”æ€§èƒ½ä¹Ÿå¯æ¥å—çš„å¸¦ UI æ–¹æ¡ˆäº†ï¼Œæ‰€ä»¥è®¡åˆ’çœ‹çœ‹èƒ½ä¸èƒ½å°†è¿™å¥—ç°æˆçš„æ–¹æ¡ˆç›´æ¥ç”¨åˆ° Electron é‡Œã€‚ä½†æƒ³è¦è¿™ä¹ˆåšå°±å¿…é¡»è§£å†³åŸç”Ÿ UI ä¸ Electron é€šè®¯çš„é—®é¢˜ï¼Œå†è¿›ä¸€æ­¥ï¼Œèƒ½ä¸èƒ½è®© Electron ä»¥å¤šè¿›ç¨‹çš„æ–¹å¼è°ƒèµ·è¿™ä¸ªå¤§å¤´åŠŸèƒ½çš„ Demo ä»¥èŠ‚çœæ‰ç»å¤§éƒ¨åˆ†çš„é‡å¤å·¥ä½œå‘¢ï¼Ÿ</p><blockquote><p>æœ¬æ–‡åªç ”ç©¶äº†åŸç”Ÿ XPC é€šè®¯çš„éƒ¨åˆ†ï¼Œå…³äºé›†æˆåˆ° Electron é‡Œè¿˜æœ‰å“ªäº›å‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« é‡Œè®²è®²</p></blockquote><a id="more"></a><h2 id="ä»€ä¹ˆæ˜¯-xpc">ä»€ä¹ˆæ˜¯ XPC</h2><blockquote><p>é€‰å‹çš„è¿‡ç¨‹ä¸æ˜¯è¿™æ¬¡è¦è®¨è®ºçš„é‡ç‚¹ï¼Œå°±å½“ä½œæˆ‘ä»¬ç»è¿‡ä¸€ç•ªæŒ£æ‰ç„¶åé€‰æ‹©äº†åŸç”Ÿçš„ XPC å®ç°å§ï¼šï¼‰</p></blockquote><p>XPC æ˜¯è‹¹æœå®˜æ–¹æä¾›çš„ä¸€ç§è¿›ç¨‹é—´é€šè®¯çš„æ‰‹æ®µï¼Œæ˜¯ä¸€ç§è‹¹æœç‰¹æœ‰çš„ IPC æŠ€æœ¯ã€‚</p><p>åœ¨ NSHipster çš„<a href="https://nshipster.com/inter-process-communication/" target="_blank" rel="noopener">ä¸€ç¯‡æ–‡ç« </a>é‡Œï¼Œä½œè€…è¯´ XPC æ˜¯å®˜æ–¹ SDK å†…è·¨è¿›ç¨‹é€šè®¯çš„æœ€ä¼˜è§£å†³æ–¹æ¡ˆï¼ˆ2014ï¼‰ã€‚ä» 2011 å¹´è¢«æå‡ºçš„æ—¶å€™ï¼ŒXPC å°±æŒç»­åœ¨â€œä½“åˆ¶å†…â€å‘å…‰å‘çƒ­ï¼Œæ¯”å¦‚ macOS çš„æ²™ç›’ã€iOS çš„ Remote View Controller å’Œä¸¤ä¸ªå¹³å°ä¸Šéƒ½æœ‰çš„åº”ç”¨æ‰©å±•ï¼ˆApp Extensionsï¼‰é‡Œéƒ½ç”¨åˆ°äº† XPC çš„æŠ€æœ¯ã€‚</p><p>å¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œä½¿ç”¨ XPC æŠ€æœ¯æˆ‘ä»¬å°±èƒ½åšåˆ°åƒè¿™æ ·çš„äº‹æƒ…ï¼š</p><ol><li>æ¨¡å— A è´Ÿè´£ UI å±•ç¤ºï¼Œå®ƒ<strong>ä¸éœ€è¦ç”³è¯·ä»»ä½•ç³»ç»Ÿæƒé™</strong>ï¼Œç”¨åˆ°ç½‘ç»œå›¾ç‰‡æ—¶å°±å‘æ¨¡å— B è·å–</li><li>æ¨¡å— B æ‹¥æœ‰<strong>ç½‘ç»œæƒé™</strong>ï¼Œèƒ½ä»ç½‘ç»œæˆ–ç¼“å­˜ä¸­è·å–å›¾ç‰‡ï¼Œä½†æ“ä½œæ–‡ä»¶ç³»ç»Ÿçš„å·¥ä½œç”±æ¨¡å— C è´Ÿè´£</li><li>æ¨¡å— C æ‹¥æœ‰<strong>æ–‡ä»¶è¯»å†™æƒé™</strong>ï¼Œè´Ÿè´£å°†æ•°æ®å†™æˆæ–‡ä»¶æˆ–è¯»å–æ–‡ä»¶æ•°æ®</li><li>è¿™ä¸‰ä¸ªæ¨¡å—éƒ½åœ¨åŒä¸€ä¸ªåº”ç”¨ä¸­ï¼Œå®ƒä»¬æ‰€éœ€è¦çš„æƒé™ç›¸äº’ç‹¬ç«‹ï¼ŒåŠŸèƒ½å•ä¸€ï¼Œè€Œä¸”å³ä½¿å´©æºƒäº†ä¹Ÿä¸ä¼šç›¸äº’å½±å“ï¼Œåªéœ€è¦é‡å¯ç›¸åº”çš„æ¨¡å—å°±åˆå¯ä»¥æ¢å¤æ­£å¸¸ä½¿ç”¨</li></ol><p>çœ‹å®Œæ˜¯ä¸æ˜¯å·²ç»è¿«ä¸åŠå¾…äº†å‘¢ï¼Ÿåˆ«ç€æ€¥ï¼Œåœ¨ä½¿ç”¨è¿™ä¸ªå¼ºå¤§å·¥å…·å‰ï¼Œæˆ‘ä»¬è¿˜éœ€è¦äº†è§£ä¸¤ä¸ªå…³é”®æŠ€æœ¯ã€‚</p><h3 id="é¢˜å¤–è¯1-launchd">é¢˜å¤–è¯1 - launchd</h3><p><code>launchd</code> è´Ÿè´£ç®¡ç† macOS ä¸Šçš„å®ˆæŠ¤è¿›ç¨‹ï¼Œåœ¨æ„å»º XPC æ–¹æ¡ˆçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¼šç”¨å®ƒæ¥é…ç½®ä¸€ä¸ªæˆ‘ä»¬è‡ªå·±çš„å®ˆæŠ¤è¿›ç¨‹ã€‚</p><p>è¿™ä¸ªå®ˆæŠ¤è¿›ç¨‹ä¼šä¸€ç›´æ½œä¼åœ¨ç³»ç»Ÿé‡Œï¼ˆåªå ç”¨éå¸¸å°‘çš„èµ„æºï¼‰ï¼Œå½“æˆ‘ä»¬çš„åº”ç”¨éœ€è¦å®ƒçš„æ—¶å€™å°±å¯ä»¥è¢«éšæ—¶å”¤é†’ã€‚</p><p>æ›´å¤š <code>launchd</code> çš„ä¿¡æ¯å’Œç”¨æ³•å¯ä»¥åœ¨å®ƒçš„<a href="x-man-page://5/launchd.plist" target="_blank" rel="noopener">man é¡µé¢</a>æ‰¾åˆ°ã€‚</p><h3 id="é¢˜å¤–è¯2-smjobbless">é¢˜å¤–è¯2 - SMJobBless</h3><p>å­—é¢æ„æ€æ˜¯â€œç»™ä»»åŠ¡åŠ ä¸Šç¥ç¦â€ï¼Œä»»ä½•åº”ç”¨éƒ½ä¸èƒ½è·Ÿä¸€ä¸ªæ²¡æœ‰è¢«ç³»ç»Ÿç¥ç¦çš„ä»»åŠ¡æ„‰å¿«åœ°ç©è€ã€‚</p><p>è¿™æ˜¯ä¸€ç»„ååŠ©å¼€å‘è€…å®‰å…¨åœ°å®‰è£…å®ˆæŠ¤è¿›ç¨‹çš„ APIï¼Œé•¿è¿™ä¸ªæ ·å­ï¼š</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Boolean SMJobBless(<span class="built_in">CFStringRef</span> domain, <span class="built_in">CFStringRef</span> executableLabel, AuthorizationRef auth, <span class="built_in">CFErrorRef</span> *outError);</span><br></pre></td></tr></table></figure><p>è‹¹æœä¼¼ä¹ä¹Ÿè®¤ä¸ºè¿™ç»„ API çš„ç”¨æ³•åªå¯æ„ä¼šä¸å¯è¨€ä¼ ï¼Œæ‰€ä»¥åœ¨<a href="https://developer.apple.com/documentation/servicemanagement/1431078-smjobbless?language=objc" target="_blank" rel="noopener">SMJobBless çš„æ–¹æ³•è¯´æ˜</a>é‡Œå†™äº†å¾ˆå¤šï¼Œè¿˜ç»™å‡ºäº†ä¸€ä¸ªå¾ˆå®Œæ•´çš„<a href="http://developer.apple.com/library/mac/#samplecode/SMJobBless/" target="_blank" rel="noopener">ç¤ºä¾‹å·¥ç¨‹</a>å¹¶é€šè¿‡ä¸€ä¸ª <a href="https://developer.apple.com/library/archive/samplecode/SMJobBless/Listings/SMJobBlessUtil_py.html#//apple_ref/doc/uid/DTS40010071-SMJobBlessUtil_py-DontLinkElementID_8" target="_blank" rel="noopener">Python è„šæœ¬</a>æŠŠå®‰è£…å®ˆæŠ¤è¿›ç¨‹çš„å‰ç½®æ¡ä»¶ç»™é…ç½®å¥½äº†ã€‚</p><blockquote><p>è„šæœ¬è¿™ä¸ªåŠ¨ä½œï¼Œè™½ç„¶è®©æ•´ä¸ªæµç¨‹å˜å¾—æ›´åŠ å®Œå–„ï¼Œä½†å´å°†åŸæœ¬åªè¦å‡ å¥å‘½ä»¤å°±èƒ½è§£å†³çš„äº‹æƒ…å¤æ‚åŒ–äº†ï¼Œå°‘äº†ä¸€äº›è‹¹æœå‘³ã€‚</p></blockquote><h2 id="æ¶èµ·é€šè®¯çš„æ¡¥æ¢">æ¶èµ·é€šè®¯çš„æ¡¥æ¢</h2><p>å†™äº†è¿™ä¹ˆå¤šï¼Œå…¶å®éƒ½è¿˜åœ¨ <strong>Prerequisites</strong> é˜¶æ®µæ‰“è½¬è½¬ã€‚æ¥ä¸‹æ¥æ‰è¦æ­£å¼å¼€å§‹è·¨åº”ç”¨é€šè®¯çš„å®ç°ï¼</p><p>ä¸è¿‡åœ¨æ­¤ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜æ˜¯å…ˆæŠŠä¸Šæ–‡é¢˜å¤–è¯é‡Œæåˆ°çš„å‰ç½®æ¡ä»¶å‡†å¤‡å¥½ï¼Œè®©åé¢çš„è¿‡ç¨‹æ›´é¡ºç•…ä¸€äº›ã€‚</p><h3 id="å‰ç½®å‡†å¤‡">å‰ç½®å‡†å¤‡</h3><p>é€šè¿‡ <code>launchd</code> å®‰è£…å®ˆæŠ¤è¿›ç¨‹æ˜¯ä¸ªéœ€è¦å¾ˆé«˜å®‰å…¨æ€§çš„åŠ¨ä½œï¼Œæ‰€ä»¥åº”ç”¨ç­¾åæ˜¯å¿…ä¸å¯å°‘çš„ã€‚è€Œå¯¹äºä¸€ä¸ªè·¨åº”ç”¨é€šè®¯çš„ç³»ç»Ÿæ¥è¯´ï¼Œå®‰å…¨æ€§ä¸»è¦æ¶‰åŠåˆ°ä¸¤ä¸ªéƒ¨åˆ†ï¼š</p><ul><li>é€šè®¯å‘èµ·æ–¹</li><li>XPC åº”ç”¨</li></ul><blockquote><p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œé€šè®¯çš„æ¥æ”¶æ–¹ä¸è´Ÿè´£ XPC åº”ç”¨çš„å®‰è£…ï¼Œæ‰€ä»¥å®ƒåªè¦ç®¡å¥½è‡ªå·±çš„ç­¾åå°±å¤Ÿäº†</p></blockquote><p>è¿™é‡Œæˆ‘ä»¬å°±è¦ç”¨ä¸Šå‰é¢æåˆ°çš„ Python è„šæœ¬é‡Œçš„ä¸€å¥å…³é”®å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">codesign -d -r - /path/to/file.app</span><br></pre></td></tr></table></figure><blockquote><p>è™½ç„¶å®˜æ–¹ Demo é‡Œçš„è¿™ä¸ªè„šæœ¬è¿˜åšäº†è®¸å¤šå…¶ä»–çš„æ£€éªŒæ¥ç¡®ä¿ä¿¡æ¯çš„å®Œæ•´å’Œæ­£ç¡®ï¼Œä½†å¯¹äºæˆ‘ä»¬è¿™æ ·æˆç†Ÿçš„ï¼ˆå˜¿å˜¿ï¼‰å¼€å‘è€…æ¥è¯´ï¼Œå½“ç„¶è¦ç›´æ¥è–…æœ€çè´µçš„ç¾Šæ¯›å•¦ã€‚</p></blockquote><p>æŠŠè¿™ä¸ªå‘½ä»¤çš„è·¯å¾„å‚æ•°æ”¹ä¸ºæˆ‘ä»¬å·²ç»ç­¾å¥½åçš„åº”ç”¨ï¼Œä¼šå¾—åˆ°åƒè¿™æ ·å­çš„è¾“å‡ºï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Executable=/path/to/file.app</span><br><span class="line">designated =&gt; anchor apple generic and identifier &quot;com.example.apple-samplecode.EBAS.App&quot; and (certificate leaf[field.1.2.840.113635.100.6.1.9] /* exists */ or certificate 1[field.1.2.840.113635.100.6.2.6] /* exists */ and certificate leaf[field.1.2.840.113635.100.6.1.13] /* exists */ and certificate leaf[subject.OU] = SKMME9E2Y8)</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ<code>designated =&gt;</code> åé¢çš„éƒ¨åˆ†ï¼ˆä¾‹å­é‡Œæ˜¯ä» â€œanchorâ€ å¼€å§‹ï¼Œæˆ‘ä»¬è‡ªå·±ç­¾åçš„è¯å¼€å¤´å¯èƒ½æ˜¯â€œidentifierâ€ï¼Œè¿™ä¸ªé¡ºåºå¹¶ä¸è¦ç´§ï¼‰å°±æ˜¯æˆ‘ä»¬éœ€è¦çš„â€œç­¾åéœ€æ±‚â€ï¼ˆCode Signing Requirementï¼‰ã€‚</p><p>æŠŠç­¾åéœ€æ±‚æ”¾åˆ°æˆ‘ä»¬è‡ªå·±çš„ XPC åº”ç”¨çš„ Info.plist é‡Œï¼Œå¦‚æ­¤ä¸€æ¥è¿™ä¸ª XPC åº”ç”¨å°±åªèƒ½è¢«æ‹¥æœ‰è¿™ä¸ªç­¾åçš„åº”ç”¨å¯åŠ¨äº†ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>SMAuthorizedClients<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">array</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>anchor apple generic and identifier "com.example.apple-samplecode.EBAS.App" and (certificate leaf[field.1.2.840.113635.100.6.1.9] /* exists */ or certificate 1[field.1.2.840.113635.100.6.2.6] /* exists */ and certificate leaf[field.1.2.840.113635.100.6.1.13] /* exists */ and certificate leaf[subject.OU] = SKMME9E2Y8)<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">array</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œçš„ value æ˜¯æ•°ç»„æ ¼å¼çš„ï¼Œæ„å‘³ç€å¦‚æœæƒ³å…è®¸å¤šä¸ª App å¯åŠ¨è¿™ä¸ª XPC åº”ç”¨çš„è¯ï¼Œå°±éœ€è¦æŠŠè¿™äº› App çš„ç­¾åéœ€æ±‚éƒ½å†™ä¸Šã€‚</p><p>åŒç†ï¼Œè¿˜è¦å–åˆ° XPC åº”ç”¨çš„ç­¾åéœ€æ±‚å¹¶é…åˆ°æˆ‘ä»¬å®¢æˆ·ç«¯çš„ Info.plist é‡Œï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>SMPrivilegedExecutables<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>com.example.apple-samplecode.EBAS.HelperTool<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>anchor apple generic and identifier "com.example.apple-samplecode.EBAS.HelperTool" and (certificate leaf[field.1.2.840.113635.100.6.1.9] /* exists */ or certificate 1[field.1.2.840.113635.100.6.2.6] /* exists */ and certificate leaf[field.1.2.840.113635.100.6.1.13] /* exists */ and certificate leaf[subject.OU] = SKMME9E2Y8)<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ³¨æ„è¿™ä¸ª â€œdictâ€ é‡Œçš„ â€œkeyâ€ è¦å¡«çš„æ˜¯æˆ‘ä»¬çš„ XPC åº”ç”¨çš„ labelï¼Œä¸è¿‡å› ä¸º label é€šå¸¸ä¼šå®šæˆè·Ÿ Bundle Identifier ä¸€è‡´ï¼Œæ‰€ä»¥å†™ä¸Šå®ƒçš„ Bundle Identifier ä¹Ÿå°±å¯ä»¥äº†ã€‚</p><blockquote><p>ä¸Šä¸€æ®µå•°å—¦äº†ä¸€ä¸‹æ˜¯å› ä¸º label å…¶å®å¯ä»¥è·Ÿ Bundle Identifier ä¸åŒçš„ï¼Œä½†è¿™ä¼šç»™å¼€å‘çš„è¿‡ç¨‹å¸¦æ¥è®¸å¤šéº»çƒ¦ï¼Œæ‰€ä»¥å»ºè®®è¿˜æ˜¯ç»Ÿä¸€ã€‚è¿™ä¸ª label å…·ä½“æ˜¯ä»€ä¹ˆé¬¼ä¼šåœ¨ä¸‹ä¸€ä¸ªå°èŠ‚é‡Œè®²åˆ°ã€‚</p></blockquote><h3 id="åˆ›å»º-å®‰è£…-xpc-åº”ç”¨">åˆ›å»º &amp; å®‰è£… XPC åº”ç”¨</h3><p>é¦–å…ˆæ¥æ·»åŠ ä¸€ä¸ª Target å¹¶é€‰æ‹© XPC Serviceï¼Œè®© Xcode å¸®æˆ‘ä»¬ç”Ÿæˆä¸€äº›é»˜è®¤ä»£ç ï¼š<br><img src="/uploads/ipc-for-macOS/create_target.png" alt></p><p>ç„¶åä¸ºæˆ‘ä»¬çš„ XPC åº”ç”¨å†åˆ›å»ºä¸€ä¸ª plistï¼Œè¿™ä¸ªæ–‡ä»¶ä¼šåœ¨ XPC åº”ç”¨è¢«å®‰è£…çš„æ—¶å€™è‡ªåŠ¨æ‹·è´åˆ° <em>/Library/LaunchDaemons</em> ç›®å½•ä¸‹ï¼Œè¿™æ˜¯ç»Ÿä¸€å­˜æ”¾å®ˆæŠ¤è¿›ç¨‹é…ç½®æ–‡ä»¶çš„åœ°æ–¹ã€‚</p><p>ä¸ºäº†ä¸é»˜è®¤çš„ Info.plist åŒºåˆ†å¼€æ¥ï¼Œåœ¨æ–‡ä»¶çš„åå­—é‡ŒåŠ ä¸Šä¸ª â€œLaunchdâ€ï¼Œæ–‡ä»¶å†…å®¹æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">plist</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//Apple//DTD PLIST 1.0//EN"</span> <span class="meta-string">"http://www.apple.com/DTDs/PropertyList-1.0.dtd"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plist</span> <span class="attr">version</span>=<span class="string">"1.0"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>Label<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">string</span>&gt;</span>com.example.apple-samplecode.EBAS.HelperTool<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>MachServices<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">key</span>&gt;</span>com.example.apple-samplecode.EBAS.HelperTool<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plist</span>&gt;</span></span><br></pre></td></tr></table></figure><p>çœ‹ï¼Œå‰é¢åŸ‹çš„å‘â€”â€” <strong>Label</strong> å‡ºç°äº†ï¼è¿™æ˜¯ç³»ç»Ÿç”¨æ¥å”¯ä¸€æ ‡è¯†å®ˆæŠ¤è¿›ç¨‹çš„å€¼ï¼Œä¸‹é¢ MachServices ä¸­çš„ key æ˜¯æˆ‘ä»¬ XPC åº”ç”¨çš„ Bundle Identifierã€‚åœ¨å»ºç«‹è¿æ¥çš„æ—¶å€™ï¼Œç³»ç»Ÿå°±ä¼šæ ¹æ®è¿™å¼ é…ç½®è¡¨å»å¯»æ‰¾æ­£ç¡®çš„ XPC åº”ç”¨ã€‚</p><p>å®Œæˆåæˆ‘ä»¬çš„ç›®å½•ç»“æ„æ˜¯è¿™æ ·çš„ï¼šï¼ˆä¾‹å­æ¥è‡ªå®˜æ–¹çš„ <a href="https://developer.apple.com/library/archive/samplecode/EvenBetterAuthorizationSample/Introduction/Intro.html#//apple_ref/doc/uid/DTS40013768-Intro-DontLinkElementID_2" target="_blank" rel="noopener">EvenBetterAuthorizationSample</a>ï¼‰<br><img src="/uploads/ipc-for-macOS/9B514455-AC1D-454F-8681-34076024982E.png" alt></p><blockquote><p>å¦‚å›¾ï¼Œå®˜æ–¹ä¾‹å­ä¸­è¿˜ç»™ plist åŠ ä¸Šäº†é¡¹ç›®åå‰ç¼€ï¼Œä½†åå­—ä¸é‡è¦ï¼Œé‡è¦çš„æ˜¯åˆ«å¿˜äº†æŠŠç­¾åéœ€æ±‚å†™å¯¹ã€‚</p></blockquote><p>æœ€åï¼Œå› ä¸ºæˆ‘ä»¬è¦ç”¨åˆ°çš„äº§ç‰©æ˜¯ .xpc åŒ…é‡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ‰€ä»¥å¿…é¡»æŠŠè¿™ä¸¤ä¸ª plist ä¹Ÿæ‰“è¿›äºŒè¿›åˆ¶æ–‡ä»¶é‡Œå»ï¼Œè¿™å°±è¦åœ¨ Build Settings çš„ Other Linker Flags é‡Œé…ç½®ä¸€ä¸‹ï¼š<br><img src="/uploads/ipc-for-macOS/29AEBF92-9331-41E1-8EAB-04718FEFDB6C.png" alt></p><p>é…ç½®å†…å®¹å¦‚ä¸‹ï¼ŒæŠŠæœ€åçš„è·¯å¾„æ”¹æˆè‡ªå·±çš„ plist å°±å¯ä»¥äº†ï¼ˆè¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆå‰é¢è¯´æ–‡ä»¶åä¸é‡è¦ï¼‰ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-sectcreate __TEXT __info_plist HelperTool/HelperTool-Info.plist</span><br><span class="line">-sectcreate __TEXT __launchd_plist HelperTool/HelperTool-Launchd.plist</span><br></pre></td></tr></table></figure><p>å®Œæˆäº†è¿™äº›é…ç½®åæ‰“å‡ºæ¥çš„åŒ…ä¼šæ˜¯ä¸€ä¸ªå®Œæ•´çš„ .xpc æ–‡ä»¶äº†ï¼Œä½†æˆ‘ä»¬éœ€è¦çš„åªæ˜¯å®ƒé‡Œé¢çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚åœ¨ç”¨ä¸Šå®ƒä¹‹å‰ï¼Œè®©æˆ‘ä»¬æŠŠå®‰è£… XPC åº”ç”¨çš„ä»£ç å†™å¥½ï¼Œè¿™é‡Œçš„ä»£ç æ˜¯åœ¨å®˜æ–¹ä¾‹å­çš„åŸºç¡€ä¸Šæ”¹çš„ï¼Œä¸ªäººæ„Ÿè§‰æ¯”ä¾‹å­é‡Œçš„æ›´æ˜“æ‡‚ä¸€äº›ï¼š</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1</span></span><br><span class="line">AuthorizationItem authItem = &#123; kSMRightBlessPrivilegedHelper, <span class="number">0</span>, <span class="literal">NULL</span>, <span class="number">0</span> &#125;;</span><br><span class="line">AuthorizationRights authRights = &#123; <span class="number">1</span>, &amp;authItem &#125;;</span><br><span class="line">AuthorizationFlags flags = kAuthorizationFlagDefaults | kAuthorizationFlagInteractionAllowed | kAuthorizationFlagPreAuthorize | kAuthorizationFlagExtendRights;</span><br><span class="line"></span><br><span class="line">AuthorizationRef authRef = <span class="literal">NULL</span>;</span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line">OSStatus status = AuthorizationCreate(&amp;authRights, kAuthorizationEmptyEnvironment, flags, &amp;authRef);</span><br><span class="line"><span class="keyword">if</span> (status != errAuthorizationSuccess) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"Failed to create AuthorizationRef, return code %i"</span>, status);</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="built_in">CFErrorRef</span> error;</span><br><span class="line">    <span class="comment">// 3</span></span><br><span class="line">    <span class="built_in">BOOL</span> success = SMJobBless(kSMDomainSystemLaunchd, (__bridge <span class="built_in">CFStringRef</span>)<span class="string">@"com.example.apple-samplecode.EBAS.HelperTool"</span>, authRef, &amp;error);</span><br><span class="line">    <span class="keyword">if</span> (success) &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"job bless success"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">NSLog</span>(<span class="string">@"job bless error: %@"</span>, (__bridge <span class="built_in">NSError</span> *)error);</span><br><span class="line">        <span class="built_in">CFRelease</span>(error);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NO</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>æ„é€ ç”³è¯·æƒé™æ‰€éœ€è¦çš„å‚æ•°ï¼Œå®˜æ–¹ä¾‹å­ä¸­æ²¡æœ‰è¿™ä¸€æ­¥</li><li>ç”³è¯·æƒé™ï¼Œå¦‚æœè¿™ä¸€æ­¥å¤±è´¥äº†ï¼Œé‚£æˆ‘ä»¬çš„åº”ç”¨å°±ä¸èƒ½åšä»»ä½•éœ€è¦ç”¨æˆ·æˆæƒçš„æ“ä½œäº†ï¼›å®˜æ–¹ä¾‹å­ä¸­å› ä¸ºå°‘äº†æ„é€ å‚æ•°çš„æ­¥éª¤ï¼Œæ‰€ä»¥è¿™é‡Œä¼šå˜æˆ <code>AuthorizationCreate(NULL, NULL, 0, &amp;authRef)</code></li><li>ä½¿ç”¨é¢˜å¤–è¯é‡Œè®²åˆ°çš„ API æ¥å®‰è£…æˆ‘ä»¬çš„ XPC åº”ç”¨ï¼Œå…¶ä¸­ï¼Œ<code>kSMDomainSystemLaunchd</code> è¡¨ç¤ºæˆ‘ä»¬è¦ä½¿ç”¨ launchd æœåŠ¡ï¼ˆè¿™ä¹Ÿæ˜¯ç›®å‰ä»…æœ‰çš„å¯é€‰é¡¹ï¼‰ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æˆ‘ä»¬ä¹‹å‰è®¾ç½®çš„ XPC åº”ç”¨çš„ label</li></ol><p>å½“æ‰§è¡Œåˆ°ä¸Šé¢çš„é€»è¾‘æ—¶ï¼Œæˆ‘ä»¬ä»ä¸¤ä¸ªè§’åº¦æ¥çœ‹çœ‹ä¼šå‘ç”Ÿä»€ä¹ˆï¼š</p><ul><li>ç”¨æˆ·è§’åº¦ï¼šç•Œé¢ä¸Šå¼¹å‡ºä¸€ä¸ªæˆæƒæ¡†ï¼Œæç¤ºç”¨æˆ·è¾“å…¥è§£é”å¯†ç </li><li>ç³»ç»Ÿè§’åº¦ï¼šç³»ç»Ÿä¼šè¿›å…¥ç”³è¯·æˆæƒçš„åº”ç”¨å†…éƒ¨å¯»æ‰¾è¿™ä¸ªå¾…å®‰è£…çš„ XPC åº”ç”¨äºŒè¿›åˆ¶åŒ…ï¼Œå¦‚æœæ‰¾åˆ°äº†ä¼šå°†å®ƒ <em>å­˜èµ·æ¥</em> ä»¥ä¾¿ä¸‹ä¸€æ¬¡å¯ä»¥ç›´æ¥å”¤èµ·ï¼Œå¹¶æŠŠå…¶ä¸­çš„ launchd é…ç½®æ‹·è´çš„ç»Ÿä¸€çš„ä½ç½®</li></ul><blockquote><p>é€šè¿‡ SMJobBless å®‰è£…çš„ XPC åº”ç”¨ä¼šå­˜åœ¨ /Library/PrivilegedHelperTools ä¸‹é¢ï¼Œä¸€æ—¦æˆæƒå®Œæˆè¿‡ä¸€æ¬¡ï¼Œåç»­åªè¦é…ç½®æ–‡ä»¶å’Œè¿™é‡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶è¿˜å¯¹å¾—ä¸Šå°±ä¸ä¼šå†å¼¹æˆæƒæ¡†äº†</p></blockquote><p>ä¸ºäº†è®©ç³»ç»Ÿæ–¹ä¾¿åœ°æ‰¾åˆ° XPC åº”ç”¨ï¼Œè¦æŠŠå®ƒçš„<strong>äºŒè¿›åˆ¶æ–‡ä»¶</strong>æ”¾åˆ°åº”ç”¨çš„ /Contents/Library/LaunchServices è·¯å¾„ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å®¢æˆ·ç«¯çš„ Build Phases é‡Œé¢åŠ ä¸€ä¸ªæ­¥éª¤æ¥åšè¿™ä»¶äº‹ï¼š<br><img src="/uploads/ipc-for-macOS/03FE8C66-DDBB-4A23-9D0B-5C0FE1535F30.png" alt></p><blockquote><p>åƒä¸‡è®°å¾—è¿™é‡Œè¦æ”¾çš„æ˜¯ .xpc åŒ…é‡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œåœ¨ xxx.xpc/Contents/MacOS ç›®å½•ä¸‹</p></blockquote><p>OKï¼Œä¸‡äº‹å…·å¤‡ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœŸçš„è¦å†™ä»£ç äº†ã€‚</p><h3 id="ä¸-xpc-åº”ç”¨é€šè®¯">ä¸ XPC åº”ç”¨é€šè®¯</h3><p>é¦–å…ˆæˆ‘ä»¬æ¥å®ç° XPC åº”ç”¨çš„è¿æ¥ç›‘å¬é€»è¾‘ï¼Œåœ¨åˆ›å»º Target ä¹‹åçš„ .m æ–‡ä»¶é‡Œå·²ç»æœ‰è¿æ¥å¤„ç†çš„æ¨¡ç‰ˆå’Œä¸°å¯Œçš„æ³¨é‡Šäº†ï¼š</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.listener = [[<span class="built_in">NSXPCListener</span> alloc] initWithMachServiceName:<span class="string">@"è¿™é‡Œæ”¹æˆä¸Šé¢è®¾ç½®çš„ Label"</span>];</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">BOOL</span>)listener:(<span class="built_in">NSXPCListener</span> *)listener shouldAcceptNewConnection:(<span class="built_in">NSXPCConnection</span> *)newConnection &#123;</span><br><span class="line">    <span class="comment">// This method is where the NSXPCListener configures, accepts, and resumes a new incoming NSXPCConnection.</span></span><br><span class="line">    assert(listener == <span class="keyword">self</span>.listener);</span><br><span class="line">    assert(newConnection != <span class="literal">nil</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Configure the connection.</span></span><br><span class="line">    <span class="comment">// First, set the interface that the exported object implements.</span></span><br><span class="line">    newConnection.exportedInterface = [<span class="built_in">NSXPCInterface</span> interfaceWithProtocol:<span class="class"><span class="keyword">@protocol</span>(<span class="title">HelperToolProtocol</span>)];</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Next, set the object that the connection exports. All messages sent on the connection to this service will be sent to the exported object to handle. The connection retains the exported object.</span></span><br><span class="line">    newConnection.exportedObject = <span class="keyword">self</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Resuming the connection allows the system to deliver more incoming messages.</span></span><br><span class="line">    [newConnection resume];</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// Returning YES from this method tells the system that you have accepted this connection. If you want to reject the connection for some reason, call -invalidate on the connection and return NO.</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>éœ€è¦ç‰¹åˆ«è¯´æ˜çš„ä¸€ç‚¹æ˜¯ï¼ŒXPC è¿æ¥å»ºç«‹èµ·æ¥ä¹‹åï¼Œè¿æ¥å‘èµ·æ–¹å°±èƒ½è·å–åˆ°ä¸Šé¢çš„é€»è¾‘é‡Œçš„ <code>exportedObject</code>ï¼Œè€Œå†ä¸Šä¸€è¡Œçš„ <code>exportedInterface</code> æ˜¯å£°æ˜è¿™ä¸ªå¯¹è±¡åœ¨è¿™æ¬¡ XPC é€šè®¯ä¸­ä¼šéµå¾ªçš„åè®®ã€‚</p><p>æ¢å¥è¯è¯´ï¼Œè¿æ¥çš„å‘èµ·æ–¹ä¼šæŠŠè¿æ¥ä¸Šçš„ XPC åº”ç”¨ç›´æ¥å½“ä½œä¸€ä¸ªå¯¹è±¡æ¥æ“ä½œã€‚è¿™ä¸ªå¯¹è±¡çš„æ¶ˆæ¯ä¼ é€’æ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥åœ¨è°ƒç”¨çš„æ—¶å€™è¦å°å¿ƒé¿å…å¡ä¸»çº¿ç¨‹ã€‚</p><blockquote><p>å› ä¸ºåè®®éœ€è¦è¿æ¥åŒæ–¹è‡ªè¡Œçº¦å®šç»Ÿä¸€ï¼Œæ‰€ä»¥ä¸Šé¢ <code>HelperToolProtocol</code> çš„å®šä¹‰å»ºè®®æ”¾åˆ°ä¸€ä¸ªå…¬å…±çš„æ–‡ä»¶é‡Œï¼Œè®©æˆ‘ä»¬çš„åº”ç”¨é¡¹ç›®å’Œ XPC åº”ç”¨é¡¹ç›®éƒ½èƒ½è®¿é—®åˆ°</p></blockquote><p>XPC åº”ç”¨è¿™è¾¹å…ˆè¯´è¿™ä¹ˆå¤šï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹æ¨¡ç‰ˆä»£ç å°±å¤Ÿäº†ï¼Œåªéœ€è¦è‡ªå·±å®šä¹‰ä¸€ä¸‹ <code>exportedInterface</code> å°±èƒ½å®ç°ä¾‹å¦‚å¿ƒè·³æœºåˆ¶è¿™æ ·çš„åŠŸèƒ½ã€‚</p><p>æ¥ä¸‹æ¥å®ç°å®¢æˆ·ç«¯å‘èµ·è¿æ¥çš„é€»è¾‘ï¼Œæˆ‘ä»¬ç›´æ¥å‚è€ƒå®˜æ–¹ä¾‹å­é‡Œçš„ä»£ç ï¼š</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)connectToHelperTool</span><br><span class="line">    <span class="comment">// Ensures that we're connected to our helper tool.</span></span><br><span class="line">&#123;</span><br><span class="line">    assert([<span class="built_in">NSThread</span> isMainThread]);</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">self</span>.helperToolConnection == <span class="literal">nil</span>) &#123;</span><br><span class="line">        <span class="comment">// 1</span></span><br><span class="line">        <span class="keyword">self</span>.helperToolConnection = [[<span class="built_in">NSXPCConnection</span> alloc] initWithMachServiceName:kHelperToolMachServiceName options:<span class="built_in">NSXPCConnectionPrivileged</span>];</span><br><span class="line">        <span class="comment">// 2</span></span><br><span class="line">        <span class="keyword">self</span>.helperToolConnection.remoteObjectInterface = [<span class="built_in">NSXPCInterface</span> interfaceWithProtocol:<span class="class"><span class="keyword">@protocol</span>(<span class="title">HelperToolProtocol</span>)];</span></span><br><span class="line">        <span class="comment">// 3</span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">pragma</span> clang diagnostic push</span></span><br><span class="line">        <span class="meta">#<span class="meta-keyword">pragma</span> clang diagnostic ignored <span class="meta-string">"-Warc-retain-cycles"</span></span></span><br><span class="line">        <span class="comment">// We can ignore the retain cycle warning because a) the retain taken by the</span></span><br><span class="line">        <span class="comment">// invalidation handler block is released by us setting it to nil when the block </span></span><br><span class="line">        <span class="comment">// actually runs, and b) the retain taken by the block passed to -addOperationWithBlock: </span></span><br><span class="line">        <span class="comment">// will be released when that operation completes and the operation itself is deallocated </span></span><br><span class="line">        <span class="comment">// (notably self does not have a reference to the NSBlockOperation).</span></span><br><span class="line">        <span class="keyword">self</span>.helperToolConnection.invalidationHandler = ^&#123;</span><br><span class="line">            <span class="comment">// If the connection gets invalidated then, on the main thread, nil out our</span></span><br><span class="line">            <span class="comment">// reference to it.  This ensures that we attempt to rebuild it the next time around.</span></span><br><span class="line">            <span class="keyword">self</span>.helperToolConnection.invalidationHandler = <span class="literal">nil</span>;</span><br><span class="line">            [[<span class="built_in">NSOperationQueue</span> mainQueue] addOperationWithBlock:^&#123;</span><br><span class="line">                <span class="keyword">self</span>.helperToolConnection = <span class="literal">nil</span>;</span><br><span class="line">                [<span class="keyword">self</span> logText:<span class="string">@"connection invalidated\n"</span>];</span><br><span class="line">            &#125;];</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="meta">#<span class="meta-keyword">pragma</span> clang diagnostic pop</span></span><br><span class="line">        <span class="comment">// 4</span></span><br><span class="line">        [<span class="keyword">self</span>.helperToolConnection resume];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>é€šè¿‡ label æ‰¾åˆ°ç‰¹å®š XPC åº”ç”¨å¹¶å»ºç«‹è¿æ¥ï¼Œå»ºè®®æŠŠè¿™ä¸ªè¿æ¥å®ä¾‹ä¿å­˜èµ·æ¥ï¼Œé¿å…é‡å¤åˆ›å»ºå¸¦æ¥åˆ«çš„é—®é¢˜</li><li>è¿™ä¸€æ­¥å‚æ•°é‡Œçš„åè®®å°±æ˜¯æˆ‘ä»¬åœ¨ XPC åº”ç”¨ä¸­å£°æ˜çš„åè®®ï¼Œä¸¤è¾¹çš„åè®®è¦å¯¹å¾—ä¸Šæ‰èƒ½æ‹¿åˆ° XPC åº”ç”¨ä¸­æš´éœ²å‡ºæ¥çš„æ­£ç¡®å¯¹è±¡</li><li>å¤§æ®µæ³¨é‡Šæ˜¯åœ¨è§£é‡Šä¸ºä»€ä¹ˆè¿™é‡Œä¸éœ€è¦æ‹…å¿ƒå¾ªç¯å¼•ç”¨çš„é—®é¢˜ï¼›è¦æ³¨æ„çš„æ˜¯å¦‚æœæˆ‘ä»¬æŠŠè¿æ¥å®ä¾‹å­˜äº†èµ·æ¥ï¼Œæœ€å¥½æ˜¯åƒè¿™æ ·åœ¨ <code>invalidationHandler</code> é‡Œç½®ç©ºï¼Œåœ¨å…¶ä»–åœ°æ–¹é€šè¿‡ <code>[connection invalidate]</code>æ¥å®ç°æ–­è¿</li><li>æ‰‹åŠ¨è°ƒç”¨ <code>resume</code> æ¥å»ºç«‹è¿æ¥ï¼Œè°ƒç”¨å XPC åº”ç”¨é‚£è¾¹æ‰ä¼šæ”¶åˆ° <code>-[listener:shouldAcceptNewConnection:]</code> å›è°ƒ</li></ol><p>Doneï¼å¦‚æœå‰é¢çš„ä¸€ç³»åˆ—é…ç½®éƒ½æ­£ç¡®çš„è¯ï¼Œè¿™ä¸ªæ–¹æ³•å°±èƒ½æ­èµ·å®¢æˆ·ç«¯ä¸ XPC åº”ç”¨ä¹‹é—´è¿æ¥æ¡¥æ¢äº†ï¼</p><h3 id="ä¸å…¶ä»–è¿›ç¨‹é€šè®¯">ä¸å…¶ä»–è¿›ç¨‹é€šè®¯</h3><p>é™¤äº†ä¸ XPC åº”ç”¨å»ºç«‹è¿æ¥ä¹‹å¤–ï¼ŒNSXPCConnection è¿˜æä¾›äº†å¦ä¸€ç»„ API ç”¨äºç›´æ¥è·Ÿå…¶ä»–å®¢æˆ·ç«¯å»ºç«‹è¿æ¥ï¼š</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">instancetype</span>)initWithListenerEndpoint:(<span class="built_in">NSXPCListenerEndpoint</span> *)endpoint;</span><br></pre></td></tr></table></figure><p>ä¸€æ¬¡å®Œæ•´çš„è¿æ¥å»ºç«‹æµç¨‹æ˜¯è¿™æ ·çš„ï¼š</p><ol><li>å®¢æˆ·ç«¯ A ä¸ XPC åº”ç”¨å»ºç«‹è¿æ¥</li><li>å®¢æˆ·ç«¯ A ç”Ÿæˆä¸€ä¸ª NSXPCListenerEndpoint å¹¶å­˜æ”¾åˆ° XPC åº”ç”¨é‡Œ</li><li>å®¢æˆ·ç«¯ B ä¸ XPC åº”ç”¨å»ºç«‹è¿æ¥å¹¶å–åˆ°è¿™ä¸ª NSXPCListenerEndpoint</li><li>å®¢æˆ·ç«¯ B é€šè¿‡ NSXPCListenerEndpoint ä¸å®¢æˆ·ç«¯ A å»ºç«‹è¿æ¥</li></ol><p>åœ¨ä¸Šä¸ªå°èŠ‚ä¸­æˆ‘ä»¬å®Œæˆäº†ç¬¬ä¸€æ­¥ï¼Œè€Œç¬¬å››æ­¥è·Ÿç¬¬ä¸€æ­¥å…¶å®æŒºåƒçš„ï¼Œæ‰€ä»¥ç¬¬äºŒä¸‰æ­¥å°±æ˜¯æˆ‘ä»¬ç°åœ¨è¦å¤„ç†çš„äº†ã€‚</p><p>ä¹‹å‰æˆ‘ä»¬å£°æ˜äº†ä¸€ä¸ªç©ºçš„ <code>HelperToolProtocol</code>ï¼Œç°åœ¨å°±ç»™å®ƒåŠ ä¸€äº›å†…å®¹ï¼Œå‘å¤–ç•Œæä¾›å¯¹è±¡è¯»å†™çš„èƒ½åŠ›ï¼š</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@protocol</span> <span class="title">HelperToolProtocol</span></span></span><br><span class="line">- (<span class="keyword">void</span>)setEndpoint:(<span class="built_in">NSXPCListenerEndpoint</span> *)endpoint withReply:(<span class="keyword">void</span> (^)(<span class="built_in">BOOL</span>))reply;</span><br><span class="line">- (<span class="keyword">void</span>)getEndpointWithReply:(<span class="keyword">void</span> (^)(<span class="built_in">NSXPCListenerEndpoint</span> *))reply;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure><blockquote><p>å› ä¸º <code>exportedObject</code> çš„æ¶ˆæ¯ä¼ é€’æ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥åœ¨éœ€è¦è¿”å›å€¼çš„æ—¶å€™è¦æ”¹ç”¨å›è°ƒçš„æ–¹å¼å®ç°ã€‚</p></blockquote><p>ç„¶ååœ¨ XPC åº”ç”¨é‡Œå£°æ˜ä¸€ä¸ªæˆå‘˜å˜é‡å¹¶å®ç°ä¸Šé¢çš„ä¸¤ä¸ªæ–¹æ³•å°±å®Œæˆäº†ï¼š</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">NSXPCListenerEndpoint</span> *endpoint;</span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)setEndpoint:(<span class="built_in">NSXPCListenerEndpoint</span> *)endpoint withReply:(<span class="keyword">void</span> (^)(<span class="built_in">BOOL</span>))reply &#123;</span><br><span class="line">    <span class="keyword">self</span>.endpoint = endpoint;</span><br><span class="line">    reply(<span class="literal">YES</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)getEndpointWithReply:(<span class="keyword">void</span> (^)(<span class="built_in">NSXPCListenerEndpoint</span> *))reply &#123;</span><br><span class="line">    reply(<span class="keyword">self</span>.endpoint);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥å›åˆ°å®¢æˆ·ç«¯çš„ä»£ç é‡Œï¼ˆç°åœ¨è¿˜æ²¡å®ç°å®¢æˆ·ç«¯ Bï¼Œæ‰€ä»¥è¿™é‡Œè®²çš„éƒ½æ˜¯å®¢æˆ·ç«¯ Aï¼‰ï¼š</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1</span></span><br><span class="line">[<span class="keyword">self</span> connectToHelperTool];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="keyword">self</span>.listener = [<span class="built_in">NSXPCListener</span> anonymousListener];</span><br><span class="line"><span class="keyword">self</span>.listener.delegate = <span class="keyword">self</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line"><span class="keyword">id</span>&lt;HelperToolProtocol&gt; service = [<span class="keyword">self</span>.connection remoteObjectProxyWithErrorHandler:^(<span class="built_in">NSError</span> * _Nonnull error) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"get remote object proxy error: %@"</span>, error);</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 4</span></span><br><span class="line">[service setEndpoint:<span class="keyword">self</span>.listener.endpoint withReply:^(<span class="built_in">BOOL</span> result) &#123;</span><br><span class="line">    <span class="built_in">NSLog</span>(<span class="string">@"set endpoint result: %@"</span>, result ? <span class="string">@"success"</span> : <span class="string">@"failed"</span>);</span><br><span class="line">&#125;];</span><br></pre></td></tr></table></figure><ol><li>å…ˆ XPC åº”ç”¨å»ºç«‹è¿æ¥</li><li>å‡†å¤‡ä¸€ä¸ªç›‘å¬å™¨æ¥å¤„ç†å…¶ä»–å®¢æˆ·ç«¯çš„è¿æ¥</li><li>è·å–åˆ° XPC åº”ç”¨çš„ <code>exportedObject</code>ï¼Œå› ä¸ºæ–¹æ³•è¿”å›çš„æ˜¯å®ç°äº†è¿™ä¸ªåè®®çš„å¯¹è±¡ï¼Œæ‰€ä»¥åè®®çš„åŒ¹é…å¾ˆå…³é”®</li><li>è°ƒç”¨åè®®ä¸­çš„æ–¹æ³•æŠŠåŒ¿åç›‘å¬å™¨çš„ç«¯ç‚¹è®¾ç½®è¿‡å»ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨ XPC åº”ç”¨é‡Œå†™æ­»äº†è¿”å› <code>YES</code>ï¼Œæ‰€ä»¥è¿™é‡Œè‚¯å®šä¼šæˆåŠŸï¼Œå®é™…ä½¿ç”¨çš„è¿‡ç¨‹ä¸­å¯èƒ½è¦åŠ ä¸Šå®‰å…¨æ€§çš„å¤„ç†</li></ol><p>ç›‘å¬å™¨æœ‰äº†ï¼Œå°±å·®ç›‘å¬åˆ°è¿æ¥åçš„å›è°ƒäº†ï¼š</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)listener:(<span class="built_in">NSXPCListener</span> *)listener shouldAcceptNewConnection:(<span class="built_in">NSXPCConnection</span> *)newConnection &#123;</span><br><span class="line">    assert(listener == <span class="keyword">self</span>.listener);</span><br><span class="line">    assert(newConnection != <span class="literal">nil</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 2</span></span><br><span class="line">    __<span class="keyword">weak</span> <span class="keyword">typeof</span>(<span class="keyword">self</span>) weakSelf = <span class="keyword">self</span>;</span><br><span class="line">    <span class="keyword">self</span>.clientConnection.invalidationHandler = ^&#123;</span><br><span class="line">        weakSelf.clientConnection.invalidationHandler = <span class="literal">nil</span>;</span><br><span class="line">        [[<span class="built_in">NSOperationQueue</span> mainQueue] addOperationWithBlock:^&#123;</span><br><span class="line">            weakSelf.clientConnection = <span class="literal">nil</span>;</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 3</span></span><br><span class="line">    <span class="keyword">self</span>.clientConnection.remoteObjectInterface = [<span class="built_in">NSXPCInterface</span> interfaceWithProtocol:<span class="class"><span class="keyword">@protocol</span>(<span class="title">ClientBProtocol</span>)];</span></span><br><span class="line">    <span class="keyword">self</span>.clientConnection.exportedInterface = [<span class="built_in">NSXPCInterface</span> interfaceWithProtocol:<span class="class"><span class="keyword">@protocol</span>(<span class="title">ClientAProtocol</span>)];</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">self</span>.clientConnection.exportedObject = <span class="keyword">self</span>;</span><br><span class="line">    [<span class="keyword">self</span>.clientConnection resume];</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">YES</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>è¿™ä¸ªç†Ÿæ‚‰çš„å›è°ƒæ–¹æ³•å…¶å®è·Ÿ XPC åº”ç”¨é‡Œçš„é‚£ä¸ªä¸€æ ·ï¼Œå®¢æˆ·ç«¯ A å·²ç»å…·å¤‡äº†ä¸€ä¸ª XPC åº”ç”¨çš„åŸºæœ¬åŠŸèƒ½äº†</li><li>å®˜æ–¹ä¾‹å­çš„å¦ä¸€ç§å†™æ³•ï¼Œé€»è¾‘ä¸Šæ˜¯ä¸€æ ·çš„ï¼ˆå¯èƒ½è¿™ç§è¿˜äº²åˆ‡ä¸€äº›å‘¢ğŸ˜¬ï¼‰</li><li>é™¤äº† <code>exportedInterface</code> ä¹‹å¤–ï¼Œè¿˜è¦è®¾ç½® <code>remoteObjectInterface</code>ï¼Œå› ä¸ºè¿™æ˜¯ä¸€æ¡åŒå‘é€šè®¯çš„è¿æ¥ï¼Œæ‰€ä»¥è¦è®©å…¶ä»–å®¢æˆ·ç«¯çŸ¥é“æˆ‘ä»¬æœŸæœ›å®ƒä»¬èƒ½éµå¾ªä»€ä¹ˆåè®®</li></ol><p>å¥½çš„ï¼Œæµç¨‹èµ°å®Œä¸€åŠäº†ï¼Œç¬¬ä¸‰å››æ­¥éœ€è¦åœ¨å®¢æˆ·ç«¯ B é‡Œé¢å®ç°ï¼š</p><figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1</span></span><br><span class="line">[<span class="keyword">self</span> connectToHelperTool];</span><br><span class="line">__<span class="keyword">weak</span> <span class="keyword">typeof</span>(<span class="keyword">self</span>) weakSelf = <span class="keyword">self</span>;</span><br><span class="line">[[<span class="keyword">self</span>.connection remoteObjectProxyWithErrorHandler:<span class="literal">nil</span>] getEndpointWithReply:^(<span class="built_in">NSXPCListenerEndpoint</span> *endpoint) &#123;</span><br><span class="line">    [[<span class="built_in">NSOperationQueue</span> mainQueue] addOperationWithBlock:^&#123;</span><br><span class="line">        <span class="keyword">if</span> (endpoint) &#123;</span><br><span class="line">            [weakSelf connectWithEndpoint:endpoint];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br><span class="line">&#125;]</span><br><span class="line"></span><br><span class="line">- (<span class="keyword">void</span>)connectWithEndpoint:(<span class="built_in">NSXPCListenerEndpoint</span> *)endpoint &#123;</span><br><span class="line">    <span class="comment">// 2</span></span><br><span class="line">    <span class="keyword">self</span>.serverConnection = [[<span class="built_in">NSXPCConnection</span> alloc] initWithListenerEndpoint:endpoint];</span><br><span class="line">    <span class="keyword">self</span>.serverConnection.remoteObjectInterface = [<span class="built_in">NSXPCInterface</span> interfaceWithProtocol:<span class="class"><span class="keyword">@protocol</span>(<span class="title">ServerCommunicationProtocol</span>)];</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 3</span></span><br><span class="line">    <span class="keyword">self</span>.serverConnection.exportedInterface = [<span class="built_in">NSXPCInterface</span> interfaceWithProtocol:<span class="class"><span class="keyword">@protocol</span>(<span class="title">ClientCommunicationProtocol</span>)];</span></span><br><span class="line">    <span class="keyword">self</span>.serverConnection.exportedObject = <span class="keyword">self</span>;</span><br><span class="line">    </span><br><span class="line">    __<span class="keyword">weak</span> <span class="keyword">typeof</span>(<span class="keyword">self</span>) weakSelf = <span class="keyword">self</span>;</span><br><span class="line">    <span class="keyword">self</span>.serverConnection.invalidationHandler = ^&#123;</span><br><span class="line">        weakSelf.serverConnection.invalidationHandler = <span class="literal">nil</span>;</span><br><span class="line">        [[<span class="built_in">NSOperationQueue</span> mainQueue] addOperationWithBlock:^&#123;</span><br><span class="line">            weakSelf.serverConnection = <span class="literal">nil</span>;</span><br><span class="line">        &#125;];</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    [<span class="keyword">self</span>.serverConnection resume];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 4</span></span><br><span class="line">    <span class="comment">// self.serverConnectionEndpoint = endpoint;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>å®¢æˆ·ç«¯ B ä» XPC åº”ç”¨ä¸­æ‹¿åˆ°å®¢æˆ·ç«¯ A è®¾ç½®çš„ç«¯ç‚¹ï¼Œè¿™è·Ÿè®¾ç½®ç«¯ç‚¹çš„ä»£ç å·®ä¸å¤š</li><li>é€šè¿‡ç«¯ç‚¹æ¥æ„é€  <code>NSXPCConnection</code>ï¼Œè¿™æ ·åœ¨è°ƒç”¨ <code>resume</code> ä¹‹åå¯¹æ–¹ä¼šæ”¶åˆ° <code>-[listener:shouldAcceptNewConnection:]</code> çš„å›è°ƒ</li><li>ä¸ä¸Šæ–‡çš„å›è°ƒå¤„ç†ç±»ä¼¼ï¼Œå› ä¸ºæˆ‘ä»¬è¦åšçš„æ˜¯åŒå‘é€šè®¯ï¼Œæ‰€ä»¥å®¢æˆ·ç«¯ B åœ¨å‘èµ·è¿æ¥æ—¶ä¹Ÿè¦æŠŠ <code>exportedInterface</code> å’Œ <code>exportedObject</code> è®¾ç½®å¥½ï¼Œä¹‹åçš„ä»£ç å°±è·Ÿå…¶ä»–åœ°æ–¹çœ‹åˆ°çš„å·®ä¸å¤šäº†</li><li>æœ‰å¿…è¦çš„è¯å¯ä»¥æŠŠè¿™ä¸ªç«¯ç‚¹å­˜èµ·æ¥ç”¨äºä¸€äº›åˆ¤æ–­æˆ–é‡è¿çš„é€»è¾‘</li></ol><h2 id="å¸¸è§é”™è¯¯">å¸¸è§é”™è¯¯</h2><blockquote><p>è¿™ä¸€æ®µæ€»ç»“äº†æˆ‘åœ¨å®ç°è¿‡ç¨‹ä¸­è¸©çš„å‘ï¼Œä¹Ÿè®¸æˆ‘ä»¬çš„æƒ…å†µä¸å¤ªä¸€æ ·ï¼Œä½†å¸Œæœ›èƒ½ç»™å¤§å®¶ä¸€ä¸ªæ’æŸ¥çš„æ€è·¯</p></blockquote><p>æ¶‰åŠåˆ°å¤šç«¯é€šè®¯çš„é€»è¾‘è°ƒè¯•èµ·æ¥æ¯”è¾ƒç»•ï¼Œé”™è¯¯é€šå¸¸ä¼šå‘ç”Ÿåœ¨ä»¥ä¸‹ä¸¤ä¸ªéƒ¨åˆ†ï¼š</p><ol><li>å®¢æˆ·ç«¯éƒ¨åˆ†ï¼šç¡®è®¤ä»£ç é€»è¾‘æ²¡æ¼çš„è¯ï¼Œå¯ä»¥æŠŠå„ç§ <code>handler</code> çš„ç»“æœéƒ½æ‰“å°ä¸€ä¸‹ï¼Œä¸€èˆ¬éƒ½ä¼šå¸¦æœ‰æ¯”è¾ƒæ˜ç¡®çš„é”™è¯¯åŸŸå’Œé”™è¯¯ç </li><li>è¿æ¥éƒ¨åˆ†ï¼šè¿™ç±»é”™è¯¯ä¿¡æ¯ä¸ä¼šå‡ºç°åœ¨å®¢æˆ·ç«¯æ—¥å¿—é‡Œï¼Œä¹Ÿåˆ†ä¸¤ç±»<ol><li>æ²¡æœ‰ä»»ä½•ååº”ä½†å°±æ˜¯è¿ä¸ä¸Šï¼šå¯ä»¥ç”¨è‡ªå¸¦çš„æ§åˆ¶å°å·¥å…·å»ææ—¥å¿—</li><li>è°ƒç”¨ API å¯¼è‡´å´©æºƒï¼šä¹Ÿæ˜¯æ§åˆ¶å°æï¼ŒmacOS çš„ç³»ç»Ÿå´©æºƒä¸ŠæŠ¥å¼¹çª—é‡Œå¯èƒ½ä¼šæœ‰æ›´å¤šä¿¡æ¯</li></ol></li></ol><p>ä¸‹é¢æ˜¯æˆ‘ç¢°è¿‡çš„ä¸€äº›é”™è¯¯å’Œå¤„ç†æ–¹å¼ï¼š</p><h3 id="cferrordomainlaunchd-code-2">CFErrorDomainLaunchd Code=2</h3><p>å®‰è£… XPC åº”ç”¨æ—¶åœ¨å®¢æˆ·ç«¯å†…æ‰¾ä¸åˆ° XPC åº”ç”¨çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ£€æŸ¥ä¸€ä¸‹äºŒè¿›åˆ¶åŒ…æ˜¯ä¸æ˜¯æ”¾åˆ°äº†æ­£ç¡®çš„è·¯å¾„ä¸‹ï¼Œæ ¼å¼æ˜¯å¦æ­£ç¡®ï¼ˆè®°å¾—è¦å– .xpc åç¼€çš„æ–‡ä»¶é‡Œçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼‰ã€‚</p><h3 id="cferrordomainlaunchd-code-4-or-8">CFErrorDomainLaunchd Code=4 or 8</h3><p>ç­¾ååŒ¹é…ä¸ä¸Šã€‚å¤§æ¦‚ç‡æ˜¯ Info.plist é‡Œé…ç½®çš„ç­¾åéœ€æ±‚ä¸æ­£ç¡®ï¼Œå›å¤´çœ‹çœ‹ <em>å‰ç½®å‡†å¤‡</em> é‚£ä¸ªå°èŠ‚ï¼Œæ£€æŸ¥å†…å®¹æ˜¯å¦è·Ÿ <code>codesign -d -r - /path/to/app</code>  å’Œ <code>codesign -d -r - /path/to/xpc</code>  çš„ä¸€è‡´ã€‚</p><h3 id="error-domain-nscocoaerrordomain-code-4097">Error Domain=NSCocoaErrorDomain Code=4097</h3><blockquote><p>å‡ºè‡ª FoundationErrors.h - NSXPCConnectionInterrupted</p></blockquote><p>è¿æ¥è¢«æ‰“æ–­ï¼ˆinterruptedï¼‰ï¼Œçº¦ç­‰äº connection.interruptionHandler è¢«è§¦å‘äº†ã€‚<br>å¦‚æœå‘ç”Ÿåœ¨è¿æ¥å»ºç«‹çš„è¿‡ç¨‹ä¸­ï¼Œé‚£æ„å‘³ç€å®ƒå‘ç°è¿æ¥å·²ç»è¢«å ç”¨äº†ï¼Œå¤šè§äºè°ƒè¯•è¿‡ç¨‹ä¸­é‡å¯äº†å…¶ä¸­ä¸€ç«¯ï¼Œä½†æ˜¯å¦ä¸€ç«¯æ²¡æœ‰æŠŠè¿æ¥é‡Šæ”¾æ‰ã€‚</p><p>åœ¨æ­£å¸¸è¿è¡Œçš„è¿‡ç¨‹ä¸­å‘ç”Ÿçš„è¯ï¼Œå¯èƒ½æ˜¯ç³»ç»Ÿ XPC æœåŠ¡å‘ç°æˆ‘ä»¬çš„è¿æ¥é•¿æ—¶é—´æ²¡æœ‰ä½¿ç”¨è€ŒæŒ‚èµ·äº†å®ƒï¼Œè¿™ç§æƒ…å†µä¸€èˆ¬ä¸éœ€è¦å¤„ç†ï¼Œç³»ç»Ÿä¼šåœ¨æˆ‘ä»¬ä¸‹æ¬¡ä½¿ç”¨è¿™æ¡è¿æ¥çš„æ—¶å€™è‡ªåŠ¨å¸®æˆ‘ä»¬å¤„ç†å¥½ã€‚</p><h3 id="error-domain-nscocoaerrordomain-code-4099">Error Domain=NSCocoaErrorDomain Code=4099</h3><blockquote><p>å‡ºè‡ª FoundationErrors.h - NSXPCConnectionInvalid</p></blockquote><p>åŒæ ·åˆ†ä¸¤ç§æƒ…å†µï¼Œä¸€è¿æ¥å°±å‡ºäº‹çš„è¯ï¼Œå¯èƒ½æ˜¯ XPC åº”ç”¨æ²¡æœ‰å®‰è£…æˆåŠŸï¼Œæ’æŸ¥æ–¹å¼æ˜¯çœ‹ plist å’ŒäºŒè¿›åˆ¶æ–‡ä»¶æœ‰æ²¡æœ‰å‡ºç°åœ¨å®ƒä»¬è¯¥å‡ºç°çš„è·¯å¾„é‡Œã€‚<br>å¦ä¸€ç§æƒ…å†µï¼Œå¯èƒ½æ˜¯å®¢æˆ·ç«¯å› ä¸ºæ²™ç›’çš„åŸå› è€Œæ— æ³•å»ºç«‹è¿™æ¡è¿æ¥ï¼Œæ§åˆ¶å°æ—¥å¿—é‡Œä¼šçœ‹åˆ°ç±»ä¼¼ <em>deny mach-lookup</em> çš„ä¿¡æ¯ï¼Œå¯ä»¥é€‰æ‹©æŠŠ App Sandbox å…³ä¸Šï¼ˆä¼šæ²¡æ³•ä¸Š Mac App Store ä½†ä¸å½±å“å…¶ä»–æ¸ é“çš„åˆ†å‘ï¼‰ï¼ŒçœŸè¦æ‰“å¼€æ²™ç›’çš„è¯æœ‰ä¸¤æ¡å¯ä»¥å°è¯•çš„è·¯å¾„ï¼š</p><ol><li>æƒ³åŠæ³•æå®š entitlements çš„é…ç½®ï¼Œå¯ä»¥å‚è€ƒ<a href="https://christiantietze.de/posts/2015/01/xpc-helper-sandboxing-mac/" target="_blank" rel="noopener">è¿™ç¯‡æ–‡ç« </a></li><li>åº”ç”¨å†…ç½®å¦ä¸€ä¸ªä¸åœ¨æ²™ç›’å†…çš„ XPC åº”ç”¨ï¼Œé€šè¿‡å®ƒå»è·Ÿå®‰è£…åˆ°ç³»ç»Ÿé‡Œçš„ XPC åº”ç”¨å»ºç«‹è¿æ¥ï¼Œå…·ä½“çš„æ–¹å¼åœ¨å®˜æ–¹çš„ <a href="https://developer.apple.com/library/archive/samplecode/EvenBetterAuthorizationSample/Introduction/Intro.html#//apple_ref/doc/uid/DTS40013768-Intro-DontLinkElementID_2" target="_blank" rel="noopener">EvenBetterAuthorizationSample</a>ä¸­æœ‰å®ç°</li></ol><h2 id="æ€»ç»“">æ€»ç»“</h2><p>XPC æ˜¯ macOS è·¨åº”ç”¨é€šè®¯ä¸­ä¸å¾—ä¸é¢å¯¹çš„ä¸€ç§æ–¹æ¡ˆï¼Œå¯èƒ½å‡ºäºå„ç§åŸå› æœ€ç»ˆçš„é€‰æ‹©å¹¶ä¸æ˜¯å®ƒï¼Œä½†å®ƒç¡®å®æ˜¯ç›®å‰æœ€ç®€å•å¯é çš„å®ç°äº†ã€‚</p><p>å°½ç®¡æˆ‘åœ¨ç½‘ä¸Šå·²ç»æŸ¥äº†éå¸¸å¤šçš„èµ„æ–™ï¼Œä¹Ÿè¿˜æ˜¯åœ¨åŠ¨æ‰‹çš„è¿‡ç¨‹ä¸­é¢‘é¢‘è¸©å‘ã€‚å†™ä¸‹è¿™ç¯‡é•¿æ–‡ä¹Ÿæ˜¯å¸Œæœ›èƒ½æŠŠè¿™æ¡è·¯å°½å¯èƒ½å¡«å¹³ï¼Œåªæ˜¯è¿™ä¸ªæ–‡ç« é•¿åº¦å°±æœ‰äº›ä¸€å‘ä¸å¯æ”¶æ‹¾äº†ğŸ˜…ã€‚</p><h2 id="å‚è€ƒèµ„æ–™">å‚è€ƒèµ„æ–™</h2><ul><li><a href="http://www.tanhao.me/pieces/1623.html/" target="_blank" rel="noopener">é€šè¿‡ServiceManagementæ³¨å†ŒLaunchdDaemon | è€è°­ç¬”è®°</a></li><li><a href="https://nshipster.com/inter-process-communication/" target="_blank" rel="noopener">Inter-Process Communication - NSHipster</a></li><li><a href="https://developer.apple.com/library/archive/samplecode/EvenBetterAuthorizationSample/Listings/Read_Me_About_EvenBetterAuthorizationSample_txt.html#//apple_ref/doc/uid/DTS40013768-Read_Me_About_EvenBetterAuthorizationSample_txt-DontLinkElementID_17" target="_blank" rel="noopener">Read Me About EvenBetterAuthorizationSample.txt</a></li><li><a href="http://www.objc.io/issue-14/xpc.html" target="_blank" rel="noopener">XPC Â· objc.io</a></li><li><a href="https://rderik.com/blog/creating-a-launch-agent-that-provides-an-xpc-service-on-macos/" target="_blank" rel="noopener">Creating a Launch Agent that provides an XPC service on macOS using Swift</a></li><li><a href="https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingLaunchdJobs.html#//apple_ref/doc/uid/10000172i-SW7-BCIEDDBJ" target="_blank" rel="noopener">Creating Launch Daemons and Agents</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘éœ€è¦åœ¨ Electron é¡¹ç›®ä¸Šå¼•å…¥ä¸€ä¸ªæ¯”è¾ƒåƒæ€§èƒ½çš„å¤§å¤´åŠŸèƒ½ï¼Œå› ä¸ºå·²ç»ç”¨ Objective-C å®ç°è¿‡ä¸€å¥—ç¨³å®šä¸”æ€§èƒ½ä¹Ÿå¯æ¥å—çš„å¸¦ UI æ–¹æ¡ˆäº†ï¼Œæ‰€ä»¥è®¡åˆ’çœ‹çœ‹èƒ½ä¸èƒ½å°†è¿™å¥—ç°æˆçš„æ–¹æ¡ˆç›´æ¥ç”¨åˆ° Electron é‡Œã€‚ä½†æƒ³è¦è¿™ä¹ˆåšå°±å¿…é¡»è§£å†³åŸç”Ÿ UI ä¸ Electron é€šè®¯çš„é—®é¢˜ï¼Œå†è¿›ä¸€æ­¥ï¼Œèƒ½ä¸èƒ½è®© Electron ä»¥å¤šè¿›ç¨‹çš„æ–¹å¼è°ƒèµ·è¿™ä¸ªå¤§å¤´åŠŸèƒ½çš„ Demo ä»¥èŠ‚çœæ‰ç»å¤§éƒ¨åˆ†çš„é‡å¤å·¥ä½œå‘¢ï¼Ÿ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;æœ¬æ–‡åªç ”ç©¶äº†åŸç”Ÿ XPC é€šè®¯çš„éƒ¨åˆ†ï¼Œå…³äºé›†æˆåˆ° Electron é‡Œè¿˜æœ‰å“ªäº›å‘ä¼šåœ¨ä¸‹ä¸€ç¯‡æ–‡ç« é‡Œè®²è®²&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="macOS" scheme="http://davidleee.com/tags/macOS/"/>
    
      <category term="XPC" scheme="http://davidleee.com/tags/XPC/"/>
    
      <category term="launchd" scheme="http://davidleee.com/tags/launchd/"/>
    
      <category term="SMJobBless" scheme="http://davidleee.com/tags/SMJobBless/"/>
    
  </entry>
  
  <entry>
    <title>SwiftUI ç³»åˆ—æ•™ç¨‹ï¼ˆ4ï¼‰â€”â€” UIKit è€ç›¸å¥½åœ¨ SwiftUI ä¸‹çš„å®ç°</title>
    <link href="http://davidleee.com/2019/08/15/swiftui-serial-tutorial-4/"/>
    <id>http://davidleee.com/2019/08/15/swiftui-serial-tutorial-4/</id>
    <published>2019-08-15T00:44:32.000Z</published>
    <updated>2020-05-05T03:43:31.445Z</updated>
    
    <content type="html"><![CDATA[<p>å’±ä»¬æœ€æœ‰æ„æ€çš„ç¬¬å››ç¯‡ SwiftUI æ•™ç¨‹æ¥å•¦ï¼ä¸ºä»€ä¹ˆè¯´æ˜¯â€œæœ€æœ‰æ„æ€â€çš„å‘¢ï¼Ÿå› ä¸ºæŒ‰ç…§çº¦å®šï¼Œåœ¨è¿™ç¯‡æ–‡ç« é‡Œæˆ‘ä»¬ä¼šä¸€èµ·æ¥çœ‹çœ‹ç”¨ SwiftUI å¼€å‘ç•Œé¢çš„å¿«æ·ä¾¿åˆ©ä½“ç°åœ¨ä»€ä¹ˆåœ°æ–¹ã€‚ç›¸ä¿¡è¿™ä¼šè®©è®¸å¤šè‹¹æœå¼€å‘è€…ä»¬è€³ç›®ä¸€æ–°ã€‚</p><blockquote><p>ä¿¡äº†è‹¹æœæ•™ä¹‹åï¼Œæ¯æ¬¡æœ‰ä»€ä¹ˆæ›´æ–°ï¼Œæˆ‘æœ€æœŸå¾…çš„éƒ½æ˜¯éšè—åœ¨å¤§åŠŸèƒ½ä¸‹çš„å°ç»†èŠ‚ï¼Œä¸çŸ¥é“æœ‰å¤šå°‘äººè·Ÿæˆ‘ä¸€æ ·ï¼Ÿ</p></blockquote><a id="more"></a><h2 id="uitableview-uitableviewcell">UITableView &amp; UITableViewCell</h2><p>é¦–å…ˆè¦è¯´çš„æ˜¯ UI ä¸­æœ€å¸¸è§çš„åˆ—è¡¨ï¼šåœ¨èŒæ–°ä»¬åˆšå¼€å§‹å­¦ä¹  iOS å¼€å‘çš„æ—¶å€™ï¼Œåˆ—è¡¨çš„å®ç°ä¹Ÿè®¸å°±æ˜¯å…¶ä¸­ä¸€ä¸ªåŠé€€ç‚¹ã€‚è™½ç„¶ UIKit çš„ API å·²ç»åšäº†æ¯”è¾ƒå‹å¥½çš„å°è£…ï¼Œä½†åœ¨è¿™ä¸ªå‰æä¸‹ï¼Œå¼€å‘è€…è¿˜å¿…é¡»è¦äº†è§£ UITableViewDelegateã€UITableViewDataSourceã€Cell ä¸åˆ—è¡¨çš„å…³ç³»ï¼Œå¦‚æœæƒ³è¦æ„é€ ä¸€ä¸ªé«˜æ€§èƒ½çš„åˆ—è¡¨ï¼Œè¿˜éœ€è¦äº†è§£ Cell çš„é‡ç”¨ç­‰ç­‰ç­‰ç­‰ã€‚</p><p>é‚£ä¹ˆåœ¨ SwiftUI é‡Œæ„é€ ä¸€ä¸ªåˆ—è¡¨çš„æ“ä½œæ˜¯æ€æ ·çš„å‘¢ï¼Ÿæˆ‘ä»¬åˆ†ä¸‰æ­¥èµ°ï¼š</p><ol><li>å•ä¸ªåˆ—è¡¨é¡¹çš„å¸ƒå±€</li><li>å‡†å¤‡æ•°æ®</li><li>å…¨éƒ¨å¡åˆ°ä¸€ä¸ªåˆ—è¡¨é‡Œæ˜¾ç¤ºå‡ºæ¥</li></ol><h3 id="åˆ—è¡¨é¡¹å¸ƒå±€">åˆ—è¡¨é¡¹å¸ƒå±€</h3><p>å‡è®¾æˆ‘ä»¬å°±æ„é€ ä¸€ä¸ªæœ€åŸºç¡€çš„åˆ—è¡¨é¡¹å¸ƒå±€å¥½äº†ï¼Œä¸€ç§ UIKit ç›´æ¥å°±æ”¯æŒçš„æ˜¾ç¤ºæ¨¡å¼ï¼šå›¾ç‰‡ + æ ‡é¢˜ + è¯¦æƒ…æè¿°ã€‚</p><p>ç»è¿‡å‰é¢å‡ ç¯‡æ–‡ç« çš„è®­ç»ƒï¼Œæˆ‘ä»¬å¯¹è¿™ç§ç±»å‹çš„ UI æ„é€ åº”è¯¥ç†Ÿé—¨ç†Ÿè·¯äº†ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">HStack</span>() &#123;</span><br><span class="line"><span class="type">Image</span>(systemName: <span class="string">"photo"</span>) <span class="comment">// 1</span></span><br><span class="line"><span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line"><span class="type">Text</span>(<span class="string">"Title"</span>)</span><br><span class="line"><span class="type">Text</span>(<span class="string">"Detail description"</span>)</span><br><span class="line">.font(.subheadline)</span><br><span class="line">.foregroundColor(.secondary) <span class="comment">// 2</span></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>æˆ‘ä»¬è¿™é‡Œç”¨äº†ä¸€å¼ åä¸ºâ€œphotoâ€çš„å›¾ç‰‡ï¼Œè¿™ä¸ªå›¾ç‰‡æ˜¯ iOS 13 é€ç»™æˆ‘ä»¬çš„ï¼Œå°±æ˜¯é‚£ä¸ªå¸¸è§çš„å›¾ç‰‡å ä½ç¬¦å›¾æ ‡</li><li>UIKit é»˜è®¤çš„è¯¦æƒ…æè¿°ç”¨çš„æ˜¯ä¸€ç§ç°è‰²çš„åå°ä¸€ç‚¹çš„å­—ä½“ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨ç³»ç»Ÿæä¾›çš„å±æ€§å°±èƒ½æ¨¡ä»¿å‡ºæ¥</li></ol><p>å®Œæˆè¿™ä¸€æ­¥ä¹‹åï¼Œé¢„è§ˆä¼šæ˜¯è¿™ä¸ªæ ·å­çš„ï¼š<br><img src="/uploads/swiftui-serial-tutorial-4/B1BE86B5-7B16-46DF-8DE8-C6AD6B23565D.png" alt></p><p>OKï¼Œå­¦ä¹ å®Œå‰é¢ä¸‰ç¯‡æ–‡ç« ä¹‹åï¼Œè¿™é‡Œå¹¶æ²¡æœ‰ä»€ä¹ˆæ–°é²œçš„çŸ¥è¯†ã€‚ä¸‹ä¸€æ­¥æ˜¯å‡†å¤‡æ•°æ®ã€‚</p><h3 id="å‡†å¤‡æ•°æ®">å‡†å¤‡æ•°æ®</h3><p>è¿™ä¸€æ­¥è·Ÿç›´æ¥ç”¨ Swift æ¥å®ç°æ²¡æœ‰å¤ªå¤šåŒºåˆ«ï¼Œæˆ‘å°±ç›´æ¥ç”¨ WWDC è§†é¢‘é‡Œçš„æ•°æ®ç»“æ„äº†ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Foundation</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Room</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> id = <span class="type">UUID</span>()</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span></span><br><span class="line">    <span class="keyword">var</span> capacity: <span class="type">Int</span></span><br><span class="line">    <span class="keyword">var</span> hasVideo: <span class="type">Bool</span> = <span class="literal">false</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> imageName: <span class="type">String</span> &#123; <span class="keyword">return</span> name &#125;</span><br><span class="line">    <span class="keyword">var</span> thumbnailName: <span class="type">String</span> &#123; <span class="keyword">return</span> name + <span class="string">"Thumb"</span> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#<span class="keyword">if</span> <span class="type">DEBUG</span></span><br><span class="line"><span class="keyword">let</span> testData = [</span><br><span class="line">    <span class="type">Room</span>(name: <span class="string">"Observation Deck"</span>, capacity: <span class="number">6</span>, hasVideo: <span class="literal">true</span>),</span><br><span class="line">    <span class="type">Room</span>(name: <span class="string">"Executive Suite"</span>, capacity: <span class="number">8</span>, hasVideo: <span class="literal">false</span>),</span><br><span class="line">    <span class="type">Room</span>(name: <span class="string">"Charter Jet"</span>, capacity: <span class="number">16</span>, hasVideo: <span class="literal">true</span>),</span><br><span class="line">    <span class="type">Room</span>(name: <span class="string">"Dungeon"</span>, capacity: <span class="number">10</span>, hasVideo: <span class="literal">true</span>),</span><br><span class="line">    <span class="type">Room</span>(name: <span class="string">"Panorama"</span>, capacity: <span class="number">12</span>, hasVideo: <span class="literal">false</span>),</span><br><span class="line">    <span class="type">Room</span>(name: <span class="string">"Oceanfront"</span>, capacity: <span class="number">8</span>, hasVideo: <span class="literal">false</span>),</span><br><span class="line">    <span class="type">Room</span>(name: <span class="string">"Rainbow Room"</span>, capacity: <span class="number">10</span>, hasVideo: <span class="literal">true</span>),</span><br><span class="line">    <span class="type">Room</span>(name: <span class="string">"Pastoral"</span>, capacity: <span class="number">7</span>, hasVideo: <span class="literal">false</span>),</span><br><span class="line">    <span class="type">Room</span>(name: <span class="string">"Elephant Room"</span>, capacity: <span class="number">1</span>, hasVideo: <span class="literal">true</span>)</span><br><span class="line">]</span><br><span class="line">#endif</span><br></pre></td></tr></table></figure><blockquote><p>è¿™æ˜¯æˆ‘ç…§ç€æ‰‹æ•²çš„â€¦å¦‚æœæœ‰äººçŸ¥é“å“ªé‡Œèƒ½å¼„æ¥ WWDC è§†é¢‘é‡Œçš„ Demo é¡¹ç›®æºæ–‡ä»¶ï¼Œè¯·åŠ¡å¿…å‘Šè¯‰æˆ‘ï¼</p></blockquote><p>åˆ°è¿™ä¸€æ­¥ä¸ºæ­¢è¿˜æ²¡ä»€ä¹ˆä¸åŒï¼Œå”¯ä¸€æ¯”è¾ƒä¸å¸¸è§çš„å¯èƒ½æ˜¯ä¸‹é¢çš„ <code>testData</code>ï¼Œè¿™æ˜¯æ–¹ä¾¿æˆ‘ä»¬è°ƒè¯•ç”¨çš„å‡æ•°æ®ã€‚</p><p>ä¸ºäº†è®© SwiftUI çš„ <code>List</code> èƒ½æ­£å¸¸ä½¿ç”¨è¿™ä¸ªæ•°æ®ç»“æ„ï¼Œæˆ‘ä»¬è¿˜éœ€è¦è¿›è¡Œä¸€ç‚¹ç‚¹æ”¹é€ ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Room</span>: <span class="title">Identifiable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> id = <span class="type">UUID</span>()</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>List</code> èƒ½ä½¿ç”¨çš„æ•°æ®ç»“æ„å¿…é¡»éµå¾ª SwiftUI é‡Œæ–°åŠ å…¥çš„ <code>Identifiable</code> åè®®ï¼Œå®ƒè¦æ±‚è¿™ä¸ªæ•°æ®ç»“æ„é‡Œå¿…é¡»æœ‰ä¸€ä¸ªç¬¦åˆ <code>Hashable</code> åè®®çš„å˜é‡ <code>id</code>ï¼Œæˆ‘ä»¬è¿™é‡Œç”¨åˆ°çš„ <code>id</code> æ˜¯ <code>UUID</code> ç±»å‹çš„ï¼Œæœ¬èº«å·²ç»æ»¡è¶³è¿™ä¸ªè¦æ±‚ï¼Œæ‰€ä»¥è¿™é‡Œå°±ä¸éœ€è¦åšæ›´å¤šä¿®æ”¹äº†ã€‚</p><h2 id="åˆ—è¡¨æ˜¾ç¤º">åˆ—è¡¨æ˜¾ç¤º</h2><p>ç°åœ¨æˆ‘ä»¬æŠŠ UI å’Œæ•°æ®éƒ½å‡†å¤‡å¥½äº†ï¼Œæ¥ä¸‹æ¥å°±è®©å®ƒä»¬ç»„åˆèµ·æ¥ï¼Œæ˜¾ç¤ºæˆä¸€ä¸ªåˆ—è¡¨ï¼</p><p>å¯¹äº <code>List</code> æ¥è¯´ï¼Œåˆ—è¡¨é¡¹çš„é»˜è®¤å¸ƒå±€å°±æ˜¯æ°´å¹³æ–¹å‘çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥ Cmd + é¼ æ ‡å·¦é”®ç‚¹å‡»åˆ—è¡¨é¡¹ UI é‡Œçš„ <code>HStack</code>ï¼Œç„¶åé€‰æ‹©â€œConvert to Listâ€¦â€ï¼š<br><img src="/uploads/swiftui-serial-tutorial-4/D66F6EDE-FA01-489B-A8D3-4EDC81B5E18A.png" alt></p><blockquote><p>ä¹Ÿè®¸æ˜¯ Xcode çš„ç‰ˆæœ¬é—®é¢˜ï¼Œåœ¨æˆ‘è¿™é‡Œæ˜¾ç¤ºçš„æ˜¯â€œEmbed in Listâ€ï¼Œä½†æ˜¯æœ€åçš„æ•ˆæœä¹Ÿæ˜¯æŠŠé€‰ä¸­äº†çš„ <code>HStack</code> æ›¿æ¢æˆäº† <code>List</code></p></blockquote><p>å¾—ç›Šäº <code>List</code> æ„é€ æ–¹æ³•é‡Œçš„æ•°ç»„ç±»å‹å‚æ•°ï¼Œè¿™æ®µ UI ä»£ç çœ‹èµ·æ¥å°±åƒæ˜¯ä¸€ä¸ª forâ€¦in çš„è¯­å¥ä¸€æ ·ï¼å›å¤´çœ‹çœ‹é¢„è§ˆï¼Œä¸€ä¸ªåƒæ¨¡åƒæ ·çš„åˆ—è¡¨å·²ç»å‡ºæ¥äº†ï¼š<br><img src="/uploads/swiftui-serial-tutorial-4/38B4C8E5-0363-4674-AB1D-F078915AAF24.png" alt></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬æŠŠå‡†å¤‡å¥½çš„æ•°æ®å¯¹æ¥ä¸Šå»ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ListView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line"><span class="keyword">var</span> rooms: [<span class="type">Room</span>] <span class="comment">// 1</span></span><br><span class="line"><span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line"><span class="type">List</span>(rooms) &#123; room <span class="keyword">in</span> <span class="comment">// 2</span></span><br><span class="line"><span class="type">Image</span>(room.thumbnailName)</span><br><span class="line"><span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line"><span class="type">Text</span>(room.name)</span><br><span class="line"><span class="type">Text</span>(<span class="string">"\(room.capacity) people"</span>)</span><br><span class="line">.font(.subheadline)</span><br><span class="line">.foregroundColor(.secondary)</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#<span class="keyword">if</span> <span class="type">DEBUG</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ListView_Previews</span>: <span class="title">PreviewProvider</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">var</span> previews: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">ListView</span>(rooms: testData) <span class="comment">// 3</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">#endif</span><br></pre></td></tr></table></figure><ol><li>å…ˆå®šä¹‰ä¸€ä¸ªæˆå‘˜å˜é‡æ¥ä¿ç®¡æ•°æ®ï¼Œè¿™ä¸€è¡Œä¸ºç¬¦åˆå•ä¸€æ•°æ®æºçš„åŸåˆ™ï¼Œè¿™ä¸ªæ•°æ®æ˜¯ç”±è°ƒç”¨æ–¹è´Ÿè´£æ„å»ºå’Œä¼ å…¥çš„</li><li>æŠŠ <code>List</code> çš„å‚æ•°ç¼“å­˜æˆ‘ä»¬çœŸå®çš„æ•°ç»„ï¼Œç„¶åæŠŠå†…éƒ¨çš„ç¡¬ç¼–ç æ•°æ®æ¢æˆä¼ è¿›æ¥çš„æ•°æ®</li><li>è¿™é‡Œæˆ‘ä»¬èƒ½çœ‹åˆ°é¢„è§ˆè§†å›¾çš„å¦ä¸€ä¸ªå¥½å¤„ï¼Œå°±æ˜¯å®ƒå®Œå…¨æ¨¡æ‹Ÿäº†çœŸå®æƒ…å†µä¸‹çš„ä»£ç é€»è¾‘ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç›´æ¥æŠŠä¸Šä¸€æ­¥å‡†å¤‡å¥½çš„æµ‹è¯•æ•°æ®ä¼ è¿›å»</li></ol><p><img src="/uploads/swiftui-serial-tutorial-4/ACCBAF94-47D3-43B5-B924-5589A3F68C9D.png" alt></p><p>å¯¹æ¯”å¯¼å…¥æ•°æ®å‰åçš„ç•Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ï¼šé»˜è®¤æƒ…å†µä¸‹ Cell çš„é«˜åº¦ä¸º 44ptï¼Œä½†æ˜¯å½“å¡è¿›å»çš„å†…å®¹ï¼ˆæ¯”å¦‚å›¾ç‰‡ï¼‰éœ€è¦ç”¨åˆ°çš„é«˜åº¦å¤§äºè¿™ä¸ªå€¼æ—¶ï¼ŒCell ä¼šè‡ªåŠ¨è°ƒæ•´è‡ªå·±çš„é«˜åº¦ä»¥é€‚åº”å†…å®¹çš„å¤§å°ï¼Œå¹¶å¡«å……åˆé€‚çš„é—´è·æ¥ç¾åŒ–æˆ‘ä»¬çš„åˆ—è¡¨é¡¹ã€‚è¿™äº›å°ç»†èŠ‚å…¨éƒ½æ˜¯å…è´¹çš„ï¼</p><blockquote><p>é¢„è§ˆé‡Œçš„å›¾ç‰‡å½“ç„¶æ˜¯è¦æˆ‘ä»¬äº‹å…ˆå¯¼å…¥çš„ï¼Œå› ä¸ºè·Ÿ SwiftUI æ²¡ä»€ä¹ˆå…³ç³»ï¼Œæ‰€ä»¥è¿™é‡Œä¹Ÿå°±è·³è¿‡äº†è¿™ä¸€æ­¥ï¼›è€Œä¸”æˆ‘ä¹Ÿæ‡’å¾—æ‰¾å›¾ç‰‡æ¥ä»£æ›¿å®ƒä»¬äº†ï¼Œæ‰€ä»¥æˆªå›¾é‡Œçœ‹åˆ°çš„è¿˜æ˜¯ä¹‹å‰é»˜è®¤å›¾çš„æ ·å­â€¦</p></blockquote><h2 id="navigationviewcontroller-navigationbar">NavigationViewController &amp; NavigationBar</h2><p>å­¤é›¶é›¶çš„ä¸€ä¸ªåˆ—è¡¨å¯èƒ½è¿˜ä¸å¤Ÿæœ‰æ„æ€ï¼Œä¸€èˆ¬æ¥è¯´åˆ—è¡¨æ˜¯ç½—åˆ—æ¦‚è¦æ•°æ®ç”¨çš„ï¼Œä¸ºäº†çœ‹åˆ°æ›´å®Œæ•´çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šåœ¨ç”¨æˆ·ç‚¹å‡»åˆ—è¡¨é¡¹çš„æ—¶å€™è·³è½¬åˆ°ä¸€ä¸ªè¯¦æƒ…ç•Œé¢ï¼Œè¿™å°±æ¶‰åŠåˆ°äº†ç•Œé¢å¯¼èˆªçš„æ¦‚å¿µã€‚</p><p>åœ¨åŸæ¥çš„å¼€å‘è¿‡ç¨‹é‡Œï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±ä¼šå®ç°ä¸€ä¸ª <code>NavigationViewController</code> å»æŠŠæˆ‘ä»¬åˆ—è¡¨çš„è§†å›¾æ§åˆ¶å™¨åŒ…è£¹èµ·æ¥ï¼Œç„¶åé€šè¿‡ push &amp; pop è¿™æ ·çš„æ“ä½œæ¥å®ç°ç•Œé¢çš„åˆ‡æ¢ã€‚</p><p>ä¸€èµ·æ¥çœ‹çœ‹ SwiftUI æ˜¯æ€ä¹ˆåšçš„ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">NavigationView</span> &#123; <span class="comment">// 1</span></span><br><span class="line">    <span class="type">List</span>(rooms) &#123; </span><br><span class="line">  <span class="comment">// åˆ—è¡¨é¡¹çš„å¸ƒå±€ </span></span><br><span class="line">  &#125;</span><br><span class="line">  .navigationBarTitle(<span class="type">Text</span>(<span class="string">"Rooms"</span>)) <span class="comment">// 2</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>æˆ‘ä»¬ç”¨ä¸€ä¸ª <code>NavigationView</code> æŠŠåŸæœ¬ <code>body</code> é‡Œçš„å…¨éƒ¨å†…å®¹åŒ…è£¹èµ·æ¥ï¼Œå°±åƒæˆ‘ä»¬åŸæ¥ç”¨ <code>NavigationViewController</code> æŠŠ <code>UIViewController</code> åŒ…èµ·æ¥ä¸€ä¸ªé“ç†</li><li>ç„¶åï¼Œæˆ‘ä»¬ç»™ <code>NavigationView</code> é‡Œçš„æœ€å¤–å±‚å­è§†å›¾ï¼ˆåœ¨è¿™é‡Œå°±æ˜¯ <code>List</code>ï¼‰åŠ ä¸€ä¸ªä¿®é¥°å™¨æ¥é…ç½®å¯¼èˆªæ çš„æ ‡é¢˜ï¼›æ³¨æ„æˆ‘ä»¬è¿™é‡Œä¼ çš„æ˜¯ä¸€ä¸ª <code>View</code>ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒä¸ä»…é™äºæ˜¾ç¤ºæ–‡å­—ï¼Œè¿˜å¯ä»¥æ˜¯å„ç§å„æ ·éµå¾ª <code>View</code> åè®®çš„è§†å›¾</li></ol><p>å®Œæˆè¿™ä¸¤æ­¥å°±å¯ä»¥åœ¨åŸæœ‰çš„è§†å›¾ä¹‹ä¸Šæ˜¾ç¤ºä¸€ä¸ªå¯¼èˆªæ äº†ï¼Œä¸è¿‡è¿˜ä¸å¤Ÿï¼Œæˆ‘ä»¬è¦ç»™åˆ—è¡¨é¡¹åŠ ä¸Šç‚¹å‡»äº‹ä»¶ä»¥ä¾¿è·³è½¬åˆ°è¯¦æƒ…ç•Œé¢ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">List</span>(rooms) &#123; </span><br><span class="line">    <span class="type">NavigationButton</span>(destination: <span class="type">Text</span>(room.name)) &#123;</span><br><span class="line">        <span class="comment">// åˆ—è¡¨é¡¹çš„å¸ƒå±€</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œå°±åªæœ‰ä¸€æ­¥ï¼šæŠŠåŸå…ˆç”¨äºå¸ƒå±€åˆ—è¡¨é¡¹çš„ä»£ç ç”¨ä¸€ä¸ª <code>NavigationButton</code> åŒ…èµ·æ¥ï¼ŒåŒæ—¶é€šè¿‡å‚æ•°æ¥æŒ‡å®šè¿™ä¸ªå¯¼èˆªäº‹ä»¶çš„ç›®çš„åœ°ã€‚å¦‚ä¾‹å­çš„ä»£ç æ‰€ç¤ºï¼Œå®ç°çš„æ•ˆæœæ˜¯ç‚¹å‡»åˆ—è¡¨é¡¹ä¹‹åè·³è½¬åˆ°ä¸€ä¸ªæ–°çš„ç•Œé¢ï¼Œç•Œé¢ä¸­ä¼šå±…ä¸­æ˜¾ç¤ºæˆ¿é—´çš„åå­—ï¼š<br><img src="/uploads/swiftui-serial-tutorial-4/IMG_E91EAE65D877-1.jpeg" alt></p><p>åœ¨åŠ ä¸Š <code>NavigationButton</code> ä¹‹åï¼Œç»†å¿ƒçš„ç«¥é‹ä»¬å¯èƒ½å·²ç»å‘ç°æˆ‘ä»¬åˆ—è¡¨é¡¹çš„å˜åŒ–äº†ï¼šæ¯ä¸€é¡¹çš„å°¾éƒ¨éƒ½æ˜¾ç¤ºäº†ä¸€ä¸ªå°å°–è§’ï¼Œè¿™æ˜¯ iOS é‡Œç”¨äºè¡¨ç¤ºåˆ—è¡¨å¯ä»¥â€œç‚¹å‡»æŸ¥çœ‹æ›´å¤šâ€çš„å¸¸è§å…ƒç´ äº†ã€‚</p><p>OKï¼Œç”¨ Live Mode è¿è¡Œä¸€ä¸‹é¢„è§ˆï¼Œå¯ä»¥çœ‹åˆ° SwiftUI å·²ç»æŠŠè½¬åœºè¿‡ç¨‹ä¸­çš„æ ‡é¢˜åŠ¨ç”»å¤„ç†å¥½äº†ï¼Œç•Œé¢è·³è½¬ã€æ‰‹åŠ¿è¿”å›ï¼Œå…¨éƒ½ä¸èˆ¬é¡ºæ»‘ã€‚</p><h2 id="è¡¨å•">è¡¨å•</h2><p>ä¸¤ä¸ªå…¸å‹çš„å¸¸ç”¨ç»„ä»¶æˆ‘ä»¬å·²ç»çœ‹å®Œäº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬è¦å®ç°ä¸€ä¸ªæ›´å¤æ‚ä¸€äº›çš„ç•Œé¢ã€‚å¾€å¸¸è¦å®ç°è¿™ä¹ˆä¸€ä¸ªç•Œé¢ï¼Œè™½è¯´æ²¡æœ‰å¤ªå¤šçš„æ™ºåŠ›æ´»ï¼Œä½†ä½“åŠ›æ´»æ˜¯è‚¯å®šå°‘ä¸äº†çš„ã€‚</p><p>ä¸€å›¾èƒœåƒè¨€ï¼Œå…ˆæ¥çœ‹çœ‹æ•ˆæœå›¾ï¼š<br><img src="/uploads/swiftui-serial-tutorial-4/00BD9E2A-5EFD-4B06-86E1-E008B2FA3D55.png" alt><br>è¿™ç§ç•Œé¢åœ¨ç”¨æˆ·æ³¨å†Œçš„è¿‡ç¨‹ä¸­ä¹Ÿæ˜¯æŒºå¸¸è§çš„ï¼Œå€Ÿç”¨ä¸€ä¸ªå‰ç«¯çš„æ¦‚å¿µâ€”â€”å®ƒå«åšâ€œè¡¨å•ï¼ˆFormï¼‰â€ã€‚</p><h3 id="ç¯å¢ƒå‡†å¤‡">ç¯å¢ƒå‡†å¤‡</h3><p>æ¥ä¸‹æ¥çš„ä»£ç é‡Œï¼Œæœ‰äº›ç±»éœ€è¦åœ¨ Xcode11 beta 4 ç‰ˆæœ¬ä¸Šæ‰èƒ½ä½¿ç”¨ï¼ˆå…¶å®æˆ‘åªçŸ¥é“ Beta 1 ç”¨ä¸äº†ï¼Œä½†å…·ä½“å“ªä¸ªç‰ˆæœ¬å˜åŒ–çš„å°±ä¸æ¸…æ¥šäº†ï¼‰ï¼Œå»ºè®®å¤§å®¶å…ˆæ›´æ–°ä¸€ä¸‹ Xcodeï¼Œä¸ç„¶å°±åªèƒ½åœ¨æ–‡ç« é‡Œè¿‡è¿‡çœ¼ç˜¾å•¦ã€‚è™½è¯´ WWDC å±•ç¤ºçš„æ—¶å€™é‚£ä¸ªè®²å¸ˆæ˜æ˜å°±å·²ç»ç”¨ä¸Šäº†ï¼Œæœç„¶å‘å¸ƒä¼šè¦ç”¨ç‰¹ä¾›ç‰ˆæœ¬åœ¨å“ªé‡Œéƒ½æ˜¯æƒ¯ä¾‹å•Šã€‚</p><p>é¡ºå¸¦ä¸€æï¼Œè¿™ç§å˜åŒ–é™¤äº†æ›´æ–°è½¯ä»¶ä¹‹åä¸Šæ‰‹è¯•è¯•ä¹‹å¤–ï¼Œè¿˜èƒ½åœ¨å“ªé‡Œçœ‹åˆ°å‘¢ï¼Ÿç­”æ¡ˆå°±æ˜¯ï¼šå®˜æ–¹æ–‡æ¡£ï¼<br><img src="/uploads/swiftui-serial-tutorial-4/1BCC5384-E073-417C-A7AA-DF85A6253099.png" alt><br>åœ¨ç½‘é¡µä¸Šæ‰¾åˆ°ä½ æƒ³çœ‹çš„ API ä¹‹åï¼ŒæŠŠå›¾ç¤ºå³ä¸Šè§’çš„ â€œAPI Changesâ€ æ‰“å¼€ï¼Œé€‰æ‹©è¦æ¯”è¾ƒçš„ç‰ˆæœ¬ï¼ˆå¯¹äº Beta ç‰ˆçš„è½¯ä»¶ï¼Œä¸€èˆ¬ä¸ä¼šç»™å‡ºæ¯ä¸ªç‰ˆæœ¬ä¹‹é—´çš„å˜åŒ–ï¼Œæ‰€ä»¥å¦‚ä¸Šæ‰€è¿°æˆ‘ä¹Ÿä¸çŸ¥é“ <code>Form</code> è¿™ä½å…„å¼Ÿæ˜¯ä»€ä¹ˆæ—¶å€™åŠ è¿›æ¥çš„ï¼‰ï¼Œç„¶åå°±èƒ½åœ¨ â€œSDKsâ€ ä¸‹é¢çœ‹åˆ°ç‰¹å®šç‰ˆæœ¬çš„éœ€æ±‚æ˜¯ä»€ä¹ˆæ—¶å€™åŠ è¿›æ¥çš„äº†ã€‚ä¸Šé¢çš„æˆªå›¾å°±è¡¨ç¤º macOS App åœ¨ Xcode beta 4 ç‰ˆæœ¬ä¸Šæ˜¯æ— æ³•ä½¿ç”¨ <code>Form</code> çš„ï¼Œå› ä¸ºå®ƒåœ¨ beta 5 æ‰è¢«æ­£å¼åŠ è¿›æ¥ã€‚</p><h3 id="éœ€æ±‚æ¢³ç†">éœ€æ±‚æ¢³ç†</h3><p>è®©æˆ‘ä»¬ç”¨å‰ä¸‰ç¯‡æ–‡ç« åŠ ä¸Šä¸Šé¢ä¸¤ä¸ªå°èŠ‚çš„çŸ¥è¯†ï¼Œæ¥åˆ¤æ–­ä¸€ä¸‹è¦æ€ä¹ˆå®ç°å®ƒã€‚</p><ol><li>æˆ‘ä»¬è¦æœ‰ä¸€ä¸ªå¤§å¤§çš„æ ‡é¢˜åœ¨ç•Œé¢å·¦ä¸Šè§’ï¼Œä¹Ÿè®¸æ˜¯ä¸€ä¸ª <code>navigationBarTitle</code> å¯ä»¥æå®šçš„äº‹æƒ…</li><li>æ ‡é¢˜ä¸‹é¢çš„å†…å®¹æ ·å¼çœ‹èµ·æ¥åƒæ˜¯ä¸€ä¸ª <code>UITableView</code></li><li>è¿™ä¸ªåˆ—è¡¨åˆ†äº†å¥½å‡ ä¸ª Sectionï¼Œæœ‰äº› Section æœ‰å±äºè‡ªå·±çš„æ ‡é¢˜ã€æœ‰äº›å´æ²¡æœ‰</li><li>æ¯ä¸€è¡Œéƒ½æœ‰è‡ªå·±çš„æ ·å¼ï¼Œå¯èƒ½è¦å®šåˆ¶å¥½å‡ ç§ <code>UITableViewCell</code>ï¼Œè€Œæœ€åä¸€è¡Œèµ·åˆ°çš„æ˜¯æŒ‰é’®çš„ä½œç”¨ï¼Œå¯ä»¥çœŸçš„ç”¨æŒ‰é’®å»å®ç°ï¼Œä¹Ÿå¯ä»¥ç”¨æ–‡å­—åŠ ä¸Šåˆ—è¡¨é¡¹ç‚¹å‡»äº‹ä»¶çš„æ–¹å¼æ¥åš</li></ol><h3 id="é‚£å°±åŠ¨æ‰‹å§">é‚£å°±åŠ¨æ‰‹å§ï¼</h3><p>çœ‹çœ‹ä¸Šé¢çš„éœ€æ±‚ï¼Œæ¯ä¸€ç‚¹éƒ½ä¸éš¾ï¼Œå¯å®ƒä»¬èƒœåœ¨å¤šå•Šï¼å¦‚æœç”¨ UIKit å»å®ç°ï¼Œå…‰æ˜¯æŠŠç•Œé¢åšå‡ºæ¥å°±å·²ç»è¦èŠ±ä¸å°‘ä»£ç ï¼Œæ›´åˆ«è¯´ç•Œé¢èƒŒåçš„æ•°æ®é€»è¾‘äº†ã€‚</p><p>äºæ˜¯ SwiftUI åº”è¿è€Œç”Ÿï¼Œè¿™ç§ç®€å•å…ƒç´ ç»„åˆè€Œæˆçš„å¤æ‚é¡µé¢æ­£æ˜¯å®ƒçš„å¼ºé¡¹ï¼</p><p>æˆ‘ä»¬ç›´æ¥çœ‹æœ€ç»ˆçš„ç•Œé¢ä»£ç ï¼Œä¸è¿‡ä½ ä¹Ÿä¸ç”¨çœ‹å¾—å¤ªä»”ç»†ï¼Œæˆ‘ä»¬ä¼šåœ¨ä¸‹é¢æŠŠå®ƒä¸€ç‚¹ç‚¹æ‹†å¼€æ¥è®²ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">FormView</span> : <span class="title">View</span> </span>&#123;</span><br><span class="line">    @<span class="type">State</span> <span class="keyword">var</span> userInfo = <span class="type">UserInfo</span>() <span class="comment">// 1</span></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Form</span> &#123; <span class="comment">// 2</span></span><br><span class="line">            <span class="type">Section</span>(header: <span class="type">Text</span>(â€œè´¦å·æ³¨å†Œâ€).font(.title)) &#123; <span class="comment">// 3</span></span><br><span class="line">                <span class="type">TextField</span>(â€œè¯·è¾“å…¥ç”¨æˆ·åâ€, text: $userInfo.name)</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">Section</span>(header: <span class="type">Text</span>(â€œç§æ—â€).font(.headline)) &#123;</span><br><span class="line">                <span class="type">Picker</span>(selection: $userInfo.race, label: <span class="type">Text</span>(â€œç§æ—â€)) &#123; <span class="comment">// 4</span></span><br><span class="line">                    <span class="type">ForEach</span>(<span class="type">Race</span>.allCases) &#123; race <span class="keyword">in</span> <span class="comment">// 4.1</span></span><br><span class="line">                        <span class="type">Text</span>(race.name).tag(race)</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;.pickerStyle(<span class="type">SegmentedPickerStyle</span>())</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">Section</span>(header: <span class="type">Text</span>(â€œå£å‘³â€).font(.headline)) &#123;</span><br><span class="line">                <span class="type">Toggle</span>(isOn: $userInfo.loveSweet) &#123; <span class="comment">// 5</span></span><br><span class="line">                    <span class="type">Text</span>(â€œå–œå¥½ç”œé£Ÿâ€)</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="type">Toggle</span>(isOn: $userInfo.loveSpicy) &#123;</span><br><span class="line">                    <span class="type">Text</span>(â€œçˆ±åƒè¾£â€)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">Section</span>(header: <span class="type">Text</span>(<span class="string">"å¹´é¾„"</span>).font(.headline)) &#123;</span><br><span class="line">                <span class="type">Stepper</span>(value: $userInfo.age, <span class="keyword">in</span>: <span class="number">1</span>â€¦<span class="number">120</span>)&#123; <span class="comment">// 6</span></span><br><span class="line">                    <span class="type">Text</span>(<span class="string">"å¹´é¾„ï¼š\(userInfo.age)"</span>)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="type">Section</span> &#123;</span><br><span class="line">                <span class="type">Button</span>(action: &#123;</span><br><span class="line">                    <span class="built_in">print</span>(â€œregister with info: \(<span class="keyword">self</span>.userInfo)â€)</span><br><span class="line">                &#125;) &#123;</span><br><span class="line">                    <span class="type">Text</span>(â€œ<span class="type">Register</span>â€)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å°½ç®¡æœ‰å‰å‡ ç¯‡æ–‡ç« çš„çŸ¥è¯†ä½œä¸ºé“ºå«ï¼Œä½†è¿™æ®µä»£ç é‡Œè¿˜æ˜¯æœ‰ä¸å°‘çš„æ–°é¢å­”å•Šã€‚</p><h4 id="userinfo">UserInfo</h4><p><code>UserInfo</code> çš„ç±»å‹å®šä¹‰æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">UserInfo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span> = â€œâ€</span><br><span class="line">    <span class="keyword">var</span> loveSweet = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">var</span> loveSpicy = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">var</span> age: <span class="type">Int</span> = <span class="number">18</span></span><br><span class="line">    <span class="keyword">var</span> race: <span class="type">Race</span> = .<span class="type">Yellow</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å®ƒå…¶å®å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„ç»“æ„ä½“ï¼Œç”¨æ¥è¡¨ç¤ºè¿™ä½ç”¨æˆ·çš„ä¸ªäººä¿¡æ¯ã€‚</p><p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« é‡Œæˆ‘ä»¬è®²è¿‡ï¼Œå¦‚æœè¦æŠŠä¸€ä¸ªå®Œæ•´çš„è‡ªå®šä¹‰å¯¹è±¡ç»‘å®šåˆ°è§†å›¾ä¸Šï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡çš„ç±»å‹å°±éœ€è¦éµå¾ª <code>BindableObject</code> åè®®ã€‚ä½†åœ¨è¿™ä¸ªä¾‹å­é‡Œï¼Œæˆ‘ä»¬åªæ˜¯å°†å¯¹è±¡çš„å±æ€§ç»‘å®šåˆ°äº†è§†å›¾ä¸Šï¼Œæˆ‘ä»¬åªåœ¨æ„è¿™äº›å±æ€§è€Œä¸æ˜¯å¯¹è±¡è¿™ä¸ªæ•´ä½“ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥é€šè¿‡ <code>@State</code> æ¥è¿›è¡Œå¯¹è±¡å±€éƒ¨çš„ç»‘å®šã€‚</p><h4 id="form">Form</h4><p>å¦‚å‰é¢çš„æ–‡æ¡£æˆªå›¾é‡Œæ‰€è¿°ï¼š<code>Form</code> æ˜¯ä¸€ä¸ªç”¨äºç»„åˆä¸€ç³»åˆ—æ•°æ®å…¥å£çš„è§†å›¾ï¼Œæ¯”å¦‚åº”ç”¨çš„è®¾ç½®é¡µé¢ï¼Œæˆ–è€…æ˜¯ä¾‹å­é‡Œçš„ç”¨æˆ·ä¿¡æ¯å½•å…¥ç•Œé¢ã€‚</p><p>è¯è¯´å›æ¥ï¼Œè¿™ä¹ˆå¤šæ–°ç©å…·ï¼Œåœ¨å¼€å‘è¿‡ç¨‹ä¸­æ€ä¹ˆçŸ¥é“æœ‰æ²¡æœ‰å¯ä»¥å¯¹ç—‡ä¸‹è¯çš„å‘¢ï¼Ÿå…¶å®å®ƒä»¬éƒ½æ•´æ•´é½é½ç åœ¨äº†åŸæ¥æˆ‘ä»¬ç”¨äºæŒ‘é€‰ xib æˆ–è€… storyboard ç»„ä»¶çš„åœ°æ–¹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ Cmd + L æŠŠè¿™ä¸ªç•Œé¢å¼„å‡ºæ¥ï¼š<br><img src="/uploads/swiftui-serial-tutorial-4/%E6%88%AA%E5%B1%8F2019-08-13%E4%B8%8B%E5%8D%8810.18.33.png" alt></p><h4 id="section">Section</h4><p>é¡¾åæ€ä¹‰ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºåˆ†åŒºçš„æ§ä»¶ï¼Œå®ƒä¹Ÿå¯ä»¥è¢«ç”¨åœ¨ <code>List</code> é‡Œé¢ï¼Œå°±ç»„æˆäº†æ‰€è°“çš„ â€œSectionListâ€ï¼Œä¾‹å¦‚é€šè®¯å½•é‡ŒæŒ‰é¦–å­—æ¯åˆ†åŒºçš„æ ·å¼ã€‚</p><p>ä¾‹å­ä¸­çš„ <code>Section</code> ç”¨äºç»™ <code>Form</code> é‡Œçš„ä¸åŒæ•°æ®è¿›è¡Œåˆ†ç±»ï¼Œå¹¶æä¾›ç»Ÿä¸€æ ·å¼çš„ Headerï¼Œå®ƒæ˜¾ç¤ºçš„å†…å®¹ä¹Ÿå¯ä»¥é€šè¿‡æ„é€ æ–¹æ³•é‡Œçš„ <code>header</code> å‚æ•°æ¥è¿›è¡Œä¿®æ”¹ã€‚</p><h4 id="picker">Picker</h4><p>è¿™æ˜¯ç›®å‰ä¸ºæ­¢ç¢°åˆ°çš„æœ€å¤æ‚çš„ç»„ä»¶äº†ï¼Œå®ƒæœ‰ç‚¹ç±»ä¼¼äº UIKit é‡Œçš„ <code>PickerView</code>ï¼Œä¸è¿‡å®ƒæ˜¯æ›´å¹¿ä¹‰çš„â€œé€‰æ‹©å™¨â€ï¼Œåœ¨æ ·å¼ä¸Šä¹Ÿä¼šæœ‰æ›´å¤šçš„å˜åŒ–å¯ä¾›é€‰æ‹©ï¼Œæ¯”å¦‚ä¾‹å­é‡Œçš„ <code>SegmentedPickerStyle</code>ï¼ˆæœ‰äº›æ ·å¼æ˜¯å¹³å°ç›¸å…³çš„ï¼Œåœ¨ä½¿ç”¨çš„æ—¶å€™è¦ç•™æ„ç¼–è¯‘å™¨çš„æé†’ï¼‰ã€‚</p><p>å…¶å®åªè¦æ˜ç™½ <code>$</code> å˜é‡çš„å«ä¹‰ï¼Œè¿™ä¸ªæ„é€ æ–¹æ³•ä¹Ÿå¾ˆå¥½ç†è§£ï¼Œå°±æ˜¯æŠŠé€‰æ‹©å™¨é‡Œé€‰ä¸­çš„å†…å®¹ä¸ <code>userInfo</code> å¯¹è±¡é‡Œçš„ <code>race</code> å±æ€§ç»‘å®šèµ·æ¥ã€‚</p><h5 id="foreach">ForEach</h5><p>è¿™ä¸ªå†™æ³•æœ¬è´¨ä¸Šè·Ÿå¾€ <code>List</code> çš„æ„é€ æ–¹æ³•é‡Œä¼ ä¸€ä¸ªæ•°ç»„çš„æ„æ€å·®ä¸å¤šï¼Œè¿™æ ·æ‹†å¼€æ¥å¯ä»¥è®©åˆ—è¡¨å‹è§†å›¾çš„å†…å®¹æ ·å¼æ›´ä¸°å¯Œï¼Œæ„Ÿå…´è¶£çš„ç«¥é‹ä»¬å¯ä»¥è¯¦ç»†çœ‹çœ‹<a href="https://developer.apple.com/videos/play/wwdc2019/204/" target="_blank" rel="noopener">è¿™ä¸ªè§†é¢‘</a>ï¼Œè¿™é‡Œå°±ä¸å±•å¼€è®²äº†ã€‚</p><p>å…¶ä¸­çš„ <code>Race</code> æ˜¯ä¸€ä¸ªæšä¸¾ç±»å‹ï¼Œå®ƒçš„å®ç°ä¹Ÿå¾ˆæœ‰æ„æ€ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Race</span> : <span class="title">CaseIterable</span>, <span class="title">Hashable</span>, <span class="title">Identifiable</span> </span>&#123; <span class="comment">// 1</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">Yellow</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">Black</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">White</span></span><br><span class="line">    <span class="keyword">case</span> <span class="type">Mixed</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> id: <span class="type">UUID</span> &#123; <span class="type">UUID</span>() &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> name: <span class="type">String</span> &#123;</span><br><span class="line">        <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</span><br><span class="line">            <span class="keyword">case</span> .<span class="type">Yellow</span>: <span class="keyword">return</span> <span class="string">"é»„ç§äºº"</span></span><br><span class="line">            <span class="keyword">case</span> .<span class="type">Black</span>: <span class="keyword">return</span> <span class="string">"é»‘ç§äºº"</span></span><br><span class="line">            <span class="keyword">case</span> .<span class="type">White</span>: <span class="keyword">return</span> <span class="string">"ç™½ç§äºº"</span></span><br><span class="line">            <span class="keyword">case</span> .<span class="type">Mixed</span>: <span class="keyword">return</span> <span class="string">"æ··è¡€"</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¾‹å­é‡Œçš„ <code>Race.allCase</code> æ˜¯éµå¾ª <code>CaseIterable</code> åè®®å¸¦ç»™æˆ‘ä»¬çš„ä¸€ä¸ªç¦åˆ©ï¼Œæ„æ€æ˜¯â€œæšä¸¾æ‰€æœ‰å¯èƒ½çš„å€¼â€ï¼Œäºæ˜¯æˆ‘ä»¬å°±å¯ä»¥æŠŠå®ƒç”¨åœ¨éœ€è¦æ•°ç»„ç±»å‹å‚æ•°çš„åœ°æ–¹äº†ã€‚</p><p>è€Œ <code>Hashable</code> å’Œ <code>Identifiable</code> æ˜¯ä¸ºäº†è®©è¿™ä¸ªæšä¸¾çš„å¯¹è±¡å¯ä»¥è¢«ä½œä¸ºå”¯ä¸€æ ‡è¯†ç¬¦æ¥ä½¿ç”¨ã€‚ä¹‹æ‰€ä»¥è¿™æ ·åšï¼Œæ˜¯å› ä¸º <code>Picker</code> çš„åˆ—è¡¨é¡¹å¿…é¡»è¦è®¾ç½® <code>tag</code> ä»¥åŒºåˆ†ç”¨æˆ·çš„é€‰æ‹©ï¼Œäºæ˜¯ä¾‹å­ä¸­å°±ç›´æ¥ç”¨äº†æšä¸¾å¯¹è±¡æœ¬èº«æ¥ä½œä¸ºé€‰é¡¹çš„ <code>tag</code>ã€‚</p><h4 id="toggle">Toggle</h4><p>è¿™ä¸ªæ§ä»¶çœ‹åå­—å°±è¯¥çŸ¥é“æ˜¯å¹²å˜›ç”¨çš„äº†ï¼Œæ­£å¦‚ Swift 4.2 ä¹‹åçš„å¸ƒå°”å€¼æœ‰äº†ä¸€ä¸ªå« <code>toggle</code> çš„è¯­æ³•ç³–ï¼Œè¿™ä¸ªæ§ä»¶å°±æ˜¯ç”¨æ¥æ ‡è¯†å¼€å…³çŠ¶æ€çš„ï¼Œä¹Ÿå°±æ˜¯åŸæ¥çš„ <code>UISwitch</code>ã€‚</p><h4 id="stepper">Stepper</h4><p>ç›´è¯‘è¿‡æ¥åº”è¯¥å«â€œæ­¥è¿›å™¨â€ã€‚å¯¹äºé‡è§†ç”¨æˆ·ä½“éªŒçš„è‹¹æœæ¥è¯´ï¼Œè¿™æ ·çœ‹ä¸Šå»ç®€å•ï¼Œä½†è¦æ­£ç¡®å®ç°é€»è¾‘è¿˜éœ€è¦è´¹ç‚¹å¿ƒæ€çš„å°ç©æ„å„¿ï¼Œå½“ç„¶æ˜¯é€‰æ‹©å°è£…æˆä¸€ä¸ªç³»ç»Ÿç»„ä»¶ï¼ç›¸ä¿¡çœ‹äº†å‰é¢é‚£äº›äº”èŠ±å…«é—¨çš„ç»„ä»¶ä¹‹åï¼Œè¿™ä¸ª <code>Stepper</code> çš„ç”¨æ³•ä¹Ÿæ˜¯ä¸éœ€è¦å†å¤šåŠ è§£é‡Šäº†ã€‚</p><h3 id="å°ç»“">å°ç»“</h3><p>å¥½äº†ï¼Œè¿™çŸ­çŸ­ä¸åˆ°40è¡Œçš„ä»£ç ï¼ˆå¥½å§ï¼Œç®—ä¸Šé‚£ä¸ªç»“æ„ä½“å’Œæšä¸¾ä¹Ÿæœ‰60è¡Œå·¦å³äº†ï¼‰ï¼Œå°±å·²ç»å®ç°äº†æˆ‘ä»¬è¿™ä¸€å°èŠ‚å¼€å¤´æˆªå›¾é‡Œçš„é‚£ç§è¡¨å•æ•ˆæœã€‚ä¸ä»…å¦‚æ­¤ï¼ŒSwiftUI è¿˜é»˜é»˜ä¸ºæˆ‘ä»¬åšäº†å¤§é‡çš„ä¼˜åŒ–å·¥ä½œï¼Œæˆ‘å¯ä»¥æ‹èƒ¸è„¯è¯´è¿™äº›ä»£ç åœ¨æ•ˆç‡ä¸Šä¹Ÿä¼šæ˜¯è¿œè¶… UIKit ç‰ˆæœ¬çš„ã€‚</p><h2 id="æ€»ç»“">æ€»ç»“</h2><p>å››ç¯‡æ–‡ç« ä¸‹æ¥ï¼Œè¿™ä¸ªç³»åˆ—çš„ SwiftUI æ•™ç¨‹ä¹Ÿç®—æ˜¯å‘Šä¸€æ®µè½äº†ã€‚æ˜¾ç„¶è¿™ä»…ä»…æ˜¯ä¸€ä¸ªå…¥é—¨æ•™ç¨‹ï¼Œæ›´å¤šæœ‰æ„æ€çš„æ–°å…ƒç´ è¿˜åœ¨åé¢ç­‰ç€ä½ ã€‚</p><p>æ–‡ç« é‡Œé¢çš„ä¾‹å­éƒ½æ˜¯é€šè¿‡ Xcode çš„æ–°åŠŸèƒ½ Canvas é¢„è§ˆå’Œæˆªå›¾å‡ºæ¥çš„ï¼Œç›®å‰å®ƒä¹Ÿåªæœ‰ä¸ª iPhone çš„å¤–æ¡†æ ·å¼ï¼Œè¿™éš¾å…æœ‰ç‚¹é™åˆ¶äº†æˆ‘ä»¬çš„æƒ³è±¡ï¼Œæ‰€ä»¥æˆ‘å¿…é¡»è¦åœ¨æœ€åæé†’å¤§å®¶ä¸€å¥ï¼š</p><p><strong>ç”¨ SwiftUI æ„å»ºçš„ç•Œé¢å¤©ç”Ÿå°±æ˜¯è·¨å…¨è‹¹æœå¹³å°çš„ï¼</strong></p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œä¹‹å‰ä¾‹å­é‡Œçš„<strong>æ‰€æœ‰ä»£ç æ”¾åˆ° macOS å’Œ watchOS ä¸Šéƒ½æ˜¯é€‚ç”¨çš„</strong>ï¼ï¼ˆå½“ç„¶è¦é™¤æ‰è·Ÿ UIKit æ··åˆçš„é‚£éƒ¨åˆ†ï¼‰è€Œä¸”æ‰€æœ‰ç•Œé¢çš„æ ·å¼éƒ½ä¼šæ ¹æ®å¹³å°çš„ä¸åŒè€Œè‡ªåŠ¨è°ƒæ•´ï¼Œå‡ ä¹ä¸éœ€è¦å¼€å‘è€…çš„ä»‹å…¥å°±å¯ä»¥åšåˆ°å…¨å¹³å°é€‚é…ï¼</p><p>å†™åˆ°è¿™çš„æ—¶å€™æˆ‘å±…ç„¶æ„Ÿè§‰æŒºå…´å¥‹çš„ï¼Œå°±åƒæ˜¯å›åˆ°äº†åˆšåˆšæ¥è§¦ Xcode å’Œåœ¨ iOS 5 ä¸Šåšå¼€å‘çš„é‚£ä¸ªå¹´ä»£ã€‚é‚£ä¸ªæ—¶å€™ Android å·²ç»æœ‰å¥½äº›æœºå‹è¦é€‚é…ï¼Œè€Œæˆ‘åªè¦æŠŠåº”ç”¨åœ¨æˆ‘æ‰‹é‡Œçš„ iPhone ä¸Šè·‘é¡ºå°±å…«ä¹ä¸ç¦»åäº†:)</p><h2 id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </h2><ul><li><a href="https://developer.apple.com/videos/play/wwdc2019/204/" target="_blank" rel="noopener">Introducing SwiftUI: Building Your First App - WWDC 2019 - Videos - Apple Developer</a></li><li><a href="https://developer.apple.com/videos/play/wwdc2019/216/" target="_blank" rel="noopener">SwiftUI Essentials - WWDC 2019 - Videos - Apple Developer</a></li><li><a href="https://onevcat.com/2019/06/swift-ui-firstlook-2/" target="_blank" rel="noopener">SwiftUI çš„ä¸€äº›åˆæ­¥æ¢ç´¢ (äºŒ)</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å’±ä»¬æœ€æœ‰æ„æ€çš„ç¬¬å››ç¯‡ SwiftUI æ•™ç¨‹æ¥å•¦ï¼ä¸ºä»€ä¹ˆè¯´æ˜¯â€œæœ€æœ‰æ„æ€â€çš„å‘¢ï¼Ÿå› ä¸ºæŒ‰ç…§çº¦å®šï¼Œåœ¨è¿™ç¯‡æ–‡ç« é‡Œæˆ‘ä»¬ä¼šä¸€èµ·æ¥çœ‹çœ‹ç”¨ SwiftUI å¼€å‘ç•Œé¢çš„å¿«æ·ä¾¿åˆ©ä½“ç°åœ¨ä»€ä¹ˆåœ°æ–¹ã€‚ç›¸ä¿¡è¿™ä¼šè®©è®¸å¤šè‹¹æœå¼€å‘è€…ä»¬è€³ç›®ä¸€æ–°ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ä¿¡äº†è‹¹æœæ•™ä¹‹åï¼Œæ¯æ¬¡æœ‰ä»€ä¹ˆæ›´æ–°ï¼Œæˆ‘æœ€æœŸå¾…çš„éƒ½æ˜¯éšè—åœ¨å¤§åŠŸèƒ½ä¸‹çš„å°ç»†èŠ‚ï¼Œä¸çŸ¥é“æœ‰å¤šå°‘äººè·Ÿæˆ‘ä¸€æ ·ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="Swift" scheme="http://davidleee.com/tags/Swift/"/>
    
      <category term="SwiftUI" scheme="http://davidleee.com/tags/SwiftUI/"/>
    
      <category term="List" scheme="http://davidleee.com/tags/List/"/>
    
      <category term="NavigationView" scheme="http://davidleee.com/tags/NavigationView/"/>
    
      <category term="NavigationButton" scheme="http://davidleee.com/tags/NavigationButton/"/>
    
      <category term="Form" scheme="http://davidleee.com/tags/Form/"/>
    
      <category term="Picker" scheme="http://davidleee.com/tags/Picker/"/>
    
      <category term="Toggle" scheme="http://davidleee.com/tags/Toggle/"/>
    
      <category term="Section" scheme="http://davidleee.com/tags/Section/"/>
    
      <category term="Stepper" scheme="http://davidleee.com/tags/Stepper/"/>
    
  </entry>
  
  <entry>
    <title>SwiftUI ç³»åˆ—æ•™ç¨‹ï¼ˆ3ï¼‰â€”â€” SwiftUI æ•°æ®æµ</title>
    <link href="http://davidleee.com/2019/07/25/swiftui-serial-tutorial-3/"/>
    <id>http://davidleee.com/2019/07/25/swiftui-serial-tutorial-3/</id>
    <published>2019-07-25T08:41:24.000Z</published>
    <updated>2020-05-05T03:43:31.445Z</updated>
    
    <content type="html"><![CDATA[<p>é€šè¿‡å‰ä¸¤ç¯‡æ–‡ç« ï¼ˆSwiftUI ç³»åˆ—æ•™ç¨‹ <a href="/2019/06/12/swiftui-serial-tutorial-1/" title="ï¼ˆ1ï¼‰">ï¼ˆ1ï¼‰</a> å’Œ <a href="/2019/07/08/swiftui-serial-tutorial-2/" title="ï¼ˆ2ï¼‰">ï¼ˆ2ï¼‰</a>ï¼‰ï¼Œæˆ‘ä»¬å·²ç»çœ‹åˆ°äº† SwiftUI æ˜¯æ€ä¹ˆè¿ä½œçš„äº†ï¼Œå¯¹äºå¸¸è§„çš„ç•Œé¢å…ƒç´ æ¥è¯´ï¼Œä½¿ç”¨ SwiftUI ç¡®å®èƒ½å¸¦æ¥ä¸å°çš„ç”Ÿäº§åŠ›æå‡ã€‚ä½†æ˜¯åœ¨å‰é¢çš„ä¾‹å­é‡Œï¼Œæˆ‘ä»¬ç”¨åˆ°çš„æ•°æ®å…¨éƒ½æ˜¯å†™æ­»çš„ï¼Œè¿™è·Ÿå¤æ‚å¤šå˜çš„çœŸå®éœ€æ±‚å¯ä¸å¤§ä¸€æ ·ã€‚è¿™ç¯‡æ–‡ç« æˆ‘ä»¬å°±æ¥äº†è§£ä¸€ä¸‹ï¼ŒSwiftUI é‡Œç”¨åˆ°çš„å…¨æ–°çš„æ•°æ®æµæ¨¡å‹ã€‚</p><blockquote><p>ç›¸æ¯”èµ·å‰ä¸¤ç¯‡å®æ“æ–‡ï¼Œè¿™ç¯‡æ–‡ç« å¯èƒ½ä¼šæ¯”è¾ƒå¹²ï¼Œè¯·å¤§å®¶çœ‹æ–‡ç« ä¹‹å‰å…ˆè®¿é—®ä¸€ä¸‹é¥®æ°´æœºã€‚</p></blockquote><a id="more"></a><h2 id="å…ˆçœ‹çœ‹åˆ«äººå®¶æ˜¯æ€ä¹ˆåšçš„">å…ˆçœ‹çœ‹åˆ«äººå®¶æ˜¯æ€ä¹ˆåšçš„</h2><h3 id="è€ä¸œå®¶">è€ä¸œå®¶</h3><p>å­¦ä¹ è¿‡æ–¯å¦ç¦å…¬å¼€è¯¾çš„å°ä¼™ä¼´ä»¬åº”è¯¥å¯¹ä¸‹é¢è¿™å¼ å›¾ç‰‡å¾ˆæœ‰å°è±¡äº†ï¼š<br><img src="/uploads/swiftui-serial-tutorial-3/mvc1.png" alt></p><p>è¿™æ˜¯ iOS è‡ªå‡ºé“ä»¥æ¥å°±éå¸¸æ¨å´‡çš„ï¼Œå¯è°“æ˜¯â€œå®˜æ–¹å»ºè®®â€çš„æ•°æ®æµæ¨¡å‹ï¼Œä¹Ÿå°±æ˜¯å¤§å®¶éƒ½ç†ŸçŸ¥çš„ MVC æ¨¡å¼ã€‚</p><p>ä» GUI å¼€å§‹å…´èµ·ä»¥æ¥ï¼ŒåŸºäºèŒè´£åˆ†ç¦»çš„æ€æƒ³ï¼Œå·¥ç¨‹å¸ˆä»¬æ…¢æ…¢æŠŠç®¡ç†ç”¨æˆ·ç•Œé¢çš„ View å’Œç®¡ç†ç”¨æˆ·æ•°æ®çš„ Model ç»™åŒºåˆ†äº†å¼€æ¥ï¼›è€Œä» Smalltalk çš„æŸä¸ªç‰ˆæœ¬å¼€å§‹ï¼Œä¸ºäº†è¿›ä¸€æ­¥é™ä½å›¾å½¢åº”ç”¨ç¨‹åºçš„ç®¡ç†éš¾åº¦ï¼Œè®¾è®¡å‡ºäº† MVC æ¨¡å¼ã€‚MVC çš„å‡ºç°ä¸»è¦æ˜¯ä¸ºäº†è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜ï¼š</p><ol><li>å¦‚ä½•ç®¡ç†å“åº”ç”¨æˆ·æ“ä½œçš„ä¸šåŠ¡é€»è¾‘</li><li>View å¦‚ä½•åŒæ­¥ Model çš„å˜åŒ–</li></ol><p>è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜ä¹Ÿæ˜¯å¤§å¤šæ•°ä¸ºç°ä»£å›¾å½¢ç•Œé¢åº”ç”¨ç¨‹åºè€Œè¯ç”Ÿçš„è®¾è®¡æ¨¡å¼ä»¬çš„ç›®æ ‡ï¼Œæ¯”å¦‚ MVVMã€MVPã€‚</p><h3 id="éš”å£å‰ç«¯å®¶">éš”å£å‰ç«¯å®¶</h3><p>å› ä¸ºæœ‰ç€ä¸€æ®µä¸é•¿ä¸çŸ­çš„ React Native å¼€å‘ç»å†ï¼ˆç›®å‰è¿˜åœ¨åšç€ï¼‰ï¼Œæ‰€ä»¥ä»è¿™ä¸ªè§’åº¦çœ‹è¿‡å»ï¼Œæ¯”è¾ƒæˆç†Ÿçš„æ–¹æ¡ˆæ˜¯ Redux + React Reduxã€‚</p><p>Redux æ˜¯ä¸“ä¸º JavaScript è½¯ä»¶æ‰“é€ çš„ä¸€ä¸ªå¯é¢„æµ‹çŠ¶æ€å®¹å™¨ã€‚å¬èµ·æ¥å¾ˆå‰å®³çš„æ ·å­ï¼Œå…¶å®ä¸»è¦æ˜¯åšäº†ä¸‰ä¸ªäº‹æƒ…ï¼š</p><ol><li>æŠŠ Model å±‚çš„æ•°æ®ç»Ÿä¸€æ”¾åˆ°ä¸€ä¸ªåœ°æ–¹</li><li>çº¦å®šåªèƒ½é€šè¿‡ç‰¹å®šçš„æ‰‹æ®µå»æ”¹å˜æ•°æ®ï¼Œé™¤æ­¤ä¹‹å¤–ï¼Œæ•°æ®å°±æ˜¯åªè¯»çš„</li><li>çº¦å®šæ”¹å˜æ•°æ®çš„æ“ä½œå¿…é¡»æ˜¯çº¯å‡½æ•°</li></ol><p>è¿™æ ·åšäº†ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ç¡®å®šè¿™ä¸ªæ•°æ®æºæ˜¯å¯ä»¥çœŸå®ååº”æˆ‘ä»¬çš„åº”ç”¨çŠ¶æ€çš„ï¼Œæ‰€ä»¥å«åšâ€œå¯é¢„æµ‹çŠ¶æ€å®¹å™¨ï¼ˆPredictable State Containerï¼‰â€ã€‚</p><p>ç„¶å React Redux å°±å¥½ç†è§£äº†ï¼Œå®ƒçš„ä»»åŠ¡æ˜¯å»ºç«‹ä¸€å¥—æœºåˆ¶ï¼Œè®©ä¸Šè¿°çš„çŠ¶æ€ä¸€ä¸€ç»‘å®šåˆ°è§†å›¾ä¸Šï¼Œå®ç°ä¸€æ¡åŒå‘æ›´æ–°çš„é€šé“ã€‚</p><blockquote><p>Redux å’Œ React Redux éƒ½æ˜¯ Redux å®˜æ–¹å‡ºå“ï¼Œæ‰€ä»¥è´¨é‡è¿˜æ˜¯æ¯”è¾ƒæœ‰ä¿è¯çš„ã€‚ä¸‹é¢è¿™ä¸¤ç¯‡æ–‡ç« åº”è¯¥å¯ä»¥ç»™å¤§å®¶æŠ€æœ¯é€‰å‹çš„æ—¶å€™æä¾›ä¸€äº›æ”¯æŒï¼š<br><a href="https://redux.js.org/introduction/motivation" target="_blank" rel="noopener">Motivation Â· Redux</a><br><a href="https://react-redux.js.org/introduction/why-use-react-redux" target="_blank" rel="noopener">Why Use React Redux? Â· React Redux</a></p></blockquote><h2 id="swift-çš„å®ç°">Swift çš„å®ç°</h2><p>å¦‚æœä½ è§‰å¾— SwiftUI åœ¨æ„é€ ç•Œé¢æ—¶ç”¨åˆ°çš„å£°æ˜å¼è¯­æ³•è·Ÿ JSX çš„ç›¸ä¼¼åº¦å¾ˆé«˜çš„è¯ï¼Œé‚£åœ¨ä»‹ç»å®Œå®ƒçš„æ•°æ®ç»‘å®šé€»è¾‘ä¹‹åï¼Œä½ è‚¯å®šä¼šå†ä¸€æ¬¡æŠŠå®ƒæ‹¿æ¥è·Ÿ JavaScript åšæ¯”è¾ƒäº†ã€‚</p><p>SwiftUI ä¸­å¼•å…¥äº†ä¸€ä¸ªå…³é”®å­— <code>@State</code> æ¥ä½œä¸ºæ•°æ®ç»‘å®šçš„æ ‡è¯†ã€‚å½“ä¸€ä¸ªè¢«ç»‘å®šçš„æ•°æ®è¢«æ”¹å˜æ—¶ï¼Œç›¸å…³è”çš„è§†å›¾ä¼šé‡æ–°è®¡ç®—å®ƒè‡ªå·±çš„ <code>body</code> å†…å®¹ï¼›åè¿‡æ¥ï¼Œå½“è§†å›¾ä¸»åŠ¨å»æ”¹å˜ç»‘å®šåœ¨æ•°æ®ä¸Šçš„å±æ€§æ—¶ï¼Œè¿™ä¸ªæ•°æ®ä¹Ÿä¼šéšä¹‹å˜åŒ–ã€‚è¿™ç§åŒå‘ç»‘å®šçš„æœºåˆ¶å°±åƒ JSX + Redux + React Redux çš„ç»„åˆæ‹³ï¼Œåªä¸è¿‡ SwiftUI è‡ªå·±å°±æŠŠè¿™äº›äº‹æƒ…ç»™åšäº†ã€‚</p><p>ä½†æ˜¯ï¼Œå‡­ä»€ä¹ˆ SwiftUI ç”¨å‡ ä¸ªå…³é”®å­—å°±å®ç°äº†åˆ«äººæ•´æ•´ä¸¤ä¸ªå¼€æºåº“çš„åŠŸèƒ½ï¼Ÿå…¶å®è¿™å¾—ç›Šäº Swift 5.1 çš„æ–°åŠŸèƒ½â€”â€”å±æ€§åŒ…è£…ï¼ˆProperty Wrappersï¼‰ã€‚</p><h3 id="æ·±æŒ–ä¸€ç‚¹ç‚¹">æ·±æŒ–ä¸€ç‚¹ç‚¹</h3><p>åœ¨ 2019 å¹´3æœˆä»½çš„æ—¶å€™ï¼ŒSwift æ ¸å¿ƒå›¢é˜Ÿé‡Œçš„æˆå‘˜å·²ç»é€éœ²å‡ºäº†ä¸€ä¸ªä½œç”¨ç±»ä¼¼äº <code>lazy</code> å…³é”®å­—çš„æ–°åŠŸèƒ½ï¼Œé‚£ä¸ªæ—¶å€™å®ƒè¢«ç§°ä¸ºâ€œå±æ€§ä»£ç†â€ï¼ˆProperty Delegatesï¼‰ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œå»¶è¿Ÿåˆå§‹åŒ–å¯è°“æ˜¯ç¼–ç¨‹é‡Œçš„ä¸€ç§ç¾å¾·ï¼Œåœ¨ Swift çš„ä¸–ç•Œé‡Œï¼Œé™¤äº†ç›´æ¥ç”¨ <code>lazy</code>ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨ä¸€ä¸ªç§æœ‰å±æ€§åŠ ä¸Šä¸€ä¸ªä½œä¸ºè®¿é—®å™¨çš„ Computed Property æ¥å®ç°ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">var</span> _lazyProp: <span class="type">Prop?</span></span><br><span class="line"><span class="keyword">var</span> lazyProp: <span class="type">Prop</span> &#123;</span><br><span class="line">    <span class="keyword">get</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">let</span> value = _lazyProp &#123; <span class="keyword">return</span> value &#125;</span><br><span class="line">        <span class="keyword">let</span> initialValue = ... <span class="comment">// åˆå§‹åŒ–æ•°æ®</span></span><br><span class="line">        _lazyProp = initialValue</span><br><span class="line">        <span class="keyword">return</span> initialValue</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">set</span> &#123;</span><br><span class="line">        _lazyProp = newValue</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚ä»Šï¼ŒProperty Wrappers ä¸ºæˆ‘ä»¬æä¾›äº†ç¬¬ä¸‰æ¡è·¯å¯èµ°ï¼Œä¸ä»…å¦‚æ­¤ï¼Œå®ƒè¿˜æ‰¿è¯ºä¼šä¸ºå¼€å‘è€…ä»¬æä¾›äº†ä¸€ç§å®ç°ç±»ä¼¼ <code>lazy</code> å…³é”®å­—ç”¨æ³•çš„é€”å¾„ã€‚</p><p>åœ¨ SwiftUI çš„åŠŸèƒ½æè®® <a href="https://github.com/apple/swift-evolution/blob/master/proposals/0258-property-wrappers.md" target="_blank" rel="noopener">SE-0258</a> é‡Œå¯ä»¥çœ‹åˆ°ï¼ŒProperty Wrappers çš„ä¸»è¦ç›®çš„å°±æ˜¯ä¸ºäº†é¿å…å¼€å‘è€…é‡å¤å†™å‡ºä¸Šé¢é‚£ç§å›ºå®šæ¨¡å¼çš„ä»£ç ã€‚æ—¢ç„¶è¿™ç§å†™æ³•æ˜¯æ¯”è¾ƒå›ºå®šçš„ï¼Œé‚£ä¹ˆå°±åº”è¯¥å®šä¹‰å‡ºä¸€ç§æœºåˆ¶ï¼Œæ¥æŠŠå„ç§å›ºå®šå†™æ³•å®šä¹‰æˆä¸€ä¸ªä¸ªçš„å·¥å…·åº“ã€‚</p><h3 id="å®˜æ–¹çš„è§£å†³æ–¹æ¡ˆ">å®˜æ–¹çš„è§£å†³æ–¹æ¡ˆ</h3><p>è¿˜æ˜¯ç”¨ <code>lazy</code> çš„ä¾‹å­ï¼Œæ€ä¹ˆç”¨ Property Wrappers æ¥å®ç°ä¸€ä¸ªåŒæ ·çš„åŠŸèƒ½å‘¢ï¼Ÿæ¯”å¦‚å®ç°ä¸€ä¸ªä½œç”¨ç›¸åŒçš„ <code>@Lazy</code> å±æ€§ï¼Ÿ</p><p>å®˜æ–¹ç»™å‡ºçš„è§£å†³æ–¹æ¡ˆæ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@propertyWrapper</span></span><br><span class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Lazy</span>&lt;<span class="title">Value</span>&gt; </span>&#123;</span><br><span class="line">  <span class="keyword">case</span> uninitialized(() -&gt; <span class="type">Value</span>)</span><br><span class="line">  <span class="keyword">case</span> initialized(<span class="type">Value</span>)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">init</span>(wrappedValue: <span class="meta">@autoclosure</span> @escaping () -&gt; <span class="type">Value</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span> = .uninitialized(wrappedValue)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> wrappedValue: <span class="type">Value</span> &#123;</span><br><span class="line">    <span class="keyword">mutating</span> <span class="keyword">get</span> &#123;</span><br><span class="line">      <span class="keyword">switch</span> <span class="keyword">self</span> &#123;</span><br><span class="line">      <span class="keyword">case</span> .uninitialized(<span class="keyword">let</span> initializer):</span><br><span class="line">        <span class="keyword">let</span> value = initializer()</span><br><span class="line">        <span class="keyword">self</span> = .initialized(value)</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">      <span class="keyword">case</span> .initialized(<span class="keyword">let</span> value):</span><br><span class="line">        <span class="keyword">return</span> value</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">set</span> &#123;</span><br><span class="line">      <span class="keyword">self</span> = .initialized(newValue)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¦‚æ­¤ä¸€æ¥ï¼Œä¸‹é¢è¿™ç§å˜é‡å£°æ˜</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="type">Lazy</span> <span class="keyword">var</span> foo = <span class="number">123</span></span><br></pre></td></tr></table></figure><p>å°±ä¼šè¢«å±•å¼€æˆè¿™æ ·ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">var</span> _foo: <span class="type">Lazy</span>&lt;<span class="type">Int</span>&gt; = <span class="type">Lazy</span>&lt;<span class="type">Int</span>&gt;(wrappedValue: <span class="number">123</span>) <span class="comment">// 1</span></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="keyword">var</span> foo: <span class="type">Int</span> &#123;</span><br><span class="line">  <span class="keyword">get</span> &#123; <span class="keyword">return</span> _foo.wrappedValue &#125;</span><br><span class="line">  <span class="keyword">set</span> &#123; _foo.wrappedValue = newValue &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>è°ƒç”¨äº† <code>Lazy</code> çš„ <code>init</code> æ–¹æ³•æ¥è¿›è¡Œåˆå§‹åŒ–ä¸€ä¸ªç§æœ‰å˜é‡ï¼Œå®ƒçš„ç±»å‹æ˜¯ <code>Lazy&lt;Int&gt;</code></li><li>é€šè¿‡æŠŠåŸå˜é‡åŒ…è£…æˆä¸€ä¸ª Computed Value çš„æ–¹å¼æ¥å¯¹æ¥ <code>wrappedValue</code> é‡Œæä¾›çš„çœŸæ­£çš„é€»è¾‘å®ç°</li></ol><p>ä¸ä»…å¦‚æ­¤ï¼Œæ—¢ç„¶ <code>@Lazy</code> æ˜¯ä¸€ä¸ª <code>enum</code> ï¼Œé‚£å®ƒæœ¬èº«å°±å¯ä»¥å®šä¹‰äº”èŠ±å…«é—¨çš„å…¬å¼€æ–¹æ³•ï¼Œè€Œæ¯ä¸€ä¸ªè¢« <code>@propertyWrapper</code> æ ‡è®°çš„ç±»å‹éƒ½å¯ä»¥é€šè¿‡å®šä¹‰ä¸€ä¸ª <code>projectedValue</code> å±æ€§æ¥å®ç°ä¸€äº›éªšæ“ä½œï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@propertyWrapper</span><br><span class="line">enum Lazy&lt;Value&gt; &#123;</span><br><span class="line">    // ... å†…å®¹è·Ÿå‰é¢ä¸€æ · ...</span><br><span class="line"></span><br><span class="line">    // å®šä¹‰ä¸€ä¸ªé‡ç½®çš„æ–¹æ³•ï¼ŒæŠŠ @Lazy æ ‡è®°çš„å˜é‡è¿˜åŸä¸ºä¸€ä¸ªä¸åŒçš„åˆå§‹å€¼</span><br><span class="line">    public mutating func reset(_ newValue:  @autoclosure @escaping () -&gt; Value) &#123;</span><br><span class="line">        self = .uninitialized(newValue)</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    public var projectedValue: Self &#123;</span><br><span class="line">        get &#123; self &#125;</span><br><span class="line">        set &#123; self = newValue &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å£°æ˜äº† <code>projectedValue</code> ä¹‹å ï¼Œæˆ‘ä»¬å°±è‡ªåŠ¨è·å¾—äº†ä¸€ä¸ªå¸¦ <code>$</code> ç¬¦å·çš„åˆ†èº«ç”¨æ¥è®¿é—®æˆ‘ä»¬ <code>projectedValue</code> çš„ getterï¼Œä»è€Œè°ƒç”¨åˆ°é‡Œé¢çš„æ–¹æ³•ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@<span class="type">Lazy</span> <span class="keyword">var</span> foo = <span class="number">123</span></span><br><span class="line">$foo.reset(<span class="number">456</span>)</span><br></pre></td></tr></table></figure><p>ä¸Šé¢é‚£å¥å£°æ˜å˜é‡çš„è¯­å¥ï¼Œä¼šå±•å¼€æˆè¿™æ ·ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">var</span> _foo: <span class="type">Lazy</span>&lt;<span class="type">Int</span>&gt; = <span class="type">Lazy</span>&lt;<span class="type">Int</span>&gt;(wrappedValue: <span class="number">123</span>)</span><br><span class="line"><span class="keyword">var</span> foo: <span class="type">Int</span> &#123;</span><br><span class="line">  <span class="keyword">get</span> &#123; <span class="keyword">return</span> _foo.wrappedValue &#125;</span><br><span class="line">  <span class="keyword">set</span> &#123; _foo.wrappedValue = newValue &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ... ä¸Šé¢è·ŸåŸæ¥ä¸€æ ·ï¼Œä¸‹é¢æ˜¯æ·»åŠ äº† projectedValue ä¹‹åæ–°å¢çš„ ...</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> $foo: <span class="type">Lazy</span>&lt;<span class="type">Int</span>&gt; &#123;</span><br><span class="line">  <span class="keyword">get</span> &#123; _foo.projectedValue &#125;</span><br><span class="line">  <span class="keyword">set</span> &#123; _foo.projectedValue = newValue &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å…¶å®ç»™ <code>Lazy</code> æ·»åŠ  <code>extension</code> ä¹Ÿå¯ä»¥è¾¾åˆ°ç±»ä¼¼çš„ç›®çš„ï¼Œä¸è¿‡è¿™æ—¶å€™çš„æ–¹æ³•è°ƒç”¨å°±è¦é€šè¿‡ <code>_foo</code> æ¥è¿›è¡Œï¼Œè€Œä¸æ˜¯ <code>$foo</code> äº†</p></blockquote><h2 id="è¯´å›-swiftui">è¯´å› SwiftUI</h2><p>SwiftUI çš„æ•°æ®æµæ¨¡å‹æ˜¯åŸºäºä¸‹é¢ä¸¤ç‚¹åŸåˆ™æ¥æ„å»ºçš„ï¼š</p><ol><li>Data Access as a Dependency</li><li>Source of Truth</li></ol><p>æˆ‘ä»¬å±•å¼€æ¥çœ‹ï¼š</p><h3 id="data-access-as-a-dependency">Data Access as a Dependency</h3><p>åœ¨å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬çš„è§†å›¾æ˜¯éœ€è¦æ ¹æ®æŸäº›çŠ¶æ€æ¥åŠ¨æ€å˜åŒ–æ˜¾ç¤ºæ ·å¼çš„ï¼Œæ¯”å¦‚å¯¹äº <code>Switch</code> æ¥è¯´ï¼Œæ”¹å˜å®ƒçš„ <code>on</code> å±æ€§å¯ä»¥è®©å®ƒæ˜¾ç¤ºå½“å‰çš„å¼€å…³çŠ¶æ€ã€‚</p><p>å¯¹äºè¿™ç§æƒ…å†µï¼Œ<code>on</code> å±æ€§å°±åº”è¯¥ä½œä¸º <code>Switch</code> çš„ä¾èµ–è€Œå­˜åœ¨ï¼Œå¦åˆ™è¿™ä¸ªæ§ä»¶é™¤äº†é•¿å¾—å¥½çœ‹å°±ä¸€æ— æ˜¯å¤„äº†ã€‚æ‰€ä»¥åœ¨ SwiftUI é‡Œï¼Œå±æ€§ä¼šè¢«æè¿°ä¸ºè§†å›¾çš„ä¾èµ–ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬çš„æ³¨æ„åŠ›å¯ä»¥ä»å±æ€§å’Œè§†å›¾çš„å…³è”é‡ŒæŠ½èº«å‡ºæ¥ï¼Œé›†ä¸­åœ¨å»ºç«‹æ›´å¥½çš„ç”¨æˆ·ä½“éªŒä¸Šã€‚</p><h3 id="source-of-truth">Source of Truth</h3><p>åŒä¸€ç»„è§†å›¾é‡Œçš„æ•°æ®éƒ½æ˜¯æ¥è‡ªäºåŒä¸€ä¸ªæ•°æ®æºçš„ï¼ˆç”šè‡³æ•´ä¸ªåº”ç”¨çš„æ•°æ®éƒ½æ¥è‡ªäºåŒä¸€ä¸ªæ•°æ®æºï¼ŒRedux å°±æ˜¯è¿™ä¹ˆåšçš„ï¼‰ã€‚</p><p>å¯¹äºå¼€å‘è€…æ¥è¯´ï¼Œæ•°æ®æºçš„ä¸å”¯ä¸€æ„å‘³ç€è§†å›¾çŠ¶æ€çš„ä¸å”¯ä¸€ã€‚å¯ä»¥æƒ³è±¡ï¼Œä½äºåŒä¸€è§†å›¾å±‚çº§çš„ä¸¤ä¸ªè§†å›¾è¦å…±ç”¨æŸäº›å‚æ•°æ—¶ï¼Œæ•°æ®æ¥æºçš„ä¸å”¯ä¸€ä¼šä¸ºç¼–ç¨‹å¸¦æ¥å¤šå¤§çš„éº»çƒ¦ã€‚<br><img src="/uploads/swiftui-serial-tutorial-3/D1B04594-7FAA-4391-AC05-CBC2BF839DD8.png" alt></p><p>SwiftUI å¯¹è¿™ç§æƒ…å†µçš„å¤„ç†æ˜¯ï¼Œè®©çˆ¶è§†å›¾ä½œä¸ºå­è§†å›¾çš„å”¯ä¸€æ•°æ®æºï¼š<br><img src="/uploads/swiftui-serial-tutorial-3/4CDDC5EC-0093-46EE-A17A-F38972875AF8.png" alt></p><blockquote><p>åšè¿‡å‰ç«¯ UI å¼€å‘çš„ç«¥é‹ä»¬åº”è¯¥å¾ˆç†Ÿæ‚‰è¿™å¥—æ“ä½œäº†ï¼Œè¿™å°±æ˜¯æŠŠ State ä¸Šææˆ Props å˜›ï¼Œç›®çš„æ˜¯è®©å­è§†å›¾å°½å¯èƒ½çš„ç®€å•ï¼Œæœ€å¥½çš„æƒ…å†µä¸‹å­è§†å›¾æœ¬èº«åº”è¯¥æ˜¯æ— çŠ¶æ€çš„ã€‚</p></blockquote><p>äºæ˜¯æˆ‘ä»¬å¯ä»¥å¾—å‡ºï¼ŒåŸºäºè¿™ä¸¤ä¸ªåŸåˆ™æ¥å®ç°çš„æ•°æ®æµæ¨¡å‹å·²ç»å®Œå…¨ä¸åŒäºæˆ‘ä»¬ä»¥å¾€çš„ç†è§£ï¼Œæˆ‘ä»¬éœ€è¦é‡æ–°å®šä¹‰æˆ‘ä»¬æ‰€è®¤è¯†çš„è§†å›¾ï¼š<strong>è§†å›¾è¦ä½“ç°çš„æ˜¯ä¸€ä¸ªä¸ªç‹¬ç«‹çš„çŠ¶æ€ï¼Œè€Œä¸æ˜¯ä¸€ç³»åˆ—è¿ç»­çš„äº‹ä»¶</strong> ã€‚</p><h2 id="å®è·µå‡ºçœŸçŸ¥">å®è·µå‡ºçœŸçŸ¥</h2><p>è¯´äº†è¿™ä¹ˆå¤šï¼Œæˆ‘ä»¬æ¥å®é™…æ”¹é€ ä¸€æ®µä»£ç è¯•è¯•ã€‚</p><p>å‡è®¾æˆ‘ä»¬è¦å®ç°ä¸€ä¸ªæ’­æ”¾å™¨çš„æ’­æ”¾æŒ‰é’®ï¼Œéœ€æ±‚æ˜¯å®ƒè¦èƒ½ååº”æ’­æ”¾çŠ¶æ€ï¼š</p><ol><li>æ²¡æœ‰éŸ³é¢‘æ’­æ”¾æ—¶ï¼Œå®ƒè¡¨ç°ä¸ºæ’­æ”¾æŒ‰é’®</li><li>åœ¨æœ‰éŸ³é¢‘æ’­æ”¾æ—¶ï¼Œå®ƒè¡¨ç°ä¸ºæš‚åœæŒ‰é’®</li></ol><p>æˆ‘ä»¬é€šè¿‡ç»™æŒ‰é’®è®¾ç½®ä¸åŒçš„å›¾ç‰‡æ¥åŒºåˆ†è¿™ä¸¤ä¸ªçŠ¶æ€ï¼ŒæŒ‰ç…§ä¹‹å‰çš„çŸ¥è¯†ï¼Œæˆ‘ä»¬èƒ½è½»æ¾å†™ä¸‹è¿™æ ·çš„ä»£ç ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">PlayerView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> isPlaying: <span class="type">Bool</span> = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Button</span>(action: &#123;</span><br><span class="line">            <span class="keyword">self</span>.isPlaying = !<span class="keyword">self</span>.isPlaying</span><br><span class="line">        &#125;) &#123;</span><br><span class="line">            <span class="keyword">self</span>.isPlaying ? <span class="type">Text</span>(<span class="string">"Pause"</span>) : <span class="type">Text</span>(<span class="string">"Play"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç­‰ç­‰ï¼Œæˆ‘ä»¬è¿™ä¸ª <code>PlayerControl</code> æ˜¯ <code>struct</code> ç±»å‹çš„ï¼Œä¸èƒ½è¿™æ ·ç›´æ¥æ”¹å˜å±æ€§çš„å€¼ï¼š<br><img src="/uploads/swiftui-serial-tutorial-3/29C7C479-1EBA-47FD-B9C5-1037A6FC8E17.png" alt></p><p>å…¶ä¸­ä¸€ä¸ªå®‰æŠšç¼–è¯‘å™¨çš„æ–¹æ³•æ˜¯ï¼Œç”¨ä¸€ä¸ªä¸´æ—¶å˜é‡æ¥æ›¿ä»£ <code>self</code>ï¼Œæˆ‘ä»¬é¡ºä¾¿æŠŠå¸ƒå°”å€¼å–åçš„æ“ä½œä¹Ÿç®€åŒ–ä¸€ä¸‹ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">PlayerView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">var</span> isPlaying: <span class="type">Bool</span> = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Button</span>(action: &#123;</span><br><span class="line">            <span class="keyword">var</span> tempSelf = <span class="keyword">self</span> <span class="comment">// å®‰æŠšç¼–è¯‘å™¨</span></span><br><span class="line">            tempSelf.isPlaying.toggle() <span class="comment">// Implemented in Swift 4.2</span></span><br><span class="line">        &#125;) &#123;</span><br><span class="line">            <span class="keyword">self</span>.isPlaying ? <span class="type">Text</span>(<span class="string">"Pause"</span>) : <span class="type">Text</span>(<span class="string">"Play"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å¥½äº†ï¼Œè¿™æ ·ä¸€æ”¹ï¼Œé‚£å¥ä¸´æ—¶å˜é‡èµ‹å€¼è¯­å¥å°±æˆä¸ºäº†å¤œç©ºä¸­æœ€äº®çš„æ˜Ÿï¼Œæ€ä¹ˆçœ‹æ€ä¹ˆåˆ«æ‰­â€¦</p><p>é‚£æ¥ä¸‹æ¥å°±è½®åˆ° SwiftUI é‡Œå®šä¹‰çš„ Property Wrappers å‡ºåœºäº†ï¼Œè¿™æ®µä»£ç å¯ä»¥æ”¹å†™æˆè¿™æ ·ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">PlayerView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    @<span class="type">State</span> <span class="keyword">private</span> <span class="keyword">var</span> isPlaying: <span class="type">Bool</span> = <span class="literal">false</span> <span class="comment">// åŠ ä¸Š `@State` æ ‡è®°</span></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Button</span>(action: &#123;</span><br><span class="line">            <span class="keyword">self</span>.isPlaying.toggle() <span class="comment">// å¯ä»¥ç›´æ¥æ”¹åŠ¨ `self` é‡Œçš„å˜é‡äº†</span></span><br><span class="line">        &#125;) &#123;</span><br><span class="line">            <span class="keyword">self</span>.isPlaying ? <span class="type">Text</span>(<span class="string">"Pause"</span>) : <span class="type">Text</span>(<span class="string">"Play"</span>)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼¼ä¹â€¦ä¹Ÿæ²¡å¤ªå¤§å˜åŒ–å•Šï¼Œä»£ç é‡ä¹Ÿä¸è§å°‘ï¼Œåªä¸è¿‡æ˜¯çœæ‰äº†ä¸´æ—¶å˜é‡äº†ï¼Ÿ<br>è¿™æ˜¯å› ä¸ºï¼Œè¿™æ ·çš„å†™æ³•è¿˜æ˜¯æ ¹æ®æˆ‘ä»¬çš„æƒ¯å¸¸æ€ç»´æ¥èµ°ï¼Œå›å¿†ä¸€ä¸‹ä¸Šé¢è®²åˆ°çš„ SwiftUI æ•°æ®æ¨¡å‹åŸåˆ™ï¼š</p><ol><li>ä»¥ä¾èµ–çš„å½¢å¼è®¿é—®æ•°æ®</li><li>å•ä¸€æ•°æ®æº</li></ol><p>ä¾‹å­é‡Œçš„å†™æ³•è²Œä¼¼ç¬¦åˆäº†â€œå•ä¸€æ•°æ®æºâ€ï¼Œä½†æ˜¯å´æŠŠâ€œä»¥ä¾èµ–çš„å½¢å¼è®¿é—®æ•°æ®â€æ™¾åœ¨äº†ä¸€è¾¹ã€‚æˆ‘ä»¬æ¥è¿›ä¸€æ­¥æ”¹é€ è¿™ä¸ªä¾‹å­ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">PlayerView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    @<span class="type">State</span> <span class="keyword">private</span> <span class="keyword">var</span> isPlaying: <span class="type">Bool</span> = <span class="literal">false</span></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">PlayButton</span>(isPlaying: $isPlaying) <span class="comment">// 1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">PlayButton</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    @<span class="type">Binding</span> <span class="keyword">var</span> isPlaying: <span class="type">Bool</span> <span class="comment">// 2</span></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Button</span>(action: &#123;</span><br><span class="line">            <span class="keyword">self</span>.isPlaying.toggle()</span><br><span class="line">        &#125;) &#123;</span><br><span class="line">            <span class="type">Text</span>(isPlaying ? <span class="string">"Pause"</span> : <span class="string">"Play"</span>) <span class="comment">// 3</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>ä½¿ç”¨ <code>@State</code> æ ‡è®°çš„å˜é‡ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªä»¥ <code>$</code> ä½œä¸ºå‰ç¼€çš„æ–°å˜é‡ï¼Œè¿™ä¸ªæ–°å˜é‡æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª Computed Valueï¼Œå®ç°äº†åŒå‘ç»‘å®šçš„æœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯è¯´å½“ <code>PlayButton</code> å†…éƒ¨æ”¹å˜äº†è¿™ä¸ªå˜é‡ä¹‹åï¼Œ<code>PlayerView</code> é‡Œçš„ <code>isPlaying</code> ä¹Ÿä¼šå‘ç”Ÿç›¸åŒçš„å˜åŒ–</li><li>é€šè¿‡å£°æ˜å˜é‡ä¸º <code>@Binding</code>ï¼Œæˆ‘ä»¬å°±å‘Šè¯‰äº†ç¼–è¯‘å™¨è¿™ä¸ªå˜é‡æ˜¯ä»å¤–éƒ¨ä¼ å…¥çš„å¯ä»¥è¢«ç»‘å®šçš„å‚æ•°ï¼Œç›¸å½“äº React é‡Œçš„ <code>Props</code> å£°æ˜</li><li>æˆ‘ä»¬å°† <code>isPlaying</code> ä½œä¸º <code>Text</code> çš„ä¾èµ–æ¥ä½¿ç”¨ï¼Œå¯¹äº <code>PlayButton</code> æ¥è¯´ï¼Œå˜é‡çš„å£°æ˜å’Œä½¿ç”¨éƒ½æ˜¯åœ¨ä¸€ä¸ªç»“æ„ä½“é‡Œé¢å®Œæˆçš„ï¼Œè¿™å°±æ„å‘³ç€è¿™ä¸ªè§†å›¾ä¸ <code>PlayerView</code> æ˜¯è§£å¶çš„</li></ol><blockquote><p><code>@Binding</code> å…·æœ‰ä»¥ä¸‹ä¸¤ç§ç‰¹æ€§ï¼š</p><ol><li>åœ¨ä¸æŒæœ‰å˜é‡çš„å‰æä¸‹è¿›è¡Œå˜é‡çš„è¯»å†™</li><li>å¯ä»¥ä» <code>@State</code> å˜é‡ä¸­æ¨å¯¼å‡ºæ¥</li></ol></blockquote><p>ç°åœ¨å›å¿†ä¸€ä¸‹ï¼Œåœ¨ SwiftUI ä¹‹å‰æˆ‘ä»¬æ˜¯æ€ä¹ˆå®ç°ç±»ä¼¼é€»è¾‘çš„ï¼Ÿåœ¨ä¸çŸ¥ä¸è§‰ä¸­ï¼Œæˆ‘ä»¬å·²ç»èˆå¼ƒäº† ViewControllerï¼Œè®©è§†å›¾ç›´æ¥æˆä¸ºäº†æ•°æ®çš„è½½ä½“ã€‚ç”šè‡³å¯ä»¥è¯´ï¼Œåœ¨ SwiftUI é‡Œï¼Œè§†å›¾å°±æ˜¯ä¸ºæ•°æ®æœåŠ¡çš„ã€‚</p><blockquote><p><code>@State</code> æ ‡è®°çš„å±æ€§ä¸€æ—¦å˜åŒ–ï¼Œä¼šå¼•èµ·ä¾èµ–å®ƒçš„è§†å›¾ã€è¿™ä¸ªè§†å›¾çš„çˆ¶è§†å›¾å’Œå®ƒçš„åŒçº§è§†å›¾ä¸€èµ·åš<strong>å¿…è¦çš„</strong>å˜åŒ–ã€‚ä¸ºä»€ä¹ˆè¦å¼ºè°ƒ<strong>å¿…è¦çš„</strong>ï¼Ÿå› ä¸ºç›¸è¾ƒäºç¹é‡çš„æ¸²æŸ“å·¥ä½œæ¥è¯´ï¼Œå¯¹å£°æ˜å¼è¯­æ³•æè¿°å‡ºæ¥çš„æ•°æ®ç»“æ„è¿›è¡Œæ¯”è¾ƒå¹¶ä¸æ¶ˆè€—ä»€ä¹ˆæ€§èƒ½ï¼ŒSwiftUI ä¼šåœ¨é‡æ–°æ¸²æŸ“å‰å¯¹è§†å›¾çŠ¶æ€è¿›è¡Œæ¯”è¾ƒï¼Œå°½å¯èƒ½åœ°å»é¿å…æ— è°“çš„ç»˜åˆ¶ï¼Œæ‰€ä»¥ä¸éœ€è¦æ‹…å¿ƒæ€§èƒ½çš„é—®é¢˜ã€‚<br>ç±»ä¼¼äº <code>React.PureComponent</code> æä¾›çš„é€»è¾‘ã€‚</p></blockquote><h2 id="å°ç»“">å°ç»“</h2><p>åŸºäºè¿™å¥—æ•°æ®æ¨¡å‹å®ç°å‡ºæ¥çš„æ•°æ®æµå¯ä»¥ç”¨ä¸‹é¢è¿™å¼ å›¾ç‰‡æ¥è¡¨ç¤ºï¼š<br><img src="/uploads/swiftui-serial-tutorial-3/870E1C27-D2D8-41AD-BBF2-66AABA4BD04A.png" alt><br>è¦çŸ¥é“ï¼ŒAction ä¸åªå¯ä»¥æ¥è‡ªäºç”¨æˆ·äº¤äº’ï¼Œå®ƒè¿˜å¯ä»¥æ¥è‡ªæˆ‘ä»¬è‡ªå·±å®ç°çš„è§¦å‘å™¨ã€æ¶ˆæ¯æ¨é€ç­‰ç­‰ï¼Œè€Œä¸ç®¡æ¥æºæ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬å®ç°çš„é€»è¾‘éƒ½å¯ä»¥ç†è§£å¹¶åšå‡ºåŒæ ·çš„å¤„ç†ã€‚</p><p>è¿™æ ·çš„æ•°æ®æµæ¨¡å¼ç¡®ä¿äº†æ•°æ®çš„æµåŠ¨æ°¸è¿œæ˜¯å•å‘çš„ï¼Œè€Œ State åœ¨è¿™é‡Œå……å½“äº†è§†å›¾å˜åŒ–çš„å”¯ä¸€æ•°æ®æºï¼Œè®©è§†å›¾çš„æ›´æ–°æ˜¯å¯é¢„æµ‹å’Œæ˜“æ‡‚çš„ã€‚</p><blockquote><p>å½“ç„¶ï¼Œ<code>@State</code> ä¹Ÿæœ‰å®ƒçš„å±€é™æ€§ï¼Œæ¯”å¦‚å®ƒæ— æ³•æ­£ç¡®å¤„ç†æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„å¯¹è±¡ç±»å‹çš„å±æ€§å˜åŒ–ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦ BindableObject åè®®æ¥ä»æ—è¾…åŠ©ï¼Œè¿™é‡Œå°±ä¸ç»§ç»­å±•å¼€äº†ã€‚</p></blockquote><p>äº†è§£äº†è§†å›¾åŸºç¡€å’Œæ•°æ®æµæ¨¡å‹ï¼Œç›¸ä¿¡å¤§å®¶éƒ½å·²ç»çœ‹åˆ°äº† SwiftUI çš„é­…åŠ›ï¼Œä½™ä¸‹çš„ç»†èŠ‚å°±éœ€è¦å„ä½å¼€å‘è€…åœ¨å®é™…åº”ç”¨ä¸­å‘æ˜äº†ã€‚ä¸‹ä¸€è®²å°±è®©æˆ‘ä»¬æ¥æŠŠè¿™ä¸ªé­…åŠ›ç»§ç»­æ‰©å¤§ï¼Œä¸€èµ·æ¥å®é™…çœ‹çœ‹ SwiftUI è¿˜ç»™æˆ‘ä»¬çš„å¼€å‘å¸¦æ¥äº†å“ªäº›å¥½å¤„ã€‚</p><h2 id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </h2><ul><li><a href="https://www.linuxidc.com/Linux/2015-10/124622.htm" target="_blank" rel="noopener">ç•Œé¢ä¹‹ä¸‹ï¼šè¿˜åŸçœŸå®çš„ MVCã€MVPã€MVVM æ¨¡å¼</a></li><li><a href="https://redux.js.org/introduction/motivation" target="_blank" rel="noopener">Motivation Â· Redux</a></li><li><a href="https://react-redux.js.org/introduction/why-use-react-redux" target="_blank" rel="noopener">Why Use React Redux? Â· React Redux</a></li><li><a href="https://developer.apple.com/documentation/swiftui/state_and_data_flow" target="_blank" rel="noopener">State and Data Flow | Apple Developer Documentation</a></li><li><a href="https://nshipster.com/propertywrapper/" target="_blank" rel="noopener">Swift Property Wrappers - NSHipster</a></li><li><a href="https://github.com/apple/swift-evolution/blob/master/proposals/0258-property-wrappers.md" target="_blank" rel="noopener">swift-evolution/0258-property-wrappers.md at master Â· apple/swift-evolution Â· GitHub</a></li><li><a href="https://developer.apple.com/videos/play/wwdc2019/226/" target="_blank" rel="noopener">Data Flow Through SwiftUI - WWDC 2019 - Videos - Apple Developer</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;é€šè¿‡å‰ä¸¤ç¯‡æ–‡ç« ï¼ˆSwiftUI ç³»åˆ—æ•™ç¨‹ &lt;a href=&quot;/2019/06/12/swiftui-serial-tutorial-1/&quot; title=&quot;ï¼ˆ1ï¼‰&quot;&gt;ï¼ˆ1ï¼‰&lt;/a&gt; å’Œ &lt;a href=&quot;/2019/07/08/swiftui-serial-tutorial-2/&quot; title=&quot;ï¼ˆ2ï¼‰&quot;&gt;ï¼ˆ2ï¼‰&lt;/a&gt;ï¼‰ï¼Œæˆ‘ä»¬å·²ç»çœ‹åˆ°äº† SwiftUI æ˜¯æ€ä¹ˆè¿ä½œçš„äº†ï¼Œå¯¹äºå¸¸è§„çš„ç•Œé¢å…ƒç´ æ¥è¯´ï¼Œä½¿ç”¨ SwiftUI ç¡®å®èƒ½å¸¦æ¥ä¸å°çš„ç”Ÿäº§åŠ›æå‡ã€‚ä½†æ˜¯åœ¨å‰é¢çš„ä¾‹å­é‡Œï¼Œæˆ‘ä»¬ç”¨åˆ°çš„æ•°æ®å…¨éƒ½æ˜¯å†™æ­»çš„ï¼Œè¿™è·Ÿå¤æ‚å¤šå˜çš„çœŸå®éœ€æ±‚å¯ä¸å¤§ä¸€æ ·ã€‚è¿™ç¯‡æ–‡ç« æˆ‘ä»¬å°±æ¥äº†è§£ä¸€ä¸‹ï¼ŒSwiftUI é‡Œç”¨åˆ°çš„å…¨æ–°çš„æ•°æ®æµæ¨¡å‹ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ç›¸æ¯”èµ·å‰ä¸¤ç¯‡å®æ“æ–‡ï¼Œè¿™ç¯‡æ–‡ç« å¯èƒ½ä¼šæ¯”è¾ƒå¹²ï¼Œè¯·å¤§å®¶çœ‹æ–‡ç« ä¹‹å‰å…ˆè®¿é—®ä¸€ä¸‹é¥®æ°´æœºã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="Swift" scheme="http://davidleee.com/tags/Swift/"/>
    
      <category term="Redux" scheme="http://davidleee.com/tags/Redux/"/>
    
      <category term="SwiftUI" scheme="http://davidleee.com/tags/SwiftUI/"/>
    
      <category term="MVC" scheme="http://davidleee.com/tags/MVC/"/>
    
      <category term="React" scheme="http://davidleee.com/tags/React/"/>
    
      <category term="Property Wrappers" scheme="http://davidleee.com/tags/Property-Wrappers/"/>
    
      <category term="State" scheme="http://davidleee.com/tags/State/"/>
    
      <category term="Binding" scheme="http://davidleee.com/tags/Binding/"/>
    
  </entry>
  
  <entry>
    <title>SwiftUI ç³»åˆ—æ•™ç¨‹ï¼ˆ2ï¼‰â€”â€” ä¸ UIKit ç»“åˆçš„è‡ªå®šä¹‰è§†å›¾</title>
    <link href="http://davidleee.com/2019/07/08/swiftui-serial-tutorial-2/"/>
    <id>http://davidleee.com/2019/07/08/swiftui-serial-tutorial-2/</id>
    <published>2019-07-08T03:15:32.000Z</published>
    <updated>2020-05-05T03:43:31.444Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨<a href="/2019/06/12/swiftui-serial-tutorial-1/" title="ä¸Šä¸€ç¯‡æ–‡ç« ">ä¸Šä¸€ç¯‡æ–‡ç« </a>ä¸­ï¼Œæˆ‘ä»¬äº†è§£äº† SwiftUI çš„ <code>Text</code>  ç»„ä»¶ï¼Œå¹¶é€šè¿‡ <code>Stack</code> ç³»åˆ—çš„ç»„ä»¶å¯¹å†…å®¹è¿›è¡Œäº†ä¸€äº›ç®€å•çš„å¸ƒå±€ã€‚åœ¨è¿™ç¯‡æ–‡ç« é‡Œï¼Œæˆ‘ä»¬ä¼šè®¤è¯†ä¸€ä¸ªå…¨æ–°çš„å›¾ç‰‡ç»„ä»¶ï¼Œå¹¶ä¸”ä¼šå°è¯•åˆ©ç”¨è¿™ä¸¤ç¯‡æ–‡ç« çš„çŸ¥è¯†ï¼Œç»“åˆ MapKit æ¡†æ¶ï¼Œæ¥å®ç°ä¸€ä¸ªç®€å•çš„åœ°ç‚¹è¯¦æƒ…ç•Œé¢ã€‚</p><a id="more"></a><blockquote><p>å†™å®Œç¬¬ä¸€ç¯‡æ–‡ç« ä¹‹åï¼Œæœ¬èŒçš„å¼€å‘ä»»åŠ¡çªç„¶è¿›å…¥äº†ç´§å¼ çš„é¢„å‘å¸ƒé˜¶æ®µï¼Œæå¾—æ—©å°±å†™å¥½çš„ç¬¬äºŒç¯‡æ–‡ç« æ‹–äº†è¿™ä¹ˆä¹…æ‰å®Œæˆæ¶¦è‰²å’Œå‘å¸ƒï¼Œçœ‹æ¥â€œå…¨ç½‘æœ€æ—©â€è¦ä¸¢äº†â€¦</p></blockquote><h2 id="è‡ªå®šä¹‰å›¾ç‰‡è§†å›¾">è‡ªå®šä¹‰å›¾ç‰‡è§†å›¾</h2><p>é¦–å…ˆæŠŠä¸€å¼ åœ°æ ‡å›¾ç‰‡æ”¾åˆ° <em>Assets.xcassets</em> é‡Œå»ï¼Œæˆ‘åœ¨ç™¾åº¦æ‰¾äº†å¼ å¹¿å·å¡”çš„ç…§ç‰‡ï¼š<br><img src="/uploads/swiftui-serial-tutorial-2/BF6A8678-F10F-4633-A932-94B781BE73F9.png" alt></p><p>ç„¶åï¼Œæˆ‘ä»¬è¦ä¸ºæ–°çš„å›¾ç‰‡è§†å›¾åˆ›å»ºä¸€ä¸ªæ–°çš„ç±»ï¼Œå°±æ”¾åœ¨ä¸Šä¸€ç¯‡æ–‡ç« çš„ <em>ContentView.swift</em> æ—è¾¹å¥½äº†ã€‚æ–°å»ºæ–‡ä»¶çš„æ—¶å€™ï¼Œé€‰æ‹© <strong>SwiftUI View</strong>ï¼š<br><img src="/uploads/swiftui-serial-tutorial-2/8A140752-2AE7-40E5-B320-F9DF7ADECE5C.png" alt></p><p>å–ä¸ªåå­—å« CircleImageï¼Œå› ä¸ºæˆ‘ä»¬å°†è¦åœ¨è¿™é‡ŒæŠŠå¹¿å·å¡”è£å‰ªæˆä¸€ä¸ªåœ†ã€‚æ–°å»ºçš„ä»£ç å†…å®¹è·Ÿä¸Šä¸€ç« çœ‹åˆ°çš„ä¸€æ ·ï¼Œæˆ‘ä»¬æŠŠ <code>Text</code> æ”¹æˆ <code>Image</code>ï¼Œç„¶åæŠŠå›¾ç‰‡çš„åå­—ä¼ è¿›å»ï¼Œç›´æ¥å°±å¯ä»¥é€šè¿‡é¢„è§ˆåœ¨ç”»å¸ƒä¸Šçœ‹åˆ°æˆ‘ä»¬çš„å›¾ç‰‡äº†ï¼š<br><img src="/uploads/swiftui-serial-tutorial-2/03DBC394-DA28-4686-87CA-117FCAC32CC6.png" alt></p><p>æ¥ä¸‹æ¥æˆ‘ä»¬åœ¨ä»£ç é‡Œç»™å®ƒåŠ ä¸Šä¸€ä¸ªåœ†å½¢çš„è£å‰ªã€‚åŸæ¥çš„åšæ³•æœ‰å¾ˆå¤šäº†ï¼Œæœ€å¿«é€Ÿçš„åšæ³•åº”è¯¥æ˜¯æ“ä½œ <code>clipsToBounds</code> å’Œ <code>cornerRadius</code>ï¼Œç»™å›¾ç‰‡åŠ ä¸Šé•¿åº¦ç­‰äºä¸€åŠå®½é«˜çš„åœ†è§’ï¼Œè¿™è¿˜å¾—è¦æ±‚å›¾ç‰‡æ˜¯æ­£æ–¹å½¢çš„æ‰èƒ½è¾¾åˆ°æ»¡æ„çš„æ˜¾ç¤ºæ•ˆæœã€‚</p><p>è€Œåœ¨ SwiftUI é‡Œï¼Œè¿™å°±æ˜¯ä¸€å¥è¯çš„äº‹æƒ…ï¼š<br><img src="/uploads/swiftui-serial-tutorial-2/D1D63EE5-2169-40D0-ACAB-F68AE4EED5EB.png" alt></p><p><code>.clipShape()</code> ç»™å›¾ç‰‡åŠ äº†ä¸ªè£å‰ªçš„å½¢çŠ¶ï¼Œå…¶ä¸­ <code>Circle</code> ç±»å‹æ˜¯ä¸€ä¸ªç”¨æ¥å½“ä½œé®ç½©çš„å›¾å½¢ï¼Œä½ ä¹Ÿå¯ä»¥ç»™å®ƒåŠ ä¸Šå¡«å……è‰²æˆ–è€…æè¾¹æ¥å•ç‹¬ä½¿ç”¨ï¼Œç±»ä¼¼äºä»¥å¾€é€šè¿‡ <code>CALayer</code> å»å®ç°çš„æ•ˆæœã€‚</p><p>ä½†è¿™ä¹Ÿå¤ªå¤§äº†ï¼Œæˆ‘ä»¬çš„å±å¹•è£…ä¸ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å†åŠ ä¸¤è¡Œä»£ç ï¼ŒæŠŠå›¾ç‰‡ç¼©æ”¾åˆ°ä¸€ä¸ªåˆé€‚çš„å¤§å°ï¼š<br><img src="/uploads/swiftui-serial-tutorial-2/E0470CA5-E465-4D53-8E1A-555C180DED64.png" alt></p><blockquote><p>è®²é“ç†ï¼Œè¿™é‡Œè®¾ç½®çš„å®½é«˜åº”è¯¥æ˜¯ä¸€æ ·çš„ï¼Œæ¯•ç«Ÿæ˜¯ä¸ªåœ†å˜›â€¦ä½†æ˜¯æˆ‘æ‡’å¾—é‡æ–°æˆªå›¾äº†ï¼Œå„ä½ç«¥é‹è‡ªå·±è°ƒæ•´ä¸€ä¸‹æ•°å€¼å°±å¯ä»¥äº†</p></blockquote><p>ä¸ºäº†è®©å›¾ç‰‡æœ¬èº«åœ¨ä¸åŒèƒŒæ™¯ä¸‹éƒ½èƒ½å‡¸æ˜¾å‡ºæ¥ï¼Œæˆ‘ä»¬å†ç»™å®ƒåŠ ä¸ªæè¾¹ï¼Œè¿™è¦é€šè¿‡ <code>overlay()</code> æ–¹æ³•å»å®ç°ï¼›ä¹Ÿè®¸å†åŠ ä¸ªé˜´å½±å§ï¼Œç”¨åˆ°çš„æ˜¯ <code>shadow()</code> æ–¹æ³•ï¼›æœ€åå‡ºæ¥çš„æ•ˆæœæ˜¯è¿™æ ·çš„ï¼š<br><img src="/uploads/swiftui-serial-tutorial-2/1263812F-2159-4AD5-9B21-50A314CFA99C.png" alt></p><p>æ˜¯ä¸æ˜¯é†’ç›®å¤šå•¦ï¼Ÿ</p><blockquote><p>æ¯å½“åšå®Œä¸€ä¸ªæ–°è§†å›¾ï¼Œæˆ‘å°±æƒ³å¯¹æ¯”ä¸€ä¸‹ç”¨è€æ–¹æ³•å®ç°åŒæ ·çš„æ•ˆæœæœ‰ä»€ä¹ˆä¸åŒâ€¦</p></blockquote><h2 id="åœ¨-swiftui-é‡Œä½¿ç”¨-uikit">åœ¨ SwiftUI é‡Œä½¿ç”¨ UIKit</h2><p>ä¸çŸ¥é“å¤§å®¶å‘ç°äº†æ²¡æœ‰ï¼Œæˆ‘ä»¬åœ¨ SwiftUI é‡Œç”¨åˆ°çš„è§†å›¾å…¨éƒ¨éƒ½æ˜¯ <code>struct</code>ï¼Œè¿™æ„å‘³ç€å®ƒä»¬è·Ÿæˆ‘ä»¬åŸæœ¬ç†Ÿæ‚‰çš„ UIKit æ˜¯ä¸¤å¥—ä¸åŒçš„æœºåˆ¶ï¼Œé‚£éš¾é“ä»¥å‰å¼€å‘çš„è§†å›¾å°±å®Œå…¨ç”¨ä¸ä¸Šäº†å—ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯å¯ä»¥çš„ã€‚</p><p>è¦åœ¨ SwiftUI é‡Œä½¿ç”¨ UIView çš„å­ç±»ï¼Œåªéœ€è¦æŠŠå®ƒç”¨ä¸€ä¸ªéµå¾ª <code>UIViewRepresentable</code> åè®®çš„ SwiftUI è§†å›¾åŒ…è£¹èµ·æ¥å³å¯ã€‚</p><blockquote><p>è¿™é‡Œä¸¾çš„æ˜¯ UIKit çš„ä¾‹å­ï¼Œä½†åŒæ ·ä¹Ÿé€‚ç”¨äº AppKit å’Œ WatchKitã€‚</p></blockquote><p>æˆ‘ä»¬å†æ¥åˆ›å»ºä¸€ä¸ªæ–°çš„ SwiftUI View æ¥åšæˆ‘ä»¬çš„åœ°å›¾ç•Œé¢ï¼Œä½†è¿™ä¸€æ¬¡ï¼Œæˆ‘ä»¬è¦æ”¹ä¸€ä¸‹å†…å®¹è§†å›¾çš„åè®®ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> SwiftUI</span><br><span class="line"><span class="keyword">import</span> MapKit <span class="comment">// å¼•å…¥ MapKit</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">MapView</span> : <span class="title">UIViewRepresentable</span> </span>&#123; <span class="comment">// æŠŠè¿™é‡Œçš„åè®®æ”¹æ‰</span></span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">Text</span>(â€œ<span class="type">Hello</span> <span class="type">World!</span>â€)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç„¶åä½ ä¼šå‘ç° Xcode åœ¨ <code>UIViewRepresentable</code> è¿™é‡ŒæŠ¥é”™äº†ï¼Œå› ä¸ºè¿™ä¸ªåè®®ä¸‹æœ‰ä¸¤ä¸ªå¿…é¡»å®ç°çš„æ–¹æ³•ï¼š</p><ol><li><code>makeUIView(context:)</code> ç”¨æ¥åˆ›å»ºæˆ‘ä»¬çš„ <code>MKMapView</code></li><li><code>updateUIView(_:context:)</code> ç”¨æ¥è¿›è¡Œè§†å›¾çš„é…ç½®ï¼Œå¹¶å“åº”åç»­å¯èƒ½çš„å˜åŒ–</li></ol><p>é‚£ä¸‹é¢æˆ‘ä»¬å°±æ¥å®ç°ä¸€ä¸‹ã€‚å†åŠ æ–°ä»£ç ä¹‹å‰ï¼Œå¯ä»¥æŠŠå·²ç»ç”¨ä¸ä¸Šçš„ <code>body</code> éƒ¨åˆ†å…ˆåˆ æ‰äº†ã€‚</p><p>å¯¹äº <code>makeUIView(context:)</code>ï¼Œåªéœ€è¦å£°æ˜å®ƒè¿”å›çš„æ˜¯ <code>MKMapView</code> ç„¶åç›´æ¥é€šè¿‡æ„é€ æ–¹æ³•è¿”å›ä¸€ä¸ªç©ºå¯¹è±¡å°±å¯ä»¥äº†ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">makeUIView</span><span class="params">(context: UIViewRepresentableContext&lt;MapView&gt;)</span></span> -&gt; <span class="type">MKMapView</span> &#123;</span><br><span class="line">    <span class="type">MKMapView</span>(frame: .zero)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>updateUIView(_:context:)</code> è¦åšçš„äº‹æƒ…å°±æ¯”è¾ƒå¤šäº†ï¼Œæˆ‘ä»¬ä¸€æ­¥æ­¥è¯´ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">updateUIView</span><span class="params">(<span class="number">_</span> uiView: MKMapView, context: UIViewRepresentableContext&lt;MapView&gt;)</span></span> &#123;</span><br><span class="line"><span class="comment">// 1</span></span><br><span class="line">    <span class="keyword">let</span> coordinate = <span class="type">CLLocationCoordinate2D</span>(latitude: <span class="number">23.112223</span>, longitude: <span class="number">113.331084</span>)</span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line">    <span class="keyword">let</span> span = <span class="type">MKCoordinateSpan</span>(latitudeDelta: <span class="number">0.01</span>, longitudeDelta: <span class="number">0.01</span>)</span><br><span class="line"><span class="comment">// 3</span></span><br><span class="line">    <span class="keyword">let</span> region = <span class="type">MKCoordinateRegion</span>(center: coordinate, span: span)</span><br><span class="line">    uiView.setRegion(region, animated: <span class="literal">true</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>å…ˆæŠŠè¡¨ç¤ºå¹¿å·å¡”åæ ‡çš„å¯¹è±¡ç»™æ„é€ å‡ºæ¥ï¼ˆè¿™æ˜¯æˆ‘åœ¨ç½‘ä¸ŠæŸ¥çš„ï¼Œç­‰ä¼šé¢„è§ˆçš„æ—¶å€™çœ‹çœ‹å‡†ä¸å‡†ï¼‰</li><li>æ„é€ ä¸€ä¸ªç”¨æ¥æ ‡è¯†åœ°å›¾çš„ç¼©æ”¾ç­‰çº§çš„å¯¹è±¡ï¼Œæ•°å€¼è¶Šå°åœ°å›¾æ‹‰å¾—è¶Šè¿‘</li><li>æ„é€ åæ ‡åŒºåŸŸï¼Œå¹¶æŠŠè¿™ä¸ªåŒºåŸŸè®¾ç½®åˆ°æˆ‘ä»¬çš„åœ°å›¾è§†å›¾ä¸Š</li></ol><p>èµ¶ç´§é¢„è§ˆä¸€ä¸‹çœ‹çœ‹æ•ˆæœå§ï¼ä½ ä¼šå‘ç°ç”»å¸ƒä¸Šç©ºç™½ä¸€ç‰‡â€¦</p><p>é‚£æ˜¯å› ä¸ºé¢„è§ˆé»˜è®¤æ˜¯é™æ€æ¨¡å¼çš„ï¼Œå®ƒåªèƒ½å®Œæ•´æ¸²æŸ“ SwiftUI çš„è§†å›¾ã€‚å› ä¸ºæˆ‘ä»¬ç°åœ¨ç”¨åˆ°äº† UIView çš„å­ç±»ï¼Œæ‰€ä»¥è¦æŠŠé¢„è§ˆåˆ‡æ¢åˆ°å®æ—¶æ¨¡å¼ï¼ˆå³ä¸‹è§’çº¢æ¡†é‡Œçš„æŒ‰é’®ï¼‰ï¼š<br><img src="/uploads/swiftui-serial-tutorial-2/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A72019-06-16%E4%B8%8B%E5%8D%887.28.49.png" alt></p><p>emmmmâ€¦å¡”å‘¢ï¼Ÿè¿™å®šä½çœ‹èµ·æ¥ä¹Ÿä¸æ˜¯å¾ˆå‡†å•Šã€‚</p><h2 id="æŠŠä¸€åˆ‡éƒ½ç»„è£…èµ·æ¥å§">æŠŠä¸€åˆ‡éƒ½ç»„è£…èµ·æ¥å§ï¼</h2><p>å…ˆçœ‹çœ‹é¢„æœŸå®ç°çš„æ•ˆæœå›¾ï¼š<br><img src="/uploads/swiftui-serial-tutorial-2/973ba702-85db-4852-851f-86a94cfca002.png" alt></p><p>ç„¶åèŠ±ä¸€ç‚¹æ—¶é—´æ€è€ƒä¸€ä¸‹æ€ä¹ˆå¼„ï¼Œæˆ‘ä»¬è¿™ä¸¤ç¯‡æ–‡ç« çš„çŸ¥è¯†æ˜¯å®Œå…¨è¶³å¤Ÿäº†çš„ã€‚</p><p>å¥½å•¦ï¼å…¬å¸ƒç­”æ¡ˆï¼</p><p>æˆ‘ä»¬ä¼šåœ¨ä¸Šä¸€ç¯‡æ–‡ç« å®ç°çš„ <code>ContentView</code> é‡Œç›´æ¥è¿›è¡Œç»„è£…ï¼Œä¸‹é¢æ¥çœ‹çœ‹åˆ†è§£åŠ¨ä½œï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ContentView</span>: <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span> &#123; <span class="comment">// 1</span></span><br><span class="line">            <span class="type">MapView</span>() </span><br><span class="line">                .edgesIgnoringSafeArea(.top) <span class="comment">// 2.1</span></span><br><span class="line">                .frame(height: <span class="number">300</span>) <span class="comment">// 2.2</span></span><br><span class="line"></span><br><span class="line">            <span class="type">CircleImage</span>()</span><br><span class="line">                .offset(y: -<span class="number">100</span>)</span><br><span class="line">                .padding(.bottom, -<span class="number">100</span>) <span class="comment">// 3</span></span><br><span class="line"></span><br><span class="line">            <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">                <span class="type">Text</span>(â€œ<span class="type">Hello</span> <span class="type">SwiftUI</span>â€)</span><br><span class="line">                    .font(.title)</span><br><span class="line">                <span class="type">HStack</span>(alignment: .top) &#123;</span><br><span class="line">                    <span class="type">Text</span>(â€œ<span class="type">First</span> <span class="type">Description</span>â€)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                    <span class="type">Spacer</span>()</span><br><span class="line">                    <span class="type">Text</span>(â€œ<span class="type">Second</span> <span class="type">Description</span>â€)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            .padding()</span><br><span class="line"></span><br><span class="line">            <span class="type">Spacer</span>() <span class="comment">// 4</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>å…ˆç”¨ä¸€ä¸ª <code>VStack</code> æŠŠæ‰€æœ‰å†…å®¹åŒ…è£¹èµ·æ¥ï¼Œé»˜è®¤æƒ…å†µä¸‹ <code>VStack</code> çš„å†…å®¹å¸ƒå±€æ˜¯å±…ä¸­çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦åšä¿®æ”¹</li><li>é’ˆå¯¹ <code>MapView</code> æˆ‘ä»¬è¦åšä¸¤ä¸ªä¿®æ”¹<ol><li><code>edgesIgnoringSafeArea</code> å¯ä»¥è®©æˆ‘ä»¬çš„è§†å›¾æŠŠç³»ç»Ÿé¢„ç•™ç»™åˆ˜æµ·å’ŒçŠ¶æ€æ çš„åŒºåŸŸä¹Ÿç”¨æ‰ï¼Œè¿™æ ·çœ‹èµ·æ¥ä¼šæ›´è‡ªç„¶ä¸€ç‚¹</li><li>å¯¹äºåªè®¾ç½®äº† <code>height</code> çš„è§†å›¾ï¼Œå®ƒçš„å®½åº¦ä¼šé»˜è®¤å æ»¡æ‰€æœ‰çˆ¶è§†å›¾é‡Œçš„å¯ç”¨ç©ºé—´</li></ol></li><li>æˆ‘ä»¬çš„å›¾ç‰‡è§†å›¾æœ¬èº«å·²ç»å®ç°äº†æ‰€æœ‰æ•ˆæœäº†ï¼Œç°åœ¨åªéœ€è¦è°ƒæ•´ä¸€ä¸‹ä½ç½®å³å¯ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå› ä¸ºè¿™é‡Œæ˜¯é€šè¿‡ <code>offset</code> ç§»åŠ¨çš„ï¼Œæ‰€ä»¥ä¸ºäº†ä¿æŒä¸åº•éƒ¨æ–‡å­—çš„é—´è·ï¼Œç‰¹æ„åŠ ä¸Šäº†ä¸€ä¸ªè´Ÿçš„ <code>padding</code> æ¥æŠµæ¶ˆæ‰ä½ç§»å¯¼è‡´çš„å·®è·</li><li>åšå®Œå‰ä¸‰æ­¥çš„æ“ä½œåï¼Œè¿™ä¸ª <code>VStack</code> æ•´ä½“æ˜¯åœ¨ç«–ç›´æ–¹å‘ä¸Šå±…ä¸­çš„ï¼Œæ‰€ä»¥åŠ ä¸Šä¸€ä¸ª <code>Spacer</code> æŠŠæ•´ä½“æœ‰å†…å®¹çš„éƒ¨åˆ†é¡¶åˆ°æœ€ä¸Šé¢ï¼ˆå…¶å®ä¹Ÿå¯ä»¥é€šè¿‡ <code>HStack</code> çš„ <code>alignment</code>æ¥å®ç°ï¼Œä¸è¿‡é‚£æ ·ä»£ç å°±æ²¡æœ‰ç°åœ¨çš„ç®€å•ä¼˜é›…äº†ï¼‰</li></ol><p>æœ€ç»ˆæˆæœï¼š<br><img src="/uploads/swiftui-serial-tutorial-2/EF653793-4B81-42D7-9B53-00790EE31E8F.png" alt></p><blockquote><p>å¦‚æœä½ å‘ç°ç…§ç€å®ç°å‡ºæ¥ä¹‹åï¼Œä¸­é—´åœ†å½¢éƒ¨åˆ†ç‰¹åˆ«å¤§çš„è¯ï¼Œåˆ«æ‹…å¿ƒï¼Œä½ æ˜¯å¯¹çš„ï¼<br>å› ä¸ºæ–‡ç« å‰é¢çš„ <code>CircleImage</code> ç¡®å®æ˜¯ä¸ºäº†å±•ç¤ºè€Œç‰¹æ„è®¾ç½®å¾—æ¯”è¾ƒå¤§çš„ï¼Œæ‰€ä»¥è°ƒæ•´ä¸€ä¸‹é‡Œé¢çš„å®½é«˜å³å¯ã€‚</p></blockquote><h2 id="å°ç»“">å°ç»“</h2><p>åˆ°è¿™é‡Œå¤§å®¶åº”è¯¥å¯¹ SwiftUI çš„ä½¿ç”¨æ¯”è¾ƒä¸Šæ‰‹äº†ï¼Œä½†ç›®å‰ä¸ºæ­¢æ¶‰åŠåˆ°çš„ç»„ä»¶è¿˜æ¯”è¾ƒå°‘ï¼ŒSwiftUI å…‰æ˜¯å„ç§å¼ºå¤§çš„ç»„ä»¶å°±å·²ç»å¤Ÿç©å¾ˆä¹…äº†ã€‚ä¸è¿‡æˆ‘æ‰“ç®—åœ¨ç¬¬å››ç¯‡æ–‡ç« é‡Œå†é›†ä¸­è®²å„ç§æœ‰æ„æ€çš„ç»„ä»¶ä½¿ç”¨æ–¹å¼ï¼Œå› ä¸ºä¸‹ä¸€ç¯‡æ–‡ç« æˆ‘ä»¬è¦å…ˆè§£å†³æ•°æ®æ¥æºçš„é—®é¢˜ã€‚</p><p>æ—¢ç„¶æˆ‘ä»¬çš„è§†å›¾ç»„ä»¶å·²ç»æ˜¯é€šè¿‡å£°æ˜å¼çš„å†™æ³•æ¥æ„å»ºçš„äº†ï¼Œé‚£æˆ‘ä»¬çš„æ•°æ®æ˜¯ä¸æ˜¯ä¹Ÿè¯¥æ¢ä¸€ç§æ–¹å¼ç»‘å®šåˆ°è§†å›¾ä¸Šå‘¢ï¼Ÿåœ¨ JS ä¸Šæˆ‘ä»¬å¯ä»¥ç”¨ react-redux è¿™æ ·çš„æ•°æ®ç»‘å®šæ‰‹æ®µï¼Œé‚£ SwiftUI æ˜¯ä¸æ˜¯è¯¥æ­é… RxSwift æ¥ä½¿ç”¨äº†ï¼Ÿ</p><p>è¿™äº›é—®é¢˜éƒ½å°†åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« é‡Œä¸ºå¤§å®¶è§£ç­”ï¼</p><h2 id="å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥</h2><p><a href="https://developer.apple.com/tutorials/swiftui/creating-and-combining-views" target="_blank" rel="noopener">SwiftUI | Creating and Combining Views</a><br><a href="https://developer.apple.com/videos/play/wwdc2019/216/" target="_blank" rel="noopener">SwiftUI Essentials - WWDC 2019 - Videos - Apple Developer</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨&lt;a href=&quot;/2019/06/12/swiftui-serial-tutorial-1/&quot; title=&quot;ä¸Šä¸€ç¯‡æ–‡ç« &quot;&gt;ä¸Šä¸€ç¯‡æ–‡ç« &lt;/a&gt;ä¸­ï¼Œæˆ‘ä»¬äº†è§£äº† SwiftUI çš„ &lt;code&gt;Text&lt;/code&gt;  ç»„ä»¶ï¼Œå¹¶é€šè¿‡ &lt;code&gt;Stack&lt;/code&gt; ç³»åˆ—çš„ç»„ä»¶å¯¹å†…å®¹è¿›è¡Œäº†ä¸€äº›ç®€å•çš„å¸ƒå±€ã€‚åœ¨è¿™ç¯‡æ–‡ç« é‡Œï¼Œæˆ‘ä»¬ä¼šè®¤è¯†ä¸€ä¸ªå…¨æ–°çš„å›¾ç‰‡ç»„ä»¶ï¼Œå¹¶ä¸”ä¼šå°è¯•åˆ©ç”¨è¿™ä¸¤ç¯‡æ–‡ç« çš„çŸ¥è¯†ï¼Œç»“åˆ MapKit æ¡†æ¶ï¼Œæ¥å®ç°ä¸€ä¸ªç®€å•çš„åœ°ç‚¹è¯¦æƒ…ç•Œé¢ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="Swift" scheme="http://davidleee.com/tags/Swift/"/>
    
      <category term="SwiftUI" scheme="http://davidleee.com/tags/SwiftUI/"/>
    
      <category term="Image" scheme="http://davidleee.com/tags/Image/"/>
    
      <category term="UIView" scheme="http://davidleee.com/tags/UIView/"/>
    
      <category term="UIViewRepresentable" scheme="http://davidleee.com/tags/UIViewRepresentable/"/>
    
      <category term="MKMapView" scheme="http://davidleee.com/tags/MKMapView/"/>
    
      <category term="Spacer" scheme="http://davidleee.com/tags/Spacer/"/>
    
  </entry>
  
  <entry>
    <title>SwiftUI ç³»åˆ—æ•™ç¨‹ï¼ˆ1ï¼‰â€”â€” åˆè¯† SwiftUI</title>
    <link href="http://davidleee.com/2019/06/12/swiftui-serial-tutorial-1/"/>
    <id>http://davidleee.com/2019/06/12/swiftui-serial-tutorial-1/</id>
    <published>2019-06-12T01:07:19.000Z</published>
    <updated>2020-05-05T03:43:31.444Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>å¯èƒ½æ˜¯å…¨ç½‘æœ€æ—©çš„ SwiftUI ä¸­æ–‡æ•™ç¨‹ï¼Ÿ</p></blockquote><p>è¿™ç¯‡æ–‡ç« æ¥æºäºè‹¹æœå®˜æ–¹çš„æ•™ç¨‹ï¼Œç›¸å½“äºæ˜¯æˆ‘è‡ªå·±å­¦ä¹ è¿‡ç¨‹çš„ä¸€ä¸ªè®°å½•ã€‚è¿™ä¸ªç³»åˆ—æ•™ç¨‹ä¼šè·Ÿç€å®˜æ–¹æ•™ç¨‹æ„é€ ä¸€ä¸ªæ–°çš„é¡¹ç›®ï¼Œè¿˜ä¼šåŠ å…¥ä¸€äº› WWDC çš„ä¸œè¥¿ä½œä¸ºè¡¥å……ï¼Œå¯èƒ½å¶å°”ä¼šæœ‰ä¸€äº›è‡ªç”±å‘æŒ¥çš„éƒ¨åˆ†ã€‚ï¼ˆä¸è¿‡æˆ‘è¿™é‡Œæ˜¯åšä¸å‡ºå®˜æ–¹æ•™ç¨‹é‚£ç§é…·ç‚«çš„åŠ¨ç”»äº†â€¦ï¼‰</p><a id="more"></a><h2 id="å…¨æ–°çš„ç¼–ç ä½“éªŒ">å…¨æ–°çš„ç¼–ç ä½“éªŒï¼</h2><p>ç›®å‰ï¼ˆ2019.6.5ï¼‰è¦ä½“éªŒåˆ°è¿™ä¸ªæ–°ä¸œè¥¿ï¼Œéœ€è¦ç”¨åˆ° <strong>Xcode 11 beta</strong>ï¼Œè€Œå¦‚æœè¦ä½“éªŒæ–°çš„é¢„è§ˆæœºåˆ¶å’Œå¯¹ç”»å¸ƒä¸Šçš„é¢„è§ˆè¿›è¡Œæ“ä½œï¼Œè¿˜éœ€è¦æŠŠç³»ç»Ÿæ›´æ–°åˆ° <strong>macOS Catalina 10.15 beta</strong>ï¼Œ çœ‹æ¥è¿™ä¸ªç³»åˆ—çš„æ–°åŠŸèƒ½æä¾›äº†ç³»ç»Ÿå±‚é¢çš„æ”¯æŒã€‚</p><blockquote><p>è¯è¯´å›æ¥ï¼Œä¸‹äº† iPadOS ä¹‹åç”¨ iTunes æ­»æ´»å‡ä¸ä¸Šå»ï¼ŒæŠ¥é”™è¯´ macOS æœ‰è½¯ä»¶è¦æ›´æ–°ï¼Œä½†æ€»æ›´æ–°å¤±è´¥ï¼Œæœ€åä¸‹è½½ Xcode 11 beta è®©å®ƒè·‘å®Œ install components é‚£ä¸€æ­¥å°±å¯ä»¥æˆåŠŸå‡çº§ iPad äº†â€¦å‘Šè¯‰æˆ‘ä¸æ˜¯ä¸€ä¸ªäººâ€¦</p></blockquote><p>è®©æˆ‘ä»¬å…ˆç”¨æ–°é²œçƒ­è¾£çš„ Xcode 11 beta åˆ›å»ºä¸€ä¸ªé¡¹ç›®å§ï¼</p><p>å‰é¢çš„æ­¥éª¤èº«ä¸º iOS å¼€å‘çš„åŒå­¦ä»¬åº”è¯¥å¾ˆç†Ÿæ‚‰äº†ï¼Œè¿™é‡Œè¦åˆ›å»ºçš„æ˜¯ Xcode project -&gt; Single View Appï¼ˆplayground æˆ‘è¿˜æ²¡è¯•è¿‡ï¼Œä¹Ÿè®¸ä¹Ÿè¢«â€œå¼ºåŒ–â€è¿‡äº†ï¼Ÿï¼‰ï¼Œç„¶ååœ¨å–åå­—çš„é‚£ä¸€æ­¥ç¨ä½œåœç•™ï¼Œç§ç§æˆ‘åœ¨æ‰“å‹¾åŒºå‘ç°äº†ä»€ä¹ˆï¼š<strong>Use SwiftUI</strong>ï¼å½“ç„¶é€‰æ‹©é’©ä¸Šå®ƒï¼</p><p><img src="/uploads/swiftui-serial-tutorial-1/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A72019-06-10%E4%B8%8B%E5%8D%889.55.44.png" alt></p><p>å®Œäº‹ä¹‹åæˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°ç†Ÿæ‚‰åˆå¸¦ç‚¹é™Œç”Ÿçš„ç¼–è¾‘å™¨ç•Œé¢äº†ã€‚ç‚¹å¼€é»˜è®¤æä¾›ç»™æˆ‘ä»¬çš„ <em>ContentView.swift</em>ï¼Œå¯ä»¥çœ‹åˆ°é‡Œé¢å·²ç»å†™å¥½äº†ä¸¤ä¸ª <code>struct</code>ï¼š<br><img src="/uploads/swiftui-serial-tutorial-1/F31CF147-5F01-422B-8ECB-C9AEFC274150.png" alt></p><hr><p>å…ˆæ‰“ä¸ªå²”ï¼Œçœ‹çœ‹ç¼–è¾‘åŒºåŸŸå³è¾¹æ–°åŠ å…¥çš„ Minimap ç•Œé¢ï¼Œè¿™è™½ç„¶æ˜¯ä¸€ä¸ªåœ¨ä»£ç ç¼–è¾‘å™¨ä¸­æ¯”è¾ƒå¸¸è§çš„åŠŸèƒ½ï¼Œä½†è‹¹æœä¸€å‡ºæ‰‹ï¼Œè¿˜æ˜¯ç»™æ”¹è¿›äº†ä¸€ç•ªï¼š</p><ol><li>å½“é¼ æ ‡åœ¨ Minimap ç§»åŠ¨æ—¶ï¼Œä¼šåƒä¸Šå›¾é‚£æ ·é«˜äº®å¹¶åœ¨å·¦è¾¹æŠŠå¯¹åº”æ–¹æ³•æˆ–å˜é‡åå‡¸æ˜¾å‡ºæ¥ï¼Œæ­¤æ—¶ç‚¹å‡»ä»»æ„ä¸€å—é«˜äº®åŒºåŸŸéƒ½å¯ä»¥è·³è½¬åˆ°å¯¹åº”çš„ä»£ç ä½ç½®</li><li>é¼ æ ‡æ”¾åœ¨ Minimap ä¸Šæ—¶ï¼ŒæŒ‰ä½ Command é”®ï¼Œæ‰€æœ‰çš„æ–¹æ³•å’Œå˜é‡åéƒ½ä¼šå‡¸æ˜¾å‡ºæ¥ï¼ˆä¸Šå›¾å…¶å®æ˜¯æŒ‰ä¸‹äº† Command åçš„çŠ¶æ€ï¼‰ï¼Œé‡è¦çš„ä»£ç ç»“æ„ä¸€ç›®äº†ç„¶</li></ol><blockquote><p>è‹¹æœçš„æ¯æ¬¡å¤§æ›´æ–°ï¼Œç€é‡å®£ä¼ çš„ä¸»è¦å˜åŒ–ï¼Œåœ¨æˆ‘éƒ½å°è¯•ä¸€éä¹‹åå°±æ²¡ä»€ä¹ˆæ„Ÿè§‰äº†ï¼Œåè€Œæ˜¯è¿™äº›å°åœ°æ–¹ç‰¹åˆ«æ‰“åŠ¨æˆ‘</p></blockquote><hr><p>è¨€å½’æ­£ä¼ ï¼Œçœ‹å›ä»£ç ã€‚</p><p>è¿™ä¸¤ä¸ªæ˜¯ SwiftUI é»˜è®¤æä¾›çš„ç»“æ„ä½“ï¼Œå…¶ä¸­éµå¾ª <code>View</code> åè®®çš„é‚£ä¸ªå®šä¹‰äº†æˆ‘ä»¬çš„ç•Œé¢å†…å®¹å’Œå¸ƒå±€ï¼Œè€Œéµå¾ª <code>PreviewProvider</code> åè®®çš„é‚£ä¸ªåˆ™è´Ÿè´£å¤„ç†è¿™ä¸ªç•Œé¢çš„é¢„è§ˆã€‚</p><p>é‚£ä»€ä¹ˆæ˜¯é¢„è§ˆï¼Ÿæˆ‘ä»¬å¯ä»¥å…ˆæŠŠæ—è¾¹çš„æ‰€è°“é¢„è§ˆçª—å£è·‘èµ·æ¥ï¼Œç‚¹å‡»å³ä¸Šè§’çš„ <em>Resume</em>ï¼ˆè¿™ä¸ªç‰ˆæœ¬çš„ Xcode é»˜è®¤ä¼šæ˜¾ç¤ºä¸‹å›¾è¿™ä¸ªç•Œé¢ï¼Œæ²¡æœ‰çš„è¯ï¼Œä¹Ÿå¯ä»¥åœ¨ <em>Editor</em> é‡Œé¢æ‰“å¼€å®ƒï¼‰ï¼š<br><img src="/uploads/swiftui-serial-tutorial-1/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A72019-06-10%E4%B8%8B%E5%8D%8810.22.22.png" alt></p><p>è¿™æ—¶ï¼ŒXcode ä¼šæŠŠæˆ‘ä»¬çš„é¡¹ç›®è¿è¡Œèµ·æ¥ï¼Œå°±è·Ÿå¹³æ—¶ç‚¹ <em>Run</em> è·‘åˆ°æ¨¡æ‹Ÿå™¨ä¸Šä¸€æ ·ã€‚æœ‰æ‰€ä¸åŒçš„æ˜¯ï¼Œè¿™æ¬¡çš„æ¨¡æ‹Ÿå™¨ç›´æ¥æ˜¾ç¤ºæˆäº† Xcode çš„ä¸€ä¸ªå­ç•Œé¢ï¼Œæˆ‘ä»¬ç”šè‡³å¯ä»¥ç›´æ¥æ“ä½œè¿™ä¸ªæ¨¡æ‹Ÿå™¨é‡Œçš„è§†å›¾ï¼Œå°±åƒæ“ä½œ xib å’Œ storyboard ä¸€æ ·ï¼</p><p><img src="/uploads/swiftui-serial-tutorial-1/38B1BE43-FECA-471C-A845-FBFB8E5FA2C0.png" alt></p><blockquote><p>ä»”ç»†çœ‹ï¼Œç‚¹é€‰äº†ç•Œé¢ä¸Šçš„æ–‡æ¡ˆä¹‹åï¼Œå·¦ä¾§ç¼–è¾‘å™¨é‡Œç›¸åº”çš„è§†å›¾ä»£ç ä¹Ÿè¢«é«˜äº®äº†èµ·æ¥ï¼Œæ˜¯ä¸æ˜¯æœ‰ä¸€ç§æ ¹æ®æŒ‰é’®äº‹ä»¶æ‰¾ IBAction ä»£ç çš„æ„Ÿè§‰ï¼Ÿ</p></blockquote><p>å°è¯•ä¿®æ”¹ä¸€ä¸‹ä»£ç é‡Œ <code>Text</code> ä¸­çš„å†…å®¹ï¼Œä¼šå‘ç°æ¨¡æ‹Ÿå™¨é‡Œçš„æ˜¾ç¤ºä¹Ÿå®æ—¶æ›´æ–°äº†ï¼å¯¹è¿™ä¸ªæ›´åŠ å¼ºå¤§çš„æ¨¡æ‹Ÿå™¨ï¼Œè‹¹æœç»™å®ƒèµ·äº†ä¸ªåå­—å« <strong>ç”»å¸ƒï¼ˆCanvasï¼‰</strong>ã€‚</p><h2 id="è‡ªå®šä¹‰æ–‡æœ¬è§†å›¾">è‡ªå®šä¹‰æ–‡æœ¬è§†å›¾</h2><p>é‚£æ—¢ç„¶ <strong>ç”»å¸ƒ</strong> æœ‰ç€è·Ÿ Storyboard ç›¸ä¼¼çš„ä½“éªŒï¼Œé‚£æ˜¯ä¸æ˜¯æ„å‘³ç€æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥æ”¹åŠ¨ç•Œé¢ä¸Šçš„å…ƒç´ ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œæ‰€æœ‰åŠŸèƒ½éƒ½éšè—åœ¨ Command + å·¦é”®ç‚¹å‡»é‡Œï¼š<br><img src="/uploads/swiftui-serial-tutorial-1/AA6AA015-7832-46DD-83E7-063BC1631D83.png" alt></p><p>ç‚¹å‡»åä¼šå‡ºç°ä¸€ä¸ªå†…å®¹ä¸°å¯Œçš„å¼¹å‡ºæ¡†ï¼Œè¿™äº›æ“ä½œä¼šæ ¹æ®ç‚¹å‡»çš„è§†å›¾ä¸åŒè€Œä¸åŒã€‚</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ <em>Inspectâ€¦</em> æ¥ä¿®æ”¹è§†å›¾çš„ä¸€äº›åŸºæœ¬å…ƒç´ ï¼š<br><img src="/uploads/swiftui-serial-tutorial-1/D0D9CEBC-7A12-4479-9541-34C80D177817.png" alt></p><blockquote><p>å›¾ä¸Šåº”è¯¥èƒ½çœ‹å‡ºæ¥ï¼Œè¿™ä¸ªå¼¹å‡ºæ¡†æ˜¯å¯ä»¥æ»šåŠ¨çš„ï¼Œå®ƒå·²ç»å¯ä»¥å–ä»£åŸæ¥æˆ‘ä»¬å¸¸ç”¨çš„ Attributes Inspectorã€‚å®é™…ä¸Šï¼Œå¦‚æœä½ åœ¨è¿™ä¸ªæ—¶å€™ç‚¹å¼€å³ä¾§è¾¹æ ï¼Œä¼šå‘ç° Attributes Inspector çš„å†…å®¹è·Ÿè¿™é‡Œæ˜¯å®Œå…¨ä¸€è‡´çš„</p></blockquote><p>æˆ‘ä»¬æ¥æŠŠå®ƒçš„å­—ä½“æ”¹ä¸º <em>Large Title</em>ï¼Œå¯ä»¥çœ‹åˆ°ä»£ç éƒ¨åˆ†ä¹Ÿè·Ÿç€ç•Œé¢ä¸€èµ·æ”¹å˜äº†ï¼š<br><img src="/uploads/swiftui-serial-tutorial-1/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A72019-06-10%E4%B8%8B%E5%8D%8810.38.09.png" alt></p><p>æŒ‰ç…§è¿™ä¸ªè§„å¾‹ï¼Œæˆ‘ä»¬é€šè¿‡æ‰‹å†™ä»£ç æ¥æ”¹ä¸ªå­—ä½“é¢œè‰²è¯•è¯•ï¼š<br><img src="/uploads/swiftui-serial-tutorial-1/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A72019-06-10%E4%B8%8B%E5%8D%8810.40.22.png" alt></p><p>è¿™ç§é“¾å¼è°ƒç”¨çš„è¯­æ³•æ˜¯ä¸æ˜¯è·Ÿç”¨ OC å®ç°çš„ AutoLayout å¼€æºåº“ <a href="https://github.com/SnapKit/Masonry" target="_blank" rel="noopener">Masonry</a> å¾ˆåƒå‘¢ï¼Ÿè‹¹æœæŠŠè¿™äº›æ–¹æ³•å«åš <em>ä¿®é¥°å™¨(modifiers)</em>ï¼Œå®ƒä»¬ä¼šåœ¨æ—§è§†å›¾çš„åŸºç¡€ä¸Šæ„é€ ä¸€ä¸ªæ–°è§†å›¾è¿”å›å‡ºæ¥ï¼Œè¿™ä½¿å¾—ä¸Šè¿°çš„é“¾å¼è°ƒç”¨æˆä¸ºå¯èƒ½ã€‚</p><blockquote><p>å¦‚æœæˆ‘ä»¬å†ä»åˆšæ‰çš„ <em>Inspectâ€¦</em> é‡ŒæŠŠå­—ä½“é¢œè‰²æ”¹ä¸º <em>inherited</em>ï¼Œå°±ä¼šå‘ç° Xcode æŠŠæˆ‘ä»¬åˆšåŠ ä¸Šçš„ <code>.color(.red)</code> åˆç»™åˆ æ‰äº†ï¼Œè¿™æ³¢æ“ä½œè®©å†™ä»£ç æœ‰æ„æ€äº†ä¸å°‘å•Šã€‚</p></blockquote><h2 id="æŠŠè§†å›¾éƒ½å èµ·æ¥å§">æŠŠè§†å›¾éƒ½å èµ·æ¥å§</h2><p>åœ¨å‰é¢çš„å†…å®¹é‡Œï¼Œæˆ‘ä»¬é€šè¿‡ SwiftUI æ¥æè¿°äº†æˆ‘ä»¬æƒ³è¦çš„è§†å›¾æ ·å¼ï¼Œä½†è¿™åªæ˜¯å•ä¸€çš„è§†å›¾ã€‚å½“è§†å›¾å¤šèµ·æ¥çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <em>stacks</em> æŠŠè§†å›¾åœ¨ç«–ç›´æ–¹å‘ã€æ°´å¹³æ–¹å‘æˆ–ä»å‰å¾€åç»„åˆèµ·æ¥ã€‚</p><p>æ³¨æ„åŠ›ç»§ç»­å›åˆ°æˆ‘ä»¬çš„æ–°æœ‹å‹ç”»å¸ƒä¸Šï¼Œè¿™æ¬¡æˆ‘ä»¬åŠ å¿«ä¸€ç‚¹é€Ÿåº¦ï¼Œå…ˆå¯¹åˆšåˆšçš„æ–‡æœ¬è¿›è¡Œ <em>Embed in VStack</em> çš„æ“ä½œï¼š<br><img src="/uploads/swiftui-serial-tutorial-1/32BB01AF-9406-41A2-8CA6-61F10F511D3A.png" alt></p><p>ç„¶åé€šè¿‡ Command + shift + L è°ƒå‡ºè§†å›¾åº“ç•Œé¢ï¼š<br><img src="/uploads/swiftui-serial-tutorial-1/73CBCF80-9712-48AA-9049-AD8641FC0269.png" alt></p><p>ä»é‡Œé¢æ‹–ä¸€ä¸ª <code>Text</code> åˆ°ç¼–è¾‘å™¨é‡Œï¼ˆå¯¹ï¼Œæ²¡é”™ï¼Œå°±æ˜¯ç¼–è¾‘å™¨ï¼Œå®ƒä¼šè‡ªåŠ¨å˜æˆä»£ç ï¼‰ï¼Œæ”¾åˆ°æˆ‘ä»¬ä¹‹å‰æ“ä½œçš„ <code>Text</code> ä¹‹ä¸‹ã€‚ç°åœ¨æˆ‘ä»¬çš„ä»£ç åº”è¯¥å˜æˆè¿™ä¸ªæ ·å­äº†ï¼š<br><img src="/uploads/swiftui-serial-tutorial-1/54973458-B739-467A-A6E9-B28081FEC640.png" alt></p><blockquote><p>ä»è§†å›¾åº“æ‹–ç»„ä»¶å‡ºæ¥è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬æœ‰ä¸¤ç§é€‰æ‹©ï¼šä¸€ç§æ˜¯æ‹–åˆ°ä»£ç é‡Œï¼Œå¦ä¸€ç§æ˜¯æ‹–åˆ° Canvas ä¸Šã€‚å¤§å®¶å¯ä»¥å°è¯•ä¸€ä¸‹æ‹–åˆ°ç•Œé¢ä¸Šä¼šæœ‰ä»€ä¹ˆæ ·çš„æ•ˆæœã€‚</p></blockquote><p>ç¨åæˆ‘ä»¬å†å›è¿‡å¤´æ¥çœ‹è¿™ä¸ª <code>VStack</code> æ˜¯ä»€ä¹ˆã€‚ç°åœ¨è®©æˆ‘ä»¬ç»§ç»­å¿«è¿›ï¼ŒåŠ å…¥ä¸¤ä¸ªæ²¡è§è¿‡çš„æ–°ç»„ä»¶ <code>HStack</code> å’Œ <code>Spacer</code>ï¼Œé€šè¿‡ç»™ <code>VStack</code> åŠ ä¸Šå‚æ•°æ¥è¿›è¡Œå¸ƒå±€ï¼Œè¿˜è¦å†é€šè¿‡ä¿®é¥°å™¨ç¾åŒ–ä¸€ä¸‹ç•Œé¢ï¼Œæœ€å <code>ContentView</code> çš„å†…å®¹åº”è¯¥æ˜¯è¿™ä¸ªæ ·å­çš„ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ContentView</span> : <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> body: some <span class="type">View</span> &#123;</span><br><span class="line">        <span class="type">VStack</span>(alignment: .leading) &#123;</span><br><span class="line">            <span class="type">Text</span>(â€œ<span class="type">Hello</span> <span class="type">SwiftUI</span>â€)</span><br><span class="line">                .font(.largeTitle)</span><br><span class="line">                <span class="type">HStack</span> &#123;</span><br><span class="line">                    <span class="type">Text</span>(â€œ<span class="type">First</span> <span class="type">Description</span>â€)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                    <span class="type">Spacer</span>()</span><br><span class="line">                    <span class="type">Text</span>(â€œ<span class="type">Second</span> <span class="type">Description</span>â€)</span><br><span class="line">                        .font(.subheadline)</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        .padding()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç›¸åº”çš„ï¼Œæˆ‘ä»¬çš„ç•Œé¢ä¹Ÿæˆäº†è¿™æ ·ï¼š<br><img src="/uploads/swiftui-serial-tutorial-1/33A162A9-B3E2-4938-80DD-A7B752AC2098.png" alt></p><h2 id="å¹•åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ">å¹•åå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ</h2><p>åˆšæ‰çš„ä»£ç é‡Œï¼Œèµ·åˆ°å®¹å™¨ä½œç”¨çš„æ˜¯ <code>VStack</code> å’Œ <code>HStack</code>ï¼Œé¡¾åæ€ä¹‰ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ç«–ç›´æ–¹å‘ä¸Šå’Œæ°´å¹³æ–¹å‘ä¸Šçš„å±‚å è§†å›¾ï¼ˆVertical &amp; Horizontalï¼‰ï¼Œç”¨æ³•è·Ÿæˆ‘ä»¬æ—©å°±è®¤è¯†çš„ <code>StackView</code> ç›¸åŒã€‚</p><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæœ‰è¿‡å‰ç«¯å¼€å‘ç»éªŒçš„åŒå­¦ä»¬åº”è¯¥èƒ½å‘ç°ï¼Œè¿™ä¸å°±æ˜¯ JSX çš„è¯­æ³•å—ï¼Ÿ</p><p>æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨å®ç°ä¸€ä¸ªæ–°ç•Œé¢çš„æ—¶å€™ï¼Œé€šå¸¸åŒ…å«ç€â€œç”¨åŸºæœ¬ç»„ä»¶å°±èƒ½å®ç°â€çš„å¸¸è§„éƒ¨åˆ†å’Œâ€œè¦æŠŠå¥‡æŠ€æ·«å·§å‘æŒ¥åˆ°æè‡´â€çš„å‡ºå½©éƒ¨åˆ†ã€‚SwiftUI çš„å‡ºç°å°±æ˜¯ä¸ºäº†ç®€åŒ–å¸¸è§„ UI çš„å¼€å‘è¿‡ç¨‹ï¼Œè®©å¼€å‘è€…èƒ½å¤ŸæŠŠç²¾åŠ›éƒ½æ”¾åœ¨æ¿€åŠ¨äººå¿ƒçš„éƒ¨åˆ†ã€‚</p><blockquote><p>â€”â€” æ‘˜è‡ª WWDC</p></blockquote><p>ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®çš„ï¼Œä¸€ä¸ªé¦–è¦çš„æ”¹å˜å°±æ˜¯ï¼š<strong>æŠŠå‘½ä»¤å¼çš„è§†å›¾é€»è¾‘è½¬å˜ä¸ºå£°æ˜å¼çš„</strong>ã€‚è¿™æ ·åšçš„å¥½å¤„åœ¨äºï¼š</p><ol><li>æé«˜äº†ç»„ä»¶çš„å¤ç”¨æ€§</li><li>ä»£ç æ›´æ¸…æ™°æ˜“æ‡‚ï¼Œåœ¨ç¼–å†™çš„è¿‡ç¨‹ä¸­ä¹Ÿæ›´ç¬¦åˆç›´è§‰</li><li>éšè—äº†èƒŒåå¤æ‚çš„éƒ¨åˆ†ï¼Œè®© SwiftUI å¸®æˆ‘ä»¬æ–™ç†å¥½ä¸€åˆ‡</li></ol><p>è¿™æ ·è½¬å˜ä¹‹åï¼Œæ•´ä¸ªè§†å›¾å±‚çº§çš„ä»£ç çœ‹èµ·æ¥å°±æ¸…æ™°äº†è®¸å¤šï¼ˆå¯¹æ¯”ä¸€ä¸‹ç”¨å•çº¯çš„ Swift æ¥å®ç°ä¼šæœ‰å¤šå°‘ä»£ç ï¼‰ï¼Œç„¶è€Œè¿™ç§è½¬å˜çš„èƒŒåå…¶å®éƒ½æ˜¯æˆ‘ä»¬ç†Ÿæ‚‰çš„ Swift è¯­æ³•ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œ<code>VStack</code> æœ¬èº«å°±æ˜¯ä¸€ä¸ª <code>View</code>ï¼Œå®ƒçš„å®ç°æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">struct</span> <span class="title">VStack</span>&lt;<span class="title">Content</span>: <span class="title">View</span>&gt; : <span class="title">View</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">init</span>(</span><br><span class="line">        alignment: <span class="type">HorizontalAlignment</span> = .center,</span><br><span class="line">        spacing: <span class="type">Length?</span> = <span class="literal">nil</span>,</span><br><span class="line">        @<span class="type">ViewBuilder</span> content: () -&gt; <span class="type">Content</span></span><br><span class="line">    )</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ<code>alignment</code> å’Œ <code>spacing</code> æ˜¯ä¸¤ä¸ªå¸ƒå±€ç”¨çš„å±æ€§ï¼Œæˆ‘ä»¬åœ¨ä¹‹å‰çš„ä¾‹å­é‡Œå°±è®¾ç½®äº† <code>VStack(alignment: .leading)</code>ï¼Œè¿™å¯ä»¥è®©å†…éƒ¨çš„å…ƒç´ å·¦å¯¹é½ï¼›è€Œ <code>content</code> å±æ€§åˆ™æ˜¯ä¸€ä¸ªé—­åŒ…ï¼Œå®ƒå°†è¿”å›å¦å¤–ä¸€ä¸ªè§†å›¾ï¼Œé‡Œé¢åŒ…å«äº†æ‰€æœ‰è¦æ˜¾ç¤ºåœ¨ <code>VStack</code> é‡Œçš„å­è§†å›¾ã€‚</p><p><code>VStack</code> å’Œ <code>HStack</code> åœ¨ SwiftUI é‡Œè¢«ç”¨åˆ°æ—¶å€™ï¼Œå…¶å®å°±æ˜¯è°ƒç”¨äº†å®ƒçš„æ„é€ æ–¹æ³•ï¼Œå› ä¸ºå‰ä¸¤ä¸ªå‚æ•°è¦ä¹ˆæ˜¯æœ‰é»˜è®¤å€¼çš„ï¼Œè¦ä¹ˆæ˜¯å¯é€‰çš„ï¼Œæ‰€ä»¥åªéœ€è¦å…³æ³¨æœ€åä¸€ä¸ªé—­åŒ…å‚æ•°ï¼›è€Œè¿™ä¸ªé—­åŒ…å‚æ•°ä½œä¸ºå‚æ•°åˆ—è¡¨é‡Œçš„æœ€åä¸€å‘˜ï¼Œå¯ä»¥å†™ä½œç»“å°¾é—­åŒ…çš„æ ·å­ï¼Œäºæ˜¯å°±æœ‰äº†æˆ‘ä»¬ä¸Šé¢ä¾‹å­ä¸­çš„å†™æ³•ã€‚</p><p>å‰©ä¸‹çš„ <code>Spacer()</code> å’Œ <code>.padding()</code> å°±åªä¸è¿‡æ˜¯ SwiftUI æä¾›ç»™æˆ‘ä»¬çš„åˆä¸€ä¸ªå¸¸è§„ç»„ä»¶å’Œä¿®é¥°å™¨è€Œå·²äº†ã€‚</p><h2 id="å°ç»“">å°ç»“</h2><p>å†™åˆ°è¿™é‡Œï¼Œä»…ä»…æ¶µç›–äº†å®˜æ–¹æ•™ç¨‹ç¬¬ä¸€ç« é‡Œçš„å‰3éƒ¨åˆ†ï¼Œå¤–åŠ ä¸€ç‚¹æ¥è‡ª WWDC è§†é¢‘é‡Œçš„å†…å®¹ã€‚æˆ‘è¿˜ä¼šç»§ç»­è¡¥å……ï¼ŒåŠªåŠ›æŠŠæ•´ä¸ªæ•™ç¨‹éƒ½è¦†ç›–æ‰ã€‚</p><p>ä¸è¿‡è¿™å°±è¶³ä»¥è®©æˆ‘ä»¬çœ‹åˆ°å®ƒçš„å¥½ç©ä¹‹å¤„äº†ï¼Œè‡³å°‘å†™äº†ä¸€æ®µæ—¶é—´ React Native çš„æˆ‘ï¼Œçœ‹åˆ°è¿™ä¼¼æ›¾ç›¸è¯†çš„è¯­æ³•ï¼Œç€å®æ„Ÿè§‰æ¬£å–œã€‚è‹¹æœåœ¨ä¸ºå¼€å‘è€…æ‰“é€ å·¥å…·ä¸Šä¸‹çš„åŠŸå¤«ï¼Œææ€•åœ¨å†å²æ‰€æœ‰ç§‘æŠ€å‹ä¼ä¸šä¸Šä¹Ÿæ˜¯æ•°ä¸€æ•°äºŒçš„äº†ã€‚</p><h2 id="å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥</h2><p><a href="https://developer.apple.com/tutorials/swiftui/creating-and-combining-views" target="_blank" rel="noopener">SwiftUI | Creating and Combining Views</a><br><a href="https://developer.apple.com/videos/play/wwdc2019/216/" target="_blank" rel="noopener">SwiftUI Essentials - WWDC 2019 - Videos - Apple Developer</a></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;å¯èƒ½æ˜¯å…¨ç½‘æœ€æ—©çš„ SwiftUI ä¸­æ–‡æ•™ç¨‹ï¼Ÿ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;è¿™ç¯‡æ–‡ç« æ¥æºäºè‹¹æœå®˜æ–¹çš„æ•™ç¨‹ï¼Œç›¸å½“äºæ˜¯æˆ‘è‡ªå·±å­¦ä¹ è¿‡ç¨‹çš„ä¸€ä¸ªè®°å½•ã€‚è¿™ä¸ªç³»åˆ—æ•™ç¨‹ä¼šè·Ÿç€å®˜æ–¹æ•™ç¨‹æ„é€ ä¸€ä¸ªæ–°çš„é¡¹ç›®ï¼Œè¿˜ä¼šåŠ å…¥ä¸€äº› WWDC çš„ä¸œè¥¿ä½œä¸ºè¡¥å……ï¼Œå¯èƒ½å¶å°”ä¼šæœ‰ä¸€äº›è‡ªç”±å‘æŒ¥çš„éƒ¨åˆ†ã€‚ï¼ˆä¸è¿‡æˆ‘è¿™é‡Œæ˜¯åšä¸å‡ºå®˜æ–¹æ•™ç¨‹é‚£ç§é…·ç‚«çš„åŠ¨ç”»äº†â€¦ï¼‰&lt;/p&gt;
    
    </summary>
    
    
      <category term="Swift" scheme="http://davidleee.com/tags/Swift/"/>
    
      <category term="SwiftUI" scheme="http://davidleee.com/tags/SwiftUI/"/>
    
      <category term="Catalina" scheme="http://davidleee.com/tags/Catalina/"/>
    
      <category term="VStack" scheme="http://davidleee.com/tags/VStack/"/>
    
      <category term="HStack" scheme="http://davidleee.com/tags/HStack/"/>
    
  </entry>
  
  <entry>
    <title>NSTextField(1) â€”â€” macOS è¾“å…¥æ¡†æ¦‚è§ˆ</title>
    <link href="http://davidleee.com/2019/04/12/nstextfield-for-macos/"/>
    <id>http://davidleee.com/2019/04/12/nstextfield-for-macos/</id>
    <published>2019-04-12T07:15:04.000Z</published>
    <updated>2020-05-05T03:43:31.444Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>è¿™æ˜¯ macOS å¼€å‘ç³»åˆ—çš„ç¬¬å››ç¯‡æ–‡ç«  â€”â€” NSTextFieldã€‚<br>æœ€å¸¸è§çš„æ§ä»¶ä¹‹ä¸€ï¼Œå´ä¸ä¸€å®šæ˜¯ä½ æœ€ç†Ÿæ‚‰çš„æ§ä»¶ä¹‹ä¸€ã€‚</p></blockquote><a id="more"></a><p>å°†è¿‘åŠå¹´æ²¡å‘æ–‡äº†ï¼Œè¿™æ®µæ—¶é—´è¿‡å¾—çœŸæ˜¯å……å®å¾—è¿‡åˆ†ï¼Œä»¥è‡³äºå®Œå…¨æ²¡æœ‰æ—¶é—´å¥½å¥½æ•´ç†ä¸€ä¸‹æ‰‹è¾¹å¯ä»¥å†™çš„å†…å®¹ã€‚æœ€è¿‘å¥½ä¸å®¹æ˜“æœ‰ç‚¹æ—¶é—´å¯ä»¥æŠŠå­˜è´§æ•´ç†æ•´ç†ï¼Œå‘ç°å½“æ—¶å†™çš„å¥½å¤šä¸œè¥¿éƒ½å·²ç»è¿‡æ—¶äº†ï¼èµ¶ç´§æ”¶æ‹¾å¹²å‡€å…ˆå‘ä¸€ç¯‡ä¸Šæ¥ï¼Œä¸ç„¶æŒ‡ä¸å®šå“ªå¤©è¿æ•´ä¸ªä¸»é¢˜éƒ½æ²¡ç”¨äº†â€¦</p><p>å’±ä»¬ç›´æ¥è¿›å…¥æ­£é¢˜ï¼</p><h2 id="nstextfield">NSTextField</h2><p>ä¸€ä¸ªå®Œæ•´çš„ TextField æ˜¯ç”±ä¸¤ä¸ªç±»ç»„æˆçš„ï¼š<a href="https://developer.apple.com/documentation/appkit/nstextfieldcell" target="_blank" rel="noopener">NSTextFieldCell</a>ï¼Œå¹²äº†ç»å¤§å¤šæ•°è„æ´»ç´¯æ´»çš„ä¸€ä¸ªç±»ï¼Œå’Œ <a href="https://developer.apple.com/documentation/appkit/nstextfield" target="_blank" rel="noopener">NSTextField</a>ï¼Œä½œä¸º NSTextFieldCell çš„å®¹å™¨è€Œå­˜åœ¨ã€‚æ‰€æœ‰ NSTextFieldCell é‡Œçš„æ–¹æ³•åœ¨ NSTextField é‡Œé¢éƒ½æœ‰å¯¹åº”çš„å­˜åœ¨ï¼ˆæœ‰ç‚¹åƒ UIView å¯¹ Layer çš„å°è£…ï¼‰ã€‚</p><p>å¯¹äºç»å¤§å¤šæ•°æƒ…å†µæ¥è¯´ï¼Œæˆ‘ä»¬ç›´æ¥ç”¨ NSTextField å°±è¶³å¤Ÿäº†ï¼ˆé‚£è¿™ç¯‡æ–‡ç« ä¸ä¹…æ²¡ä»€ä¹ˆä½œç”¨äº†å—ï¼Ÿï¼ï¼‰ã€‚å¦‚æœä½ æƒ³è¦å¯¹è‡ªå·±çš„è¾“å…¥æ¡†æœ‰æ›´å¤šçš„æŒæ§æƒï¼Œé‚£å¯èƒ½è¿˜éœ€è¦äº†è§£ä¸€ä¸ªå« <a href="https://developer.apple.com/documentation/appkit/nscontrol" target="_blank" rel="noopener">NSControl</a> çš„å®¶ä¼™ã€‚</p><h2 id="nscontrol">NSControl</h2><p>æ­£å¦‚ iOS é‡Œçš„ <a href="https://developer.apple.com/documentation/uikit/uicontrol" target="_blank" rel="noopener">UIControl</a>ï¼Œ<a href="https://developer.apple.com/documentation/appkit/nscontrol" target="_blank" rel="noopener">NSControl</a> æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå¿…é¡»é€šè¿‡å­ç±»ç»§æ‰¿æ¥ä½¿ç”¨ã€‚ä½†æ˜¯è·Ÿæ¯”è¾ƒçº¯ç²¹çš„ UIControl ä¸åŒï¼ŒNSControl é™¤äº†æ”¯æŒ Target/Action æœºåˆ¶å’Œä¸€äº›å¸¸è§çš„å±æ€§è®¾ç½®ä¹‹å¤–ï¼Œè¿˜åŠ ä¸Šäº†æ”¯æŒæ–‡å­—ç¼–è¾‘çš„ä¸€ç³»åˆ—ä»£ç†æ–¹æ³•ã€‚</p><p>ä¸¾ä¸ªä¸¤ç»„æœ€å¸¸ç”¨çš„ä¾‹å­ï¼š</p><h3 id="controltextdidxxx">controlTextDidxxx(_:)</h3><p>è¿™ä¹ˆå¤šæ–¹æ³•é‡Œé¢ï¼Œæ¯”è¾ƒå¥½ç”¨çš„å½“å± <code>did</code> ç³»åˆ—æ–¹æ³•äº†ï¼š</p><ol><li><a href="https://developer.apple.com/documentation/objectivec/nsobject/1428934-controltextdidbeginediting?language=objc" target="_blank" rel="noopener"><code>controlTextDidBeginEditing(_:)</code></a></li><li><a href="https://developer.apple.com/documentation/objectivec/nsobject/1428847-controltextdidendediting?language=objc" target="_blank" rel="noopener"><code>controlTextDidEndEditing(_:)</code></a></li><li><a href="https://developer.apple.com/documentation/objectivec/nsobject/1428982-controltextdidchange?language=objc" target="_blank" rel="noopener"><code>controlTextDidChange(_:)</code></a></li></ol><p>è¿™ä¸‰ä¸ªæ–¹æ³•è™½ç„¶å·²ç»åœ¨å®˜æ–¹æ–‡æ¡£é‡Œè¢«æ ‡è®°ä¸º â€œmacOS 10.0-10.14 Deprecatedâ€äº†ï¼Œ<s>ä½†å®ƒä»¬ä»ç„¶åœ¨å‹¤å‹¤æ³æ³åœ°å·¥ä½œç€</s>ã€‚<s>é‰´äº macOS çš„ 10.14 è¿˜æ²¡å‡ºæ¥</s>ï¼ˆ2018.8ï¼‰ï¼Œ<s>æˆ‘ä»¬ä½†ç”¨æ— å¦¨</s>ã€‚2019å¹´4æœˆå†çœ‹ï¼Œç³»ç»Ÿç‰ˆæœ¬å·²ç»åˆ°10.14ä»¥ä¸Šäº†ï¼Œæ˜¯æ—¶å€™è€ƒè™‘æ­£å¼æ¢æˆä¸‹é¢çš„æ–¹æ³•äº†ã€‚</p><blockquote><p>ä¸Šé¢ä¸‰ä¸ªæ–¹æ³•çš„é“¾æ¥éƒ½æ˜¯ Objective-C ç‰ˆæœ¬çš„ï¼Œè¢« Deprecated çš„ä¹Ÿæ˜¯è¿™ä¸ªç‰ˆæœ¬çš„æ–¹æ³•ã€‚åœ¨ Swift ç‰ˆçš„æ–‡æ¡£é‡Œï¼Œåœ¨ NSControlTextEditingDelegate é‡Œå·²ç»åŠ å…¥è¿™ä¸‰ä¸ªæ–¹æ³•<s>çš„ Beta ç‰ˆ</s>äº†ï¼ˆ2019.4 Beta æ ‡è¯†å·²ç»å»æ‰äº†ï¼‰ï¼š<a href="https://developer.apple.com/documentation/appkit/nscontroltexteditingdelegate/3005176-controltextdidbeginediting" target="_blank" rel="noopener">controlTextDidBeginEditing(<em>:)</em></a>ã€ <a href="https://developer.apple.com/documentation/appkit/nscontroltexteditingdelegate/3005177-controltextdidchange" target="_blank" rel="noopener">controlTextDidChange(:)</a>ã€ <a href="https://developer.apple.com/documentation/appkit/nscontroltexteditingdelegate/3005178-controltextdidendediting" target="_blank" rel="noopener">controlTextDidEndEditing(_:)</a>ã€‚æ–¹æ³•ç­¾åçœ‹èµ·æ¥æ˜¯ä¸€æ ·çš„ï¼Œä¼°è®¡æ–°æ–¹æ³•çš„æ­£å¼ç‰ˆå‡ºæ¥ä¹‹åä¹Ÿå¯ä»¥æ— ç¼è¿ç§»ã€‚</p></blockquote><p>é¡¾åæ€ä¹‰ï¼Œå®ƒä»¬ä»£è¡¨äº†è¾“å…¥è¿‡ç¨‹ä¸­çš„ä¸‰ä¸ªçŠ¶æ€ï¼Œä¸è¿‡æœ‰ä¸€ç‚¹è¦æ³¨æ„çš„æ˜¯ï¼šæ¯æ¬¡å‡ºç° didEnd å¹¶ä¸ä¸€å®šä¼šæœ‰ä¸€ä¸ªå¯¹åº”çš„ didBeginã€‚å› ä¸º didBegin è¡¨ç¤ºçš„æ˜¯ç”¨æˆ·<strong>å¼€å§‹è¾“å…¥</strong>çš„çŠ¶æ€ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå•å•æ˜¯å…‰æ ‡åœ¨æ§ä»¶ä¸Šé¢é—ªçƒç€æ˜¯ä¸ç®—æ•°çš„ï¼Œä¸€å®šè¦ç”¨æˆ·æ•²ä¸‹ç¬¬ä¸€ä¸ªå­—ç¬¦çš„æ—¶å€™æ‰ä¼šå›è°ƒ <code>controlTextDidBeginEditing(_:)</code>ã€‚</p><p>è€Œç›¸å¯¹çš„ï¼ŒdidEnd è¡¨ç¤º<strong>ç»“æŸç¼–è¾‘</strong>ï¼Œåªè¦ç”¨æˆ·é€‰ä¸­è¾“å…¥æ¡†ä¹‹åç‚¹å‡»äº†è¾“å…¥æ¡†ä»¥å¤–çš„åœ°æ–¹ï¼Œéƒ½ä¼šè¢«ç®—ä½œâ€œç»“æŸâ€ï¼Œå³ä½¿ä»–ä»å¤´åˆ°å°¾éƒ½æ²¡æœ‰è¾“å…¥è¿‡ä¸€ä¸ªå­—ã€‚</p><p>è¿™ä¸‰ä¸ªæ–¹æ³•ä¼ å…¥çš„å‚æ•°éƒ½æ˜¯ <code>Notification</code> ç±»å‹ï¼Œè¯´æ˜å®ƒä»¬å…¶å®éƒ½æ˜¯ç³»ç»Ÿé€šçŸ¥çš„å›è°ƒæ–¹æ³•ï¼Œåªè¦å®ç°äº†è¿™ä¸ªæ–¹æ³•ï¼Œç³»ç»Ÿå°±ä¼šè‡ªåŠ¨å¸®ä½ æ³¨å†Œè¿™ä¸‰ä¸ªæ¶ˆæ¯çš„ç›‘å¬å™¨ã€‚</p><blockquote><p>è™½ç„¶å‚æ•°æ˜¯ä¸ª <code>Notification</code> ï¼Œä½†å®ƒä¼šæŠŠè§¦å‘æ¶ˆæ¯çš„è¾“å…¥æ¡†ä½œä¸º object å±æ€§ä¸€èµ·ä¼ è¿›æ¥ï¼Œå¯ä»¥åšçš„äº‹æƒ…å°±ç›¸å½“å¤šäº†ã€‚</p></blockquote><h3 id="nscontroltexteditingdelegate">NSControlTextEditingDelegate</h3><p>è¿™ä¸ªä»£ç†æ˜¯ä¸“é—¨ä¸ºäº†ç¼–è¾‘æ“ä½œè€Œè®¾è®¡çš„ï¼Œé™¤äº†<s>è¿˜åœ¨ Beta ç‰ˆçš„</s>ä¸‰ä¸ª did ç³»åˆ—æ–¹æ³•å¤–ï¼ˆ2019.4 Beta æ ‡è¯†å·²ç»å»æ‰äº†ï¼‰ï¼Œè¿˜æœ‰åˆ†å·¥æ˜ç¡®çš„å¦å¤–7ä¸ªæ–¹æ³•ï¼Œä¸€å…±10ä¸ªã€‚è¿™éƒ¨åˆ†åœ¨ç°åœ¨çš„é¡¹ç›®é‡Œè¿˜æ²¡æ€ä¹ˆæ¥è§¦ï¼Œå°±åªæ˜¯æŠŠæ–‡æ¡£æ¬è¿‡æ¥æ–¹ä¾¿å¤§å®¶å‚è€ƒã€‚</p><p>éªŒè¯ï¼š</p><ul><li><a href="https://developer.apple.com/documentation/appkit/nscontroltexteditingdelegate/1428873-control" target="_blank" rel="noopener">control(_:isValidObject:)</a></li><li><a href="https://developer.apple.com/documentation/appkit/nscontroltexteditingdelegate/1428941-control" target="_blank" rel="noopener">control(_:didFailToValidatePartialString:errorDescription:)</a></li></ul><p>æ ¼å¼åŒ–æ–‡æœ¬ï¼š</p><ul><li><a href="https://developer.apple.com/documentation/appkit/nscontroltexteditingdelegate/1428883-control" target="_blank" rel="noopener">control(_:didFailToFormatString:errorDescription:)</a></li></ul><p>æ–‡æœ¬ç¼–è¾‘å“åº”ï¼š</p><ul><li><a href="https://developer.apple.com/documentation/appkit/nscontroltexteditingdelegate/1428865-control" target="_blank" rel="noopener">control(_:textShouldBeginEditing:)</a></li><li><a href="https://developer.apple.com/documentation/appkit/nscontroltexteditingdelegate/1428984-control" target="_blank" rel="noopener">control(_:textShouldEndEditing:)</a></li></ul><p>è‡ªåŠ¨è¡¥å…¨ï¼š</p><ul><li><a href="https://developer.apple.com/documentation/appkit/nscontroltexteditingdelegate/1428925-control" target="_blank" rel="noopener">control(_:textView:completions:forPartialWordRange:indexOfSelectedItem:)</a></li></ul><p>æŒ‰é”®äº‹ä»¶å“åº”ï¼š</p><ul><li><a href="https://developer.apple.com/documentation/appkit/nscontroltexteditingdelegate/1428898-control" target="_blank" rel="noopener">control(_:textView:doCommandBy:)</a></li></ul><p>æˆå‘˜æ–¹æ³• <s>Beta</s>:</p><ul><li><a href="https://developer.apple.com/documentation/appkit/nscontroltexteditingdelegate/3005176-controltextdidbeginediting" target="_blank" rel="noopener">controlTextDidBeginEditing(_:)</a></li><li><a href="https://developer.apple.com/documentation/appkit/nscontroltexteditingdelegate/3005177-controltextdidchange" target="_blank" rel="noopener">controlTextDidChange(_:)</a></li><li><a href="https://developer.apple.com/documentation/appkit/nscontroltexteditingdelegate/3005178-controltextdidendediting" target="_blank" rel="noopener">controlTextDidEndEditing(_:)</a></li></ul><h2 id="æ€»ç»“">æ€»ç»“</h2><p>æ²¡æœ‰é”™ï¼åˆ°è¿™é‡Œå°±ç»“æŸäº†ï¼ï¼ˆå› ä¸ºå®åœ¨æ˜¯æ²¡ä»€ä¹ˆå­˜è´§â€¦ï¼‰å¸Œæœ›è¿™ç¯‡æ–‡ç« èƒ½èµ·åˆ°å…¥é—¨å’Œç´¢å¼•çš„ä½œç”¨ã€‚</p><p>æœ‰äº†è¿™äº›å†…å®¹ï¼Œåº”è¯¥å¤§æ¦‚èƒ½çŸ¥é“æ€ä¹ˆå»æ§åˆ¶è¾“å…¥æ¡†çš„å†…å®¹ï¼Œä¹Ÿå¯ä»¥é¿å…ä¸€äº›ç®€å•çš„å‘äº†ã€‚</p><p>å¦‚æœæ²¡äººæ³¨æ„åˆ°æ ‡é¢˜é‡Œçš„â€œ(1)â€çš„è¯ï¼Œæˆ‘å°±åœ¨è¿™é‡Œæ‰“ä½äº†â€¦ä¸ç„¶æˆ‘å¯èƒ½ä¼šæŠŠæ‰“é€ ä¸€ä¸ªçœŸå®æƒ…æ™¯ä¸‹ä½¿ç”¨çš„è¾“å…¥æ¡†çš„è¿‡ç¨‹è®²ä¸€è®²ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;è¿™æ˜¯ macOS å¼€å‘ç³»åˆ—çš„ç¬¬å››ç¯‡æ–‡ç«  â€”â€” NSTextFieldã€‚&lt;br&gt;
æœ€å¸¸è§çš„æ§ä»¶ä¹‹ä¸€ï¼Œå´ä¸ä¸€å®šæ˜¯ä½ æœ€ç†Ÿæ‚‰çš„æ§ä»¶ä¹‹ä¸€ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="Swift" scheme="http://davidleee.com/tags/Swift/"/>
    
      <category term="macOS" scheme="http://davidleee.com/tags/macOS/"/>
    
      <category term="NSTextField" scheme="http://davidleee.com/tags/NSTextField/"/>
    
      <category term="NSControl" scheme="http://davidleee.com/tags/NSControl/"/>
    
  </entry>
  
  <entry>
    <title>åˆä¸€ç¯‡ iOS Extension å…¥é—¨ï¼ˆ3/3ï¼‰â€” Today å°ç»„ä»¶</title>
    <link href="http://davidleee.com/2018/11/15/yet-another-ios-extension-article-3/"/>
    <id>http://davidleee.com/2018/11/15/yet-another-ios-extension-article-3/</id>
    <published>2018-11-15T08:12:27.000Z</published>
    <updated>2020-05-05T03:43:31.446Z</updated>
    
    <content type="html"><![CDATA[<p>æ˜¨å¤©é€šè¿‡ä¸¤ç¯‡æ–‡ç« ä»‹ç»äº† iOS Extension çš„åŸºç¡€ï¼Œå¹¶å°è¯•åˆ¶ä½œäº†ä¸€ä¸ªåˆ†äº«æ‰©å±•ï¼Œè®©æˆ‘ä»¬çš„åº”ç”¨å¯ä»¥æ¥æ”¶åˆ°ä»å…¶ä»–åº”ç”¨åˆ†äº«è¿‡æ¥çš„æ•°æ®ï¼Œè¿˜å®ç°äº†è·¨æ²™ç›’çš„åº”ç”¨æ‰©å±•ä¸è½½ä½“é—´çš„é€šä¿¡ã€‚</p><p>çœ‹ä¸Šé¢è¿™æ®µè¯å°±è§‰å¾—å†…å®¹æŒºå¤šçš„å§â€¦æ‰€ä»¥ä¸“é—¨æŠŠ Extension ç•Œçš„å½“çº¢é€‰æ‰‹ â€”â€” Today å°ç»„ä»¶å•ç‹¬æ”¾åœ¨è¿™ä¸€ç¯‡æ–‡ç« é‡Œé¢è®²ï¼Œä½œä¸ºè¿™ä¸ª iOS Extension å…¥é—¨ç³»åˆ—çš„æ”¶å°¾ï½</p><p>è®©æˆ‘ä»¬é©¬ä¸Šè¿›å…¥æ­£é¢˜ï¼</p><a id="more"></a><h2 id="å•¥æ˜¯-today-å°ç»„ä»¶">å•¥æ˜¯ Today å°ç»„ä»¶</h2><p>å±•ç¤ºåœ¨ Today ç•Œé¢ï¼ˆæ‰‹æœºä¸»é¡µæœ€å·¦å±ï¼‰é‡Œçš„åº”ç”¨æ‰©å±•ç»Ÿç§°ä¸ºâ€œå°ç»„ä»¶â€ï¼ˆWidgetï¼‰ã€‚å°ç»„ä»¶å­˜åœ¨çš„ç›®çš„æ˜¯å‘ç”¨æˆ·å¿«é€Ÿå±•ç¤º<strong>å½“ä¸‹</strong>æœ€é‡è¦çš„ä¿¡æ¯ï¼Œå¹¶æä¾›ä¸€äº›ç®€æ˜“çš„ä»»åŠ¡å¤„ç†åŠŸèƒ½ï¼Œæ¯”å¦‚â€œæŠŠä»»åŠ¡æ ‡è®°ä¸ºå®Œæˆâ€ä¹‹ç±»çš„ã€‚</p><blockquote><p>å®˜æ–¹å»ºè®®ï¼š Today å°ç»„ä»¶è´Ÿè´£çš„ä»»åŠ¡æœ€å¥½åœ¨å•æ¬¡æ“ä½œå†…å°±èƒ½å®Œæˆï¼Œå¦‚æœä½ å‘ç°è¿™ä¸ªä»»åŠ¡éœ€è¦å¤šä¸ªæ­¥éª¤ï¼Œé‚£ Today å°ç»„ä»¶ä¹Ÿè®¸ä¸æ˜¯æœ€é€‚åˆçš„æ‰©å±•ç‚¹ã€‚å…·ä½“æ‰©å±•ç‚¹å‚è§ <a href="https://developer.apple.com/library/archive/documentation/General/Conceptual/ExtensibilityPG/index.html#//apple_ref/doc/uid/TP40014214-CH20-SW3" target="_blank" rel="noopener">å®˜æ–¹æ‰©å±•ç‚¹åˆ—è¡¨</a> æˆ–è€…è¿™ä¸ªç³»åˆ—æ–‡ç« çš„ç¬¬ä¸€ç¯‡ï¼ˆ<a href="/2018/11/14/yet-another-ios-extension-article/" title="åˆä¸€ç¯‡ iOS Extension å…¥é—¨ï¼ˆ1/3ï¼‰â€” åŸºç¡€ & åˆ†äº«æ‰©å±•">åˆä¸€ç¯‡ iOS Extension å…¥é—¨ï¼ˆ1/3ï¼‰â€” åŸºç¡€ & åˆ†äº«æ‰©å±•</a>ï¼‰é‡Œçš„ç¿»è¯‘ç‰ˆã€‚</p></blockquote><h3 id="åˆ’é‡ç‚¹">åˆ’é‡ç‚¹</h3><p>iOS å’Œ macOS å¹³å°ä¸Šéƒ½æœ‰ Today å°ç»„ä»¶ï¼Œåœ¨å¼€å‘è¿‡ç¨‹ä¸­éœ€è¦æ³¨æ„çš„åœ°æ–¹æ˜¯ç›¸åŒçš„ï¼š</p><ul><li>ç¡®ä¿å†…å®¹æ˜¯æœ€æ–°çš„</li><li>è°¨æ…åœ°å¯¹å¾…ç”¨æˆ·äº¤äº’</li><li>æ€§èƒ½è°ƒä¼˜</li></ul><blockquote><p>ä»äº¤äº’ä¸Šæ¥è¯´ï¼ŒåŠ¡å¿…é¿å…åœ¨å°ç»„ä»¶é‡Œæ”¾æ»šåŠ¨åˆ—è¡¨ï¼Œå› ä¸ºç”¨æˆ·å¾ˆéš¾åŒºåˆ†å°ç»„ä»¶å†…éƒ¨çš„æ»šåŠ¨å’Œæ•´ä¸ªå°ç»„ä»¶åˆ—è¡¨çš„æ»šåŠ¨</p></blockquote><p><strong>åœ¨ iOS ä¸Š</strong>ï¼šå°ç»„ä»¶ä¸å…è®¸é”®ç›˜è¾“å…¥ï¼Œæ‰€ä»¥ä¸€åˆ‡é’ˆå¯¹å°ç»„ä»¶çš„è®¾ç½®éƒ½åº”è¯¥åœ¨è½½ä½“åº”ç”¨å†…å®Œæˆã€‚ä»¥â€œè‚¡å¸‚â€ä¸ºä¾‹ï¼Œç”¨æˆ·å¯ä»¥ç›´æ¥åœ¨å°ç»„ä»¶ä¸Šåˆ‡æ¢æ˜¾ç¤ºçš„å•ä½ï¼Œä½†æ˜¯è‚¡ç¥¨åˆ—è¡¨çš„ç¼–è¾‘éœ€è¦åœ¨è½½ä½“åº”ç”¨é‡Œè¿›è¡Œã€‚<br><strong>åœ¨ macOS ä¸Š</strong>ï¼šè½½ä½“åº”ç”¨å¯ä»¥ä¸åšä»»ä½•åŠŸèƒ½ï¼Œå°ç»„ä»¶å¯ä»¥æä¾›ä¸€ä¸ªé…ç½®å…¥å£ã€‚è¿˜æ˜¯ä»¥â€œè‚¡å¸‚â€ä¸ºä¾‹ï¼Œå°ç»„ä»¶é‡Œå¯ä»¥ç›´æ¥æœç´¢ã€æ·»åŠ å’Œåˆ é™¤ç‰¹å®šè‚¡ç¥¨ã€‚</p><h2 id="æ¥åšä¸€ä¸ª-today-å°ç»„ä»¶å§">æ¥åšä¸€ä¸ª Today å°ç»„ä»¶å§</h2><p>å°±åƒåˆ›å»ºåˆ†äº«æ‰©å±•é‚£æ ·ï¼Œé¦–å…ˆè¦åœ¨é¡¹ç›®é…ç½®é‡Œæ·»åŠ ä¸€ä¸ª Targetï¼ˆå¤ä¹ <a href="/2018/11/14/yet-another-ios-extension-article/" title="ç³»åˆ—æ–‡ç« ç¬¬ä¸€ç¯‡">ç³»åˆ—æ–‡ç« ç¬¬ä¸€ç¯‡</a>ï¼‰ï¼Œå¦‚æœæƒ³è¦å…±äº«æ•°æ®çš„è¯ï¼Œè¿˜éœ€è¦é…ç½®ä¸€ä¸‹ Capabilities -&gt; App Groupsï¼ˆå¤ä¹ <a href="/2018/11/14/yet-another-ios-extension-article-2/" title="ç³»åˆ—æ–‡ç« ç¬¬äºŒç¯‡">ç³»åˆ—æ–‡ç« ç¬¬äºŒç¯‡</a>ï¼‰ã€‚</p><p>Xcode ä¾æ—§è´´å¿ƒåœ°ä¸ºæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªç›®å½•ï¼Œéšä¾¿ç‚¹å¼€çœ‹çœ‹ï¼Œå¯ä»¥å‘ç° <em>Info.plist</em> é‡Œå…³äº <code>NSExtension</code> çš„å†…å®¹æœ‰æ‰€ä¸åŒï¼Œå…¶ä¸­çš„ <code>NSExtensionActivationRule</code> å­—æ®µå·²ç»æ²¡æœ‰äº†ï¼Œå› ä¸º Today å°ç»„ä»¶çš„å¼€å…³æ˜¯ç”¨æˆ·è‡ªå·±é€‰æ‹©æ“ä½œçš„ï¼Œä¸éœ€è¦æˆ‘ä»¬å¼€å‘è€…å»åˆ¤æ–­ã€‚</p><h3 id="ç•Œé¢">ç•Œé¢</h3><blockquote><p>ä¸ºäº†å®ç°æœ€å¥½çš„æ•ˆæœï¼Œå»ºè®®ä½¿ç”¨ AutoLayout å»åšç•Œé¢çš„å¸ƒå±€ã€‚</p></blockquote><p>Today å°ç»„ä»¶çš„å®½åº¦æ˜¯å›ºå®šçš„ï¼Œé«˜åº¦ä¸Šæœ‰å»¶ä¼¸çš„ç©ºé—´ä»¥æ˜¾ç¤ºæ›´å¤šçš„å†…å®¹ã€‚Xcode åˆ›å»ºçš„ IB æ¨¡ç‰ˆé‡Œå·²ç»ç”¨ä¸Šäº† AutoLayoutï¼Œå¹¶ç”¨ä¸Šäº†æ ‡å‡†çš„å››å‘¨é—´éš”ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>widgetMarginInsetsForProposedMarginInsets:</code> æ–¹æ³•æ¥è·å–åˆ°è¿™äº›é—´éš”ä»¥ä¾¿è®¡ç®—ã€‚</p><blockquote><p>æ¨¡ç‰ˆé‡Œçš„ VC å·²ç»å®ç°äº† <code>NSWidgetProviding</code> åè®®ï¼Œä¸Šè¿°æ–¹æ³•å°±æ˜¯åœ¨è¿™ä¸ªåè®®é‡Œå®šä¹‰çš„ã€‚</p></blockquote><p>ç•Œé¢éƒ¨åˆ†æœ€å€¼å¾—ä¸€æçš„å°±æ˜¯å³ä¸Šè§’çš„â€œå±•å¼€/æŠ˜å â€äº†ã€‚è¿™ä¸ªæŒ‰é’®é»˜è®¤æƒ…å†µä¸‹å¹¶ä¸ä¼šæ˜¾ç¤ºï¼Œéœ€è¦æˆ‘ä»¬æ·»åŠ ä¸€äº›ä»£ç æ¥å®ç°ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">viewDidLoad</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="keyword">super</span>.viewDidLoad()</span><br><span class="line">  <span class="comment">// 1</span></span><br><span class="line">    extensionContext?.widgetLargestAvailableDisplayMode = .expanded</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">widgetActiveDisplayModeDidChange</span><span class="params">(<span class="number">_</span> activeDisplayMode: NCWidgetDisplayMode, withMaximumSize maxSize: CGSize)</span></span> &#123;</span><br><span class="line">  <span class="comment">// 3</span></span><br><span class="line">    <span class="keyword">if</span> activeDisplayMode == .expanded &#123;</span><br><span class="line">        preferredContentSize = <span class="type">CGSize</span>(width: maxSize.width, height: <span class="number">200</span>)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        preferredContentSize = maxSize</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li>å‘Šè¯‰ <code>extensionContext</code> æˆ‘ä»¬çš„å°ç»„ä»¶æ˜¯æ”¯æŒå±•å¼€çš„ï¼Œè¿™ä¸ªå±æ€§çš„é»˜è®¤å€¼æ˜¯ <code>.compact</code></li><li>ç”¨æˆ·ç‚¹å‡»â€œå±•å¼€/æŠ˜å â€çš„å›è°ƒï¼Œå¦‚æœä¸è¿›è¡Œå¤„ç†ï¼Œå°ç»„ä»¶çš„é«˜åº¦ä¸ä¼šå‘ç”Ÿå˜åŒ–</li><li>ä¿®æ”¹å°ç»„ä»¶çš„é«˜åº¦ï¼Œè¿™é‡Œçš„ <code>maxSize</code> æ˜¯ç³»ç»Ÿé™åˆ¶çš„å½“å‰æ¨¡å¼ä¸‹çš„æœ€å¤§å°ºå¯¸ï¼Œä½¿ç”¨ iPhone XR æ¨¡æ‹Ÿå™¨æµ‹è¯•æ—¶ï¼Œ<code>.compact</code> æ¨¡å¼ä¸‹æ˜¯ <code>(398, 110)</code>ï¼Œ<code>.expanded</code> æ¨¡å¼ä¸‹æ˜¯ <code>(398, 748)</code>ã€‚å¯è§ï¼Œè‹¹æœé™åˆ¶äº†æŠ˜å çŠ¶æ€ä¸‹æœ€å¤§é«˜åº¦ä¸º 110ï¼Œè¶…å‡ºéƒ¨åˆ†ä¼šç›´æ¥æˆªæ‰ï¼›è€Œå±•å¼€çŠ¶æ€ä¸‹ï¼Œæœ€å¤§é«˜åº¦ä¸ºè®¾å¤‡çš„é«˜åº¦ã€‚</li></ol><p>ç•Œé¢éƒ¨åˆ†å°±æ²¡ä»€ä¹ˆäº†ï¼Œå‰©ä¸‹çš„è¯¥æ˜¯å…·ä½“é—®é¢˜å…·ä½“åˆ†æã€‚æ¥ä¸‹æ¥è½®åˆ°åŠŸèƒ½é€»è¾‘çš„éƒ¨åˆ†ã€‚</p><h3 id="è·³è½¬åˆ°è½½ä½“åº”ç”¨">è·³è½¬åˆ°è½½ä½“åº”ç”¨</h3><p>å®é™…ä¸Šï¼Œå°ç»„ä»¶è¿˜æ˜¯é€šè¿‡ Universal Link çš„æœºåˆ¶æ¥å”¤èµ·è½½ä½“åº”ç”¨çš„ï¼Œä¸åº”ç”¨é—´è·³è½¬æ²¡æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Œåªä¸è¿‡éœ€è¦é€šè¿‡ <code>extensionContext</code> æ¥è°ƒç”¨ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// å”¤èµ· URL Schemes ä¸º davidleee çš„åº”ç”¨</span></span><br><span class="line">extensionContext?.<span class="keyword">open</span>(<span class="type">URL</span>(string: <span class="string">"davidleee://"</span>)!, completionHandler: <span class="literal">nil</span>)</span><br></pre></td></tr></table></figure><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœä½ çš„å°ç»„ä»¶è¦æ‰“å¼€ç¬¬ä¸‰æ–¹çš„åº”ç”¨ï¼Œåœ¨æäº¤ App Store å®¡æ ¸çš„æ—¶å€™éœ€è¦ç‰¹åˆ«è¯´æ˜ä¸€ä¸‹ï¼Œå¦åˆ™ä¼šè¢«æ‰“å›ã€‚</p><blockquote><p>å…³äº Universal Link çš„å®˜æ–¹æ–‡æ¡£åœ¨è¿™é‡Œï¼š<a href="https://developer.apple.com/ios/universal-links/" target="_blank" rel="noopener">Universal Links - Apple Developer</a>ï¼Œæˆ‘ä¹Ÿå†™è¿‡ä¸€ç¯‡æ–‡ç« è®°å½•äº†å¯èƒ½å­˜åœ¨çš„ä¸€äº›å‘ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥ç…ç…ï¼š<a href="/2017/01/04/universal-link-problems/" title="Universal Linkï¼ˆiOSï¼‰è¸©å‘">Universal Linkï¼ˆiOSï¼‰è¸©å‘</a></p></blockquote><h3 id="æ•°æ®æ›´æ–°">æ•°æ®æ›´æ–°</h3><p>æ—¢ç„¶ Today å°ç»„ä»¶çš„ç›®çš„å°±æ˜¯ä¸ºç”¨æˆ·æä¾›æœ€æ–°é²œçš„æ•°æ®ï¼Œé‚£ä¹ˆæ•°æ®æ›´æ–°çš„éƒ¨åˆ†å°±ä¸€å®šä¸èƒ½é©¬è™ã€‚</p><p>åœ¨ Xcode å¸®æˆ‘ä»¬åˆ›å»ºçš„ <code>TodayViewController</code> é‡Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå«  <code>widgetPerformUpdate(completionHandler:)</code> çš„æ–¹æ³•ï¼Œåœ¨å®ƒçš„æè¿°é‡Œèƒ½çœ‹åˆ°è¿™ä¹ˆä¸€å¥è¯ï¼š</p><p><em>This method is called to give a widget an opportunity to update its contents and redraw its view prior to an operation such as a snapshot.</em></p><p>è‹¹æœè®¾è®¡è¿™ä¸ª API æ˜¯ä¸ºäº†æŠŠæ•°æ®çš„æ›´æ–°ç»Ÿä¸€æ”¾åˆ°ä¸€ä¸ªåœ°æ–¹å»ã€‚å¦‚æœæˆ‘ä»¬å®ç°äº†è¿™ä¸ªæ–¹æ³•ï¼Œç³»ç»Ÿå°±ä¼šåœ¨åˆé€‚çš„æ—¶å€™è°ƒç”¨è¿™ä¸ªæ–¹æ³•ï¼ˆæ¯”å¦‚ç³»ç»Ÿæƒ³è¦ç»™ä½ çš„å°ç»„ä»¶è¿›è¡Œ snapshot ä¹‹å‰ï¼‰ï¼Œç»™æˆ‘ä»¬ä¸€æ¬¡æ›´æ–°æ•°æ®çš„æœºä¼šï¼Œå¹¶ä¸”è¿™ä¸ªæœºä¼šä¸ä¸€å®šå‡ºç°åœ¨å°ç»„ä»¶æ˜¾ç¤ºå‡ºæ¥çš„æ—¶å€™ï¼Œåœ¨åå°çš„æƒ…å†µä¸‹ä¹Ÿæœ‰å¯èƒ½è§¦å‘è¿™ä¸ªå›è°ƒã€‚</p><p>äºæ˜¯æˆ‘ä»¬å°±æœ‰ä¸¤ä¸ªæ‹‰æ•°æ®çš„æœºä¼šï¼š</p><ul><li>åœ¨ <code>viewDidLoad</code> é‡Œé¢</li><li>åœ¨ <code>widgetPerformUpdate(completionHandler:)</code> é‡Œé¢</li></ul><blockquote><p>å®éªŒå‘ç°ï¼Œå°ç»„ä»¶åªè¦ä¸å¯è§çš„æ—¶é—´ç¨å¾®é•¿ä¸€ç‚¹ç‚¹ï¼Œæ¯”å¦‚æ»šåŠ¨å‡ºäº†å±å¹•ï¼Œæˆ–ç¦»å¼€ Today è§†å›¾ä¸€å°ä¼šï¼Œå®ƒå°±ä¼šè¢«é‡æ–°åˆå§‹åŒ–ï¼Œä¹Ÿå°±æ˜¯è¯´ <code>viewDidLoad</code> çš„è°ƒç”¨ä¼šæ¯”æƒ³è±¡ä¸­æ›´é¢‘ç¹ã€‚ä½†è¿™å¹¶ä¸æ„å‘³ç€æˆ‘ä»¬å¯ä»¥å®Œå…¨ä¾èµ– <code>viewDidLoad</code> æ¥åšæ•°æ®æ›´æ–°ã€‚</p></blockquote><p>åœ¨ SO ä¸Šçš„<a href="https://stackoverflow.com/questions/25168950/what-is-the-purpose-of-widgetperformupdatewithcompletionhandler-in-ios-8-today-w" target="_blank" rel="noopener">è¿™ä¸ªè®¨è®º</a>é‡Œï¼Œå¯¹æ•°æ®æ›´æ–°çš„æ—¶æœºè¿›è¡Œäº†æ›´å¤šçš„è®¨è®ºï¼Œæ€»ç»“èµ·æ¥å°±æ˜¯ä¸¤ç‚¹ï¼š</p><ol><li>è‹¹æœå¸Œæœ›ä½ åœ¨æ•´ä¸ªç”Ÿå‘½å‘¨æœŸé‡Œå°½å¯èƒ½æ—©çš„åœ°æ–¹è¿›è¡Œæ•°æ®æ›´æ–°ï¼Œæ‰€ä»¥ <code>viewDidLoad</code> è¦ç”¨</li><li><code>viewDidLoad</code> è¿˜ä¸å¤Ÿï¼Œé‚£å°±ç”¨ä¸Š <code>widgetPerformUpdate(completionHandler:)</code>ï¼Œæ¯•ç«Ÿå‰è€…å¹¶ä¸ä¼šåœ¨åå°æƒ…å†µä¸‹è¢«è°ƒç”¨</li></ol><h2 id="æ€»ç»“ä¸€ä¸‹">æ€»ç»“ä¸€ä¸‹</h2><p>Today å°ç»„ä»¶å°±æ˜¯ä¸€ä¸ªç”¨æ¥å±•ç¤º<strong>å°å—</strong>æ•°æ®å’Œå¤„ç†<strong>ç®€å•</strong>ä»»åŠ¡çš„åœ°æ–¹ã€‚</p><p>æ³¨æ„ä¸Šé¢é‚£å¥è¯åŠ ç²—çš„ä¸¤ä¸ªè¯ï¼Œè¿™ç»™å°ç»„ä»¶å®šä¸‹äº†ä¸€ä¸ªä¸»åŸºè°ƒï¼šæ•æ·ï¼Œæ‰€ä»¥å‡¡æ˜¯é€»è¾‘è¶Šå†™è¶Šå¤æ‚çš„æ—¶å€™ï¼Œéƒ½è¯¥åœä¸‹æ¥æƒ³ä¸€æƒ³ï¼šè¿™äº›é€»è¾‘æ˜¯ä¸æ˜¯åº”è¯¥æŒªåˆ°è½½ä½“åº”ç”¨é‡Œé¢å»åšï¼Ÿ</p><blockquote><p>ç”¨è¿™ä¸ªç†ç”±å»æ€¼äº§å“ç»ç†å§ï¼Œå°±è¯´æ˜¯é‚£ä¸ªä¼°å€¼è¶…ä¸‡äº¿çš„è‹¹æœçš„äº§å“ç»ç†è¯´çš„ï½</p></blockquote><h2 id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </h2><ul><li><a href="https://developer.apple.com/library/archive/documentation/General/Conceptual/ExtensibilityPG/Today.html#//apple_ref/doc/uid/TP40014214-CH11-SW1" target="_blank" rel="noopener">App Extension Programming Guide: Today</a></li><li><a href="https://medium.com/nine9devtw/ios-today-extension-swift-%E6%95%99%E5%AD%B8%E7%AD%86%E8%A8%98-5361446d1950" target="_blank" rel="noopener">iOS today extension (swift) æ•™å­¸ç­†è¨˜ â€“ ç¢¼è¾²å‹¤è€•ç”° â€“ Medium</a></li><li><a href="https://stackoverflow.com/questions/25168950/what-is-the-purpose-of-widgetperformupdatewithcompletionhandler-in-ios-8-today-w" target="_blank" rel="noopener">ios8 - What is the purpose of widgetPerformUpdateWithCompletionHandler in iOS 8 Today Widget? - Stack Overflow</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ˜¨å¤©é€šè¿‡ä¸¤ç¯‡æ–‡ç« ä»‹ç»äº† iOS Extension çš„åŸºç¡€ï¼Œå¹¶å°è¯•åˆ¶ä½œäº†ä¸€ä¸ªåˆ†äº«æ‰©å±•ï¼Œè®©æˆ‘ä»¬çš„åº”ç”¨å¯ä»¥æ¥æ”¶åˆ°ä»å…¶ä»–åº”ç”¨åˆ†äº«è¿‡æ¥çš„æ•°æ®ï¼Œè¿˜å®ç°äº†è·¨æ²™ç›’çš„åº”ç”¨æ‰©å±•ä¸è½½ä½“é—´çš„é€šä¿¡ã€‚&lt;/p&gt;
&lt;p&gt;çœ‹ä¸Šé¢è¿™æ®µè¯å°±è§‰å¾—å†…å®¹æŒºå¤šçš„å§â€¦æ‰€ä»¥ä¸“é—¨æŠŠ Extension ç•Œçš„å½“çº¢é€‰æ‰‹ â€”â€” Today å°ç»„ä»¶å•ç‹¬æ”¾åœ¨è¿™ä¸€ç¯‡æ–‡ç« é‡Œé¢è®²ï¼Œä½œä¸ºè¿™ä¸ª iOS Extension å…¥é—¨ç³»åˆ—çš„æ”¶å°¾ï½&lt;/p&gt;
&lt;p&gt;è®©æˆ‘ä»¬é©¬ä¸Šè¿›å…¥æ­£é¢˜ï¼&lt;/p&gt;
    
    </summary>
    
    
      <category term="Universal Link" scheme="http://davidleee.com/tags/Universal-Link/"/>
    
      <category term="ios" scheme="http://davidleee.com/tags/ios/"/>
    
      <category term="Today Extension" scheme="http://davidleee.com/tags/Today-Extension/"/>
    
      <category term="Widget" scheme="http://davidleee.com/tags/Widget/"/>
    
  </entry>
  
  <entry>
    <title>åˆä¸€ç¯‡ iOS Extension å…¥é—¨ï¼ˆ2/3ï¼‰â€” ä¸å®¹å™¨æ²Ÿé€š</title>
    <link href="http://davidleee.com/2018/11/14/yet-another-ios-extension-article-2/"/>
    <id>http://davidleee.com/2018/11/14/yet-another-ios-extension-article-2/</id>
    <published>2018-11-14T10:01:12.000Z</published>
    <updated>2020-05-05T03:43:31.446Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨<a href="/2018/11/14/yet-another-ios-extension-article/" title="ä¸Šä¸€ç¯‡æ–‡ç« ">ä¸Šä¸€ç¯‡æ–‡ç« </a>é‡Œï¼Œæˆ‘ä»¬äº†è§£åˆ°äº† iOS Extension çš„åŸºç¡€å’Œæ€ä¹ˆåˆ¶ä½œä¸€ä¸ªç®€å•çš„åˆ†äº«æ‰©å±•ï¼Œç„¶è€Œï¼Œé™äºç¯‡å¹…åŸå› ï¼Œè¿™ä¸ªåˆ†äº«æ“ä½œæ­¢äºç”¨æˆ·ç‚¹ä¸‹ â€œPostâ€ çš„é‚£ä¸€åˆ»äº†ã€‚<br>æ¥ä¸‹æ¥ï¼Œå°±è®©æˆ‘ä»¬ä¸€èµ·çœ‹çœ‹æ€ä¹ˆæŠŠç”¨æˆ·åˆ†äº«çš„æ•°æ®ç»™åˆ°è½½ä½“åº”ç”¨ï¼Œè®©è¿™æ¬¡åˆ†äº«æºœå¾—é£èµ·ã€‚</p><a id="more"></a><h2 id="app-groups">App Groups</h2><p>æˆ‘ä»¬éƒ½çŸ¥é“ iOS çš„åº”ç”¨æ˜¯è·‘åœ¨ä¸€ä¸ªå±äºè‡ªå·±çš„æ²™ç›’é‡Œé¢çš„ï¼Œä¸ºäº†å®ç°åº”ç”¨é—´çš„æ•°æ®å…±äº«ï¼Œè‹¹æœæä¾›äº†ä¸€ä¸ªå« App Groups çš„æ¦‚å¿µã€‚åªæœ‰å½“åº”ç”¨å±äºåŒä¸€ä¸ª App Groups çš„æ—¶å€™ï¼Œæ‰èƒ½è®¿é—®åˆ°å…±äº«çš„æ•°æ®å­˜å‚¨åŒºåŸŸã€‚</p><p>æˆ‘ä»¬å¯ä»¥åœ¨è½½ä½“åº”ç”¨çš„é¡¹ç›®é…ç½® Capabilities -&gt; App Groups é‡Œåˆ›å»ºä¸€ä¸ªåº”ç”¨åˆ†ç»„ï¼š<br><img src="/uploads/yet-another-ios-extension-article-2/77534A33-46E6-4381-B6EC-4AA09E726A6A.png" alt></p><p>ç„¶ååœ¨åº”ç”¨æ‰©å±•çš„é¡¹ç›®é…ç½® Capabilities -&gt; App Groups é‡Œä¼šå‡ºç°æˆ‘ä»¬åˆšåˆšæ–°å»ºçš„åº”ç”¨åˆ†ç»„ï¼Œç›´æ¥é’©ä¸Šå°±å¯ä»¥äº†ã€‚</p><p>è¿™æ ·æˆ‘ä»¬å°±ç­‰äºåˆ†é…äº†ä¸€ä¸ªå…±äº«ç©ºé—´ç»™è¿™å“¥ä¿©ï¼Œä¸ºæˆ‘ä»¬æ¥ä¸‹æ¥çš„æ•°æ®å…±äº«åšå¥½å‡†å¤‡äº†ã€‚</p><h2 id="å…±äº«ç©ºé—´">å…±äº«ç©ºé—´</h2><p>åšå®Œä¸Šé¢çš„å‡†å¤‡ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¸‰ç§æ–¹å¼å»è®¿é—®å…±äº«ç©ºé—´ï¼Œå®ƒä»¬åˆ†åˆ«æ˜¯ <code>UserDefaults</code>ã€<code>FileManager</code> å’Œ <code>CoreData</code>ã€‚</p><h3 id="userdefaults">UserDefaults</h3><p><code>UserDefaults</code> æœ‰ä¸€ä¸ªå¸¦å‚æ•°çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œé€šè¿‡è¿™ä¸ªæ–¹æ³•æˆ‘ä»¬å¯ä»¥è®¿é—®åˆ°ä¸€ä¸ªå…±äº«çš„ç”¨æˆ·é…ç½®ç©ºé—´ã€‚åœ¨ä¸Šä¸€ç¯‡æ–‡ç« é‡Œï¼Œæˆ‘ä»¬æˆåŠŸæŠŠ Safari åˆ†äº«å‡ºæ¥çš„ä¸€ä¸ª URL æ‰“å°äº†å‡ºæ¥ï¼Œç°åœ¨æˆ‘ä»¬æŠŠå®ƒæ”¾åˆ°å…±äº«ç©ºé—´å»ï¼Œè®©è½½ä½“åº”ç”¨ä¹Ÿå¯ä»¥è·å–åˆ°è¿™ä¸ªé“¾æ¥ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line">attachment.loadItem(forTypeIdentifier: kUTTypeURL <span class="keyword">as</span> <span class="type">String</span>, options: <span class="literal">nil</span>) &#123; (item, error) <span class="keyword">in</span></span><br><span class="line">                        <span class="keyword">if</span> error == <span class="literal">nil</span> &#123;</span><br><span class="line">                            <span class="keyword">let</span> userDefaults = <span class="type">UserDefaults</span>(suiteName: <span class="string">"group.com.davidleee.SharePlayground"</span>)</span><br><span class="line">                            userDefaults?.<span class="keyword">set</span>(item, forKey: <span class="string">"share-url"</span>)</span><br><span class="line">   <span class="built_in">print</span>(<span class="string">"url from userdefault: \(userDefaults?.value(forKey: "</span>share-url<span class="string">"))"</span>)</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure><p>é€šè¿‡ä¼ å…¥ä¹‹å‰è®¾ç½®å¥½çš„åº”ç”¨åˆ†ç»„ IDï¼Œæˆ‘ä»¬å‘Šè¯‰ <code>UserDefault</code> æ¥ä¸‹æ¥è¦è®¿é—®ä¸€ä¸ªç‰¹å®šçš„å…±äº«ç©ºé—´ï¼Œæ¥ç€å°±åƒå¹³å¸¸é‚£æ ·ä½¿ç”¨å®ƒå³å¯ã€‚</p><blockquote><p>ä¸Šé¢çš„æ‰“å°è¾“å‡ºçš„æ˜¯ä¸€å † dataï¼Œä»¥ä¸º <code>URL</code> åœ¨ä¿å­˜åˆ° <code>UserDefaults</code> çš„æ—¶å€™ä¼šè¢«åºåˆ—åŒ–ï¼Œæƒ³çœ‹åˆ°åŸæ¥çš„ <code>URL</code> å¯¹è±¡çš„è¯è¿˜è¦å†ååºåˆ—åŒ–ä¸€ä¸‹æ‰è¡Œã€‚</p></blockquote><h3 id="filemanager">FileManager</h3><p>ä¸ <code>UserDefaults</code> ç±»ä¼¼ï¼Œ<code>FileManager</code> ä¹Ÿæœ‰ä¸€ä¸ªç‰¹æ®Šçš„è·å–æ–¹æ³•ï¼Œæˆ‘ä»¬çœ‹çœ‹æŠŠåˆšåˆšçš„ URL å†™åˆ°ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶é‡Œåº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">...</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> groupPath = <span class="type">FileManager</span>.<span class="keyword">default</span>.containerURL(forSecurityApplicationGroupIdentifier: <span class="string">"group.com.davidleee.SharePlayground"</span>)</span><br><span class="line">                            <span class="keyword">if</span> <span class="keyword">let</span> url = item <span class="keyword">as</span>? <span class="type">URL</span>, <span class="keyword">let</span> filePath = groupPath?.appendingPathComponent(<span class="string">"url.txt"</span>)  &#123;</span><br><span class="line">                                <span class="keyword">try</span>? url.absoluteString.write(to: filePath, atomically: <span class="literal">true</span>, encoding: .utf8)</span><br><span class="line">                            &#125;</span><br><span class="line">                            </span><br><span class="line">                            <span class="keyword">if</span> <span class="keyword">let</span> filePath = groupPath?.appendingPathComponent(<span class="string">"url.txt"</span>) &#123;</span><br><span class="line">                                <span class="keyword">try</span>? <span class="built_in">print</span>(<span class="string">"content of file: \(String(contentsOf: filePath, encoding: .utf8))"</span>)</span><br><span class="line">                            &#125;</span><br><span class="line"></span><br><span class="line">...</span><br></pre></td></tr></table></figure><h3 id="coredata">CoreData</h3><p>å¥½å§ï¼ŒCoreData çš„å…±äº«ç©ºé—´å…¶å®è·Ÿ <code>FileManager</code> æ˜¯åŒä¸€ä¸ªï¼Œåªæ˜¯ä»å†™æ–‡ä»¶å˜æˆå†™æ•°æ®åº“ï¼Œå†æŠŠæ•°æ®åº“çš„æ–‡ä»¶æ”¾åˆ°å…±äº«ç©ºé—´è€Œå·²ã€‚è¿™ä¸ªå°±ä¸è´´ä»£ç äº†ï¼ŒCoreData é‡Œçš„ç±»åæ˜¯çœŸçš„é•¿â€¦</p><h2 id="æ€»ç»“ä¸€ä¸‹">æ€»ç»“ä¸€ä¸‹</h2><p>æ„Ÿè§‰è¿™ç¯‡æ–‡ç« è·Ÿåº”ç”¨æ‰©å±•éƒ½æ²¡ä»€ä¹ˆå…³ç³»äº†â€¦æ¯•ç«Ÿ App Goups æ˜¯ iOS å¹³å°ä¸Šä¸€ä¸ªæ¯”è¾ƒé€šç”¨çš„æ•°æ®å…±äº«æŠ€æœ¯ã€‚</p><p>App Groups çš„å¼•å…¥è®© iOS åº”ç”¨é—´æ•°æ®å…±äº«æˆä¸ºå¯èƒ½ï¼Œè¿™ä¸ä»…å¯ä»¥ç”¨åœ¨åº”ç”¨æ‰©å±•å’Œè½½ä½“åº”ç”¨ä¹‹é—´ï¼Œè¿˜å¯ä»¥ç”¨åœ¨è‡ªå®¶çš„å¤šä¸ªç‹¬ç«‹åº”ç”¨ä¹‹é—´ï¼ŒçœŸå¯è°“æ˜¯æ²™ç›’å¢™ä¸Šé€è¿‡æ¥çš„ä¸€é“äº®å…‰ã€‚</p><h2 id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </h2><ul><li><a href="https://my.oschina.net/vimfung/blog/707448" target="_blank" rel="noopener">iOSæ‰©å±•å¼€å‘æ”»ç•¥(ä¸€) - Share Extension - vimfungçš„å¼€æºéƒ¨è½ - å¼€æºä¸­å›½</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨&lt;a href=&quot;/2018/11/14/yet-another-ios-extension-article/&quot; title=&quot;ä¸Šä¸€ç¯‡æ–‡ç« &quot;&gt;ä¸Šä¸€ç¯‡æ–‡ç« &lt;/a&gt;é‡Œï¼Œæˆ‘ä»¬äº†è§£åˆ°äº† iOS Extension çš„åŸºç¡€å’Œæ€ä¹ˆåˆ¶ä½œä¸€ä¸ªç®€å•çš„åˆ†äº«æ‰©å±•ï¼Œç„¶è€Œï¼Œé™äºç¯‡å¹…åŸå› ï¼Œè¿™ä¸ªåˆ†äº«æ“ä½œæ­¢äºç”¨æˆ·ç‚¹ä¸‹ â€œPostâ€ çš„é‚£ä¸€åˆ»äº†ã€‚&lt;br&gt;
æ¥ä¸‹æ¥ï¼Œå°±è®©æˆ‘ä»¬ä¸€èµ·çœ‹çœ‹æ€ä¹ˆæŠŠç”¨æˆ·åˆ†äº«çš„æ•°æ®ç»™åˆ°è½½ä½“åº”ç”¨ï¼Œè®©è¿™æ¬¡åˆ†äº«æºœå¾—é£èµ·ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="ios" scheme="http://davidleee.com/tags/ios/"/>
    
      <category term="App Groups" scheme="http://davidleee.com/tags/App-Groups/"/>
    
      <category term="Extension" scheme="http://davidleee.com/tags/Extension/"/>
    
      <category term="UserDefaults" scheme="http://davidleee.com/tags/UserDefaults/"/>
    
      <category term="FileManager" scheme="http://davidleee.com/tags/FileManager/"/>
    
      <category term="CoreData" scheme="http://davidleee.com/tags/CoreData/"/>
    
  </entry>
  
  <entry>
    <title>åˆä¸€ç¯‡ iOS Extension å…¥é—¨ï¼ˆ1/3ï¼‰â€” åŸºç¡€ &amp; åˆ†äº«æ‰©å±•</title>
    <link href="http://davidleee.com/2018/11/14/yet-another-ios-extension-article/"/>
    <id>http://davidleee.com/2018/11/14/yet-another-ios-extension-article/</id>
    <published>2018-11-14T08:00:50.000Z</published>
    <updated>2020-05-05T03:43:31.446Z</updated>
    
    <content type="html"><![CDATA[<p>åº”ç”¨æ‰©å±•ï¼ˆApp Extensionï¼‰è®©ä½ åº”ç”¨çš„åŠŸèƒ½å’Œå†…å®¹éƒ½å¾—åˆ°äº†æ›´å¤§çš„å»¶ä¼¸ï¼Œè¿™è®©ç”¨æˆ·åœ¨ä½¿ç”¨å…¶ä»–åº”ç”¨çš„æ—¶å€™æœ‰æœºä¼šä¸ä½ çš„åº”ç”¨å‘ç”Ÿäº¤äº’ã€‚åœ¨è¿™ä¸ªå¤§å®¶éƒ½æåŠ›äº‰å¤ºæ³¨æ„åŠ›çš„æ—¶ä»£ï¼Œåº”ç”¨æ‰©å±•æ— ç–‘ä¸ºæˆ‘ä»¬æ‰“å¼€äº†ä¸€æ‰‡æ–°çš„å¤§é—¨ã€‚</p><a id="more"></a><h2 id="ä»€ä¹ˆæ˜¯åº”ç”¨æ‰©å±•ï¼Ÿ">ä»€ä¹ˆæ˜¯åº”ç”¨æ‰©å±•ï¼Ÿ</h2><p>åº”ç”¨æ‰©å±•ä¸åº”ç”¨æœ¬èº«æ˜¯æœ‰ä¸åŒçš„ã€‚å°½ç®¡åœ¨ä¸Šæ¶åº”ç”¨æ‰©å±•çš„æ—¶å€™ï¼Œä½ å¿…é¡»ä»¥ä¸€ä¸ªæ™®é€šçš„åº”ç”¨ä¸ºè½½ä½“ï¼ˆContaining Appï¼‰ï¼Œä½†æ˜¯å®ƒå®é™…ä¸Šæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œè€Œä¸”å¹¶ä¸ä¾èµ–äºè½½ä½“åº”ç”¨æ¥è¿è¡Œã€‚</p><p>å…·ä½“æ¥è¯´ï¼Œåº”ç”¨æ‰©å±•åˆ†ä¸ºäº†åå¤šä¸ªç±»åˆ«ï¼Œä½ å¯ä»¥é€šè¿‡å®ƒä»¬æ¥å®ç°å„ç§å„æ ·çš„åŠŸèƒ½ã€‚ä¸‹é¢æ˜¯å®˜æ–¹æ–‡æ¡£é‡Œä»‹ç»æ‰©å±•ç‚¹ï¼ˆExtension Pointï¼‰çš„è¡¨æ ¼ï¼Œæˆ‘è°ƒæ•´äº†ä¸€ä¸‹æ ¼å¼ï¼š<br><img src="/uploads/yet-another-ios-extension-article/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-11-13%20%E4%B8%8B%E5%8D%8812.05.50.png" alt></p><p>æˆ‘ä»¬åˆ›å»ºçš„æ¯ä¸€ä¸ªåº”ç”¨æ‰©å±•éƒ½å¿…é¡»ä¸ä¸Šè¡¨çš„å…¶ä¸­ä¸€ä¸ªæ‰©å±•ç‚¹ç›¸å¯¹åº”ï¼Œä¸å…è®¸å‡ºç°ä¸€ä¸ªåº”ç”¨æ‰©å±•å¯¹åº”å¤šä¸ªæ‰©å±•ç‚¹çš„æƒ…å†µã€‚æ¢å¥è¯è¯´ï¼Œæ¯ä¸ªåº”ç”¨æ‰©å±•çš„èŒè´£éƒ½åº”è¯¥æ˜¯å•ä¸€çš„ï¼Œæˆ‘ä»¬åº”è¯¥ç»™ç”¨æˆ·æä¾›å¿«é€Ÿã€çº¿æ€§ã€èšç„¦çš„ä½“éªŒã€‚</p><h2 id="åº”ç”¨æ‰©å±•æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ">åº”ç”¨æ‰©å±•æ˜¯æ€ä¹ˆå·¥ä½œçš„ï¼Ÿ</h2><h3 id="ç”Ÿå‘½å‘¨æœŸ">ç”Ÿå‘½å‘¨æœŸ</h3><p>åº”ç”¨æ‰©å±•çš„ç”Ÿå‘½å‘¨æœŸæœ‰åˆ«äºä¸€èˆ¬çš„åº”ç”¨ã€‚åº”ç”¨æ‰©å±•é€šå¸¸ä¼šåœ¨å¦ä¸€ä¸ªåº”ç”¨çš„ä½¿ç”¨è¿‡ç¨‹ä¸­è¢«å”¤èµ·ï¼Œè¿™ä¸ªåº”ç”¨è¢«ç§°ä¸ºå®¿ä¸»åº”ç”¨ï¼ˆHost Appï¼‰ï¼Œå®¿ä¸»åº”ç”¨å®šä¹‰äº†ä¸åº”ç”¨æ‰©å±•äº¤æµçš„ä¸Šä¸‹æ–‡ï¼Œå¹¶é€šè¿‡å‘é€è¯·æ±‚çš„æ–¹å¼æŠŠåº”ç”¨æ‰©å±•ç»™å¯åŠ¨èµ·æ¥ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œåº”ç”¨æ‰©å±•åœ¨å®Œæˆå®¿ä¸»åº”ç”¨è¯·æ±‚çš„ä»»åŠ¡ä¹‹åï¼Œç”Ÿå‘½å‘¨æœŸå°±ç»“æŸäº†ã€‚<br><img src="/uploads/yet-another-ios-extension-article/app_extensions_lifecycle_2x.png" alt></p><blockquote><p>æ³¨æ„åŒºåˆ†â€œè½½ä½“åº”ç”¨â€å’Œâ€œå®¿ä¸»åº”ç”¨â€ã€‚è½½ä½“åº”ç”¨æ˜¯è¿™ä¸ªåº”ç”¨æ‰©å±•çš„å®¹å™¨ï¼Œåœ¨æˆ‘ä»¬å®ç°åº”ç”¨æ‰©å±•çš„æ—¶å€™ä¸€å¹¶å¼€å‘å‡ºæ¥çš„ï¼›â€œå®¿ä¸»åº”ç”¨â€æŒ‡çš„æ˜¯å®é™…ä½¿ç”¨è¿‡ç¨‹ä¸­è°ƒèµ·æˆ‘ä»¬çš„åº”ç”¨æ‰©å±•çš„é‚£ä¸ªåº”ç”¨ã€‚</p></blockquote><p>åœ¨ä¸Šå›¾ç¬¬2æ­¥é‡Œï¼Œç³»ç»Ÿåœ¨å¯åŠ¨äº†æˆ‘ä»¬çš„åº”ç”¨æ‰©å±•ä¹‹åï¼Œä¼šåœ¨åº”ç”¨æ‰©å±•å’Œå®¿ä¸»åº”ç”¨ä¹‹é—´å»ºç«‹ä¸€æ¡é€šä¿¡é€šé“ï¼Œç”¨äºä¼ é€’å®¿ä¸»åº”ç”¨å®šä¹‰å¥½çš„ä¸Šä¸‹æ–‡å’Œç›¸å…³ä¿¡æ¯ã€‚</p><p>åº”ç”¨æ‰©å±•æ ¹æ®å®¿ä¸»åº”ç”¨å‘æ¥çš„è¯·æ±‚ï¼Œæ‰§è¡Œç›¸åº”çš„ä»»åŠ¡ï¼Œè¿™äº›ä»»åŠ¡å¯èƒ½æ˜¯ç«‹å³è¿”å›çš„ï¼Œä¹Ÿå¯èƒ½é€šè¿‡ä¸€ä¸ªåå°è¿›ç¨‹å»å®Œæˆã€‚ä½†æ— è®ºæ˜¯å“ªç§æ–¹å¼ï¼Œåœ¨åº”ç”¨æ‰©å±•è·‘å®Œè‡ªå·±çš„ä»£ç é€»è¾‘ä¹‹åï¼Œç³»ç»Ÿå°±ä¼šç«‹é©¬æŠŠå®ƒç»“æŸæ‰ã€‚</p><h3 id="é€šä¿¡">é€šä¿¡</h3><p>ä¸Šé¢æåˆ°åº”ç”¨æ‰©å±•å’Œå®¿ä¸»åº”ç”¨ä¹‹é—´çš„é€šä¿¡æ–¹å¼ï¼Œä¸€ä¸ªå®Œæ•´çš„é€šä¿¡å…³ç³»æ˜¯è¿™æ ·çš„ï¼š<br><img src="/uploads/yet-another-ios-extension-article/simple_communication_2x.png" alt></p><p>åº”ç”¨æ‰©å±•ä¸ä¼šç›´æ¥è·Ÿè½½ä½“åº”ç”¨æ‰“äº¤é“ï¼Œå› ä¸ºå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œåº”ç”¨æ‰©å±•åœ¨å·¥ä½œçš„æ—¶å€™ï¼Œè½½ä½“åº”ç”¨ç”šè‡³éƒ½è¿˜æ²¡æœ‰è¢«å¯åŠ¨ã€‚</p><p>åœ¨ç‰¹æ®Šæƒ…å†µä¸‹ï¼Œæ¯”å¦‚ Today å°ç»„ä»¶ï¼Œæ‰©å±•å¯ä»¥å‘ç³»ç»Ÿæå‡ºå¯åŠ¨è½½ä½“åº”ç”¨çš„ç”³è¯·ï¼ˆé€šè¿‡è°ƒç”¨ <code>NSExtensionContext</code> çš„ <code>openURL:completionHandler:</code> æ–¹æ³•ï¼‰ã€‚è¿™æ—¶ï¼Œåº”ç”¨æ‰©å±•ä¸è½½ä½“åº”ç”¨å°±å¯ä»¥é€šè¿‡ä¸€ä¸ªç§æœ‰çš„å…±äº«å®¹å™¨æ¥ä¼ é€’æ•°æ®äº†ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š<br><img src="/uploads/yet-another-ios-extension-article/detailed_communication_2x.png" alt></p><blockquote><p>ä»ç³»ç»Ÿå±‚é¢ä¸Šçœ‹ï¼Œè¿™å·²ç»æ¶‰åŠåˆ°è¿›ç¨‹é—´é€šä¿¡äº†ï¼Œä½†è‹¹æœæä¾›çš„é«˜çº§ API å¾ˆå¥½åœ°å±è”½äº†è¿™ä¸€ç‚¹ï¼Œæ‰€ä»¥æˆ‘ä»¬å®Œå…¨ä¸ç”¨è€ƒè™‘è¿™äº›äº‹æƒ…ã€‚</p></blockquote><h3 id="åº”ç”¨æ‰©å±•çš„-ç¦å¿Œ">åº”ç”¨æ‰©å±•çš„â€œç¦å¿Œâ€</h3><p>å› ä¸ºåº”ç”¨æ‰©å±•ä¸ä¸€èˆ¬åº”ç”¨çš„è®¾è®¡æ˜¯ä¸åŒçš„ï¼Œæ‰€ä»¥è™½ç„¶å¼€å‘èµ·æ¥å·®ä¸å¤šï¼Œä½†æœ‰äº› API æ˜¯åº”ç”¨æ‰©å±•æ— æ³•ä½¿ç”¨çš„ï¼š</p><ul><li>ä¸èƒ½è®¿é—® <code>sharedApplication</code></li><li>ä¸èƒ½ä½¿ç”¨å¤´æ–‡ä»¶é‡Œå®å®šä¹‰äº† <code>NS_EXTENSION_UNAVAILABLE</code> çš„æ¡†æ¶ï¼Œæ¯”å¦‚ HealthKit å’Œ EventKit UI æ¡†æ¶</li><li>ä¸èƒ½è®¿é—®æ‘„åƒå¤´å’Œéº¦å…‹é£ï¼Œé™¤éå®ƒæ˜¯ iMessage åº”ç”¨</li><li>ä¸èƒ½æ‰§è¡Œè€—æ—¶è¿‡é•¿çš„ä»»åŠ¡ï¼Œå…·ä½“é™åˆ¶ä¸å¹³å°ç›¸å…³ï¼Œä½†æ˜¯å®ƒå¯ä»¥é€šè¿‡ <code>NSURLSession</code> å¯¹è±¡æ¥å®ç°æ•°æ®ä¸Šä¼ å’Œä¸‹è½½ï¼Œæœ€ç»ˆçš„ç»“æœä¼šç»™åˆ°è½½ä½“åº”ç”¨</li><li>ä¸èƒ½æ¥æ”¶ AirDrop æ•°æ®ï¼Œä½†æ˜¯å®ƒå¯ä»¥å‘é€</li></ul><h2 id="åˆ›å»ºåº”ç”¨æ‰©å±•">åˆ›å»ºåº”ç”¨æ‰©å±•</h2><p>å› ä¸ºæ¯ä¸€ä¸ªæ‰©å±•ç‚¹éƒ½å¯¹åº”äº†ä¸€ä¸ªç‰¹å®šçš„åº”ç”¨åœºæ™¯ï¼Œæ‰€ä»¥åˆ›å»ºåº”ç”¨æ‰©å±•çš„ç¬¬ä¸€æ­¥æ˜¯é€‰æ‹©æ­£ç¡®çš„æ‰©å±•ç‚¹ï¼ˆå¯ä»¥å›åˆ°æ–‡ç« å¼€å¤´éƒ¨åˆ†æŸ¥çœ‹æ‰©å±•ç‚¹è¡¨æ ¼ï¼‰ã€‚</p><p>åœ¨ File -&gt; New -&gt; Target é‡Œé¢ï¼Œæ‰¾åˆ° Application Extension æ¨¡å—ï¼Œåœ¨é‡Œé¢é€‰æ‹©æƒ³è¦å®ç°çš„æ‰©å±•ç‚¹ã€‚è¿™é‡Œæˆ‘é€‰äº†åˆ†äº«æ‰©å±•ä½œä¸ºä¾‹å­ï¼š<br><img src="/uploads/yet-another-ios-extension-article/7AA6705E-C543-4011-A638-E171E66F8E54.png" alt></p><p>ç»™ä½ çš„åº”ç”¨æ‰©å±•èµ·ä¸ªç¾ç¾çš„åå­—ä¹‹åï¼Œå®ƒå°±ä¼šå‡ºç°åœ¨é¡¹ç›®é…ç½®çš„ä¾§è¾¹æ é‡Œäº†ï¼ŒåŒæ—¶ï¼ŒXcode è¿˜ä¸ºæˆ‘ä»¬æ–°å»ºçš„åº”ç”¨æ‰©å±•æ·»åŠ äº†ä¸€ä¸ª Schemeï¼Œè®©æˆ‘ä»¬å¯ä»¥ç›´æ¥è°ƒå¼æ‰©å±•è€Œä¸ç”¨å¯åŠ¨è½½ä½“åº”ç”¨ï¼š<br><img src="/uploads/yet-another-ios-extension-article/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-11-13%20%E4%B8%8B%E5%8D%885.45.59.png" alt></p><p>ç›´æ¥è¿è¡Œåº”ç”¨æ‰©å±•ï¼ŒXcode ä¼šè®©ä½ é€‰ä¸€ä¸ªåº”ç”¨æ¥ä½œä¸ºåº”ç”¨æ‰©å±•çš„å®¿ä¸»ï¼š<br><img src="/uploads/yet-another-ios-extension-article/A1A7864C-EA2B-4823-A33D-91656F91569A.png" alt></p><p>åˆ†äº«æ‰©å±•çš„å…¼å®¹æ€§å¾ˆå¥½ï¼Œæˆ‘ä»¬é€‰ Safari æ¥å°è¯•åˆ†äº«ä¸€ä¸ªç½‘é¡µå¥½äº†ï¼š<br><img src="/uploads/yet-another-ios-extension-article/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-11-13%20%E4%B8%8B%E5%8D%885.48.58.png" alt><br>éšä¾¿æ‰“å¼€ä¸€ä¸ªç½‘é¡µï¼Œç‚¹å‡»ä¸‹é¢çš„åˆ†äº«æŒ‰é’®ï¼Œå¯ä»¥çœ‹åˆ°æˆ‘ä»¬çš„åº”ç”¨æ‰©å±•å·²ç»å‡ºç°åœ¨åˆ†äº«åˆ—è¡¨é‡Œé¢äº†ï¼</p><blockquote><p>åº”ç”¨æ‰©å±•çš„å›¾æ ‡ä¼šè·Ÿè½½ä½“åº”ç”¨çš„å›¾æ ‡ä¸€è‡´</p></blockquote><h2 id="talk-is-cheap">Talk is Cheap!</h2><p>åˆ›å»ºäº†åº”ç”¨æ‰©å±•ä¹‹åï¼Œä¼šå‘ç°é¡¹ç›®ç»“æ„é‡Œå¤šäº†ä¸€ä¸ªå±äºåº”ç”¨æ‰©å±•çš„ä½ç½®ï¼š<br><img src="/uploads/yet-another-ios-extension-article/65CB2068-CB5B-4443-A46B-3D8DC3DD5F30.png" alt></p><p>çœ‹èµ·æ¥å°±åƒä¸€ä¸ªæ™®é€šçš„åº”ç”¨é¡¹ç›®çš„ç»“æ„ï¼Œä½† <em>Info.plist</em> é‡Œæœ‰ä¸€ä¸ªä¸åŒç‚¹ï¼Œå°±æ˜¯è¿™é‡Œçš„ <code>NSExtension</code> å­—å…¸ï¼š<br><img src="/uploads/yet-another-ios-extension-article/125ED1F7-CCA8-4D23-9218-5D8212E2D5D8.png" alt><br>çœ‹åå­—éƒ½æŒºå¥½æ‡‚çš„ï¼Œå…¶ä¸­çš„ <code>NSExtensionAttributes</code> ç”¨æ¥é…ç½®ä¸€äº›é€šç”¨å‚æ•°ï¼Œæ¯”å¦‚æ”¯æŒçš„åª’ä½“ç±»å‹ç­‰ç­‰ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œ<code>NSExtensionActivationRule</code> æ˜¯ä¸€ä¸ª <code>String</code> ç±»å‹ï¼Œè¿™ä¸ªå€¼å°±æ˜¯è®©ç³»ç»Ÿåœ¨æ‰€æœ‰åˆ†äº«åœºæ™¯é‡Œéƒ½æ˜¾ç¤ºæˆ‘ä»¬çš„åº”ç”¨æ‰©å±•ï¼ˆæˆ‘å…¨éƒ½è¦ï¼ï¼‰ã€‚æ›´çœŸå®çš„åœºæ™¯åº”è¯¥æ˜¯åªæ”¯æŒç‰¹å®šçš„æ–‡ä»¶ç±»å‹ï¼Œè¿™æ—¶å¯ä»¥æŠŠå®ƒæ”¹æˆ <code>Dictionary</code> ç±»å‹ï¼š<br><img src="/uploads/yet-another-ios-extension-article/D7E348AB-33CD-4DC6-9F54-2005AE2BA66E.png" alt></p><p>ä¸Šå›¾çš„è®¾ç½®è¡¨ç¤ºï¼šæˆ‘ä»¬æ”¯æŒåˆ†äº«å›¾ç‰‡ã€è§†é¢‘ã€æ–‡ä»¶å’Œç½‘é¡µé“¾æ¥ï¼Œåé¢çš„æ•°å­—è¡¨ç¤ºï¼šä¸€æ¬¡åˆ†äº«ä¸­æ”¯æŒå¸¦ä¸Šå¤šå°‘ä¸ªè¿™ç§ç±»å‹çš„é™„ä»¶ã€‚</p><blockquote><p>é™¤å›¾ç‰‡å’Œè§†é¢‘å¤–çš„æ–‡ä»¶ç±»å‹ï¼Œéƒ½åŒ…æ‹¬åœ¨ File çš„èŒƒå›´é‡Œé¢ï¼Œæ‰€ä»¥ä¸Šé¢çš„é…ç½®å‡ ä¹æ¶µç›–äº†æ‰€æœ‰çš„æ–‡ä»¶åˆ†äº«åœºæ™¯äº†</p></blockquote><h3 id="å“åº”è¯·æ±‚">å“åº”è¯·æ±‚</h3><p>åœ¨ Xcode åˆ›å»ºå¥½çš„ <code>ShareViewController</code> é‡Œï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>extensionContext</code> æ¥æ‹¿åˆ°å®¿ä¸»åº”ç”¨æƒ³è¦ä¼ è¾¾ç»™æˆ‘ä»¬çš„ä¿¡æ¯ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> items = <span class="keyword">self</span>.extensionContext?.inputItems</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ª <a href="https://developer.apple.com/documentation/foundation/nsextensionitem" target="_blank" rel="noopener">NSExtensionItem</a> æ•°ç»„ï¼Œæ¯ä¸€ä¸ª <code>NSExtensionItem</code> éƒ½å¸¦æœ‰ä¸€ç³»åˆ—å±æ€§ï¼Œä¾‹å¦‚æ ‡é¢˜ã€å†…å®¹ã€é™„ä»¶ã€ç”¨æˆ·ä¿¡æ¯ã€‚</p><p>ç³»ç»Ÿä¼šå›è°ƒ <code>didSelectPost</code> æˆ– <code>didSelectCancel</code> ä»¥é€šçŸ¥æˆ‘ä»¬ç”¨æˆ·æ“ä½œçš„ç»“æœï¼Œåœ¨è¿™ä¸¤ä¸ªå›è°ƒæ–¹æ³•é‡Œï¼Œæˆ‘ä»¬éœ€è¦è°ƒç”¨ <code>completeRequest(returningItems:completionHandler:)</code> è¿”å›ä¸€ç³»åˆ— <code>NSExtensionItem</code> å¯¹è±¡ç»™å®¿ä¸»åº”ç”¨ï¼Œæˆ–è€…è°ƒç”¨ <code>cancelRequest(withError:)</code> è¿”å›ä¸€ä¸ªé”™è¯¯ã€‚</p><h3 id="è·å–é™„ä»¶">è·å–é™„ä»¶</h3><p>ä» <code>NSExtensionItems</code> é‡Œèƒ½ç›´æ¥è·å–åˆ°çš„ä¿¡æ¯æ˜¯è¿œè¿œä¸å¤Ÿçš„ï¼ŒçœŸæ­£çš„å¤§éƒ¨å¤´éƒ½åœ¨ <code>attachments</code> è¿™ä¸ªå±æ€§é‡Œã€‚è¿™æ˜¯ä¸€ä¸ª <a href="https://developer.apple.com/documentation/foundation/nsitemprovider" target="_blank" rel="noopener">NSItemProvider</a> ç±»å‹çš„æ•°ç»„ï¼Œè‡ªæ­¤æˆ‘ä»¬å°±åŸºæœ¬çœ‹åˆ°äº†æ•´ä¸ª <code>NSExtensionContext</code> çš„æ„æˆäº†ï¼Œå€Ÿç”¨ä¸€å¼ å…¶ä»–åšå®¢çš„å›¾ç‰‡ï¼š<br><img src="/uploads/yet-another-ios-extension-article/221150_8LYD_222120.png" alt></p><p>å¥½ï¼Œå›åˆ°æ­£é¢˜ã€‚æ‹¿åˆ° <code>NSItemProvider</code> ä¹‹åï¼Œä¼šå‘ç°è¦ä»è¿™ä¸ªç±»é‡Œé¢æ‹¿ä¸œè¥¿å¹¶ä¸ç®€å•ã€‚</p><p>ç»§ç»­ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬æ‰“ç®—åœ¨ç”¨æˆ·ç‚¹å‡» â€œPostâ€ æŒ‰é’®ä¹‹åï¼Œè·å–ä» Safari åˆ†äº«è¿‡æ¥çš„ URLï¼Œå®Œæ•´çš„ä»£ç æ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">didSelectPost</span><span class="params">()</span></span> &#123;</span><br><span class="line">    <span class="comment">// This is called after the user selects Post. Do the upload of contentText and/or NSExtensionContext attachments.</span></span><br><span class="line">    <span class="comment">// 1</span></span><br><span class="line">    <span class="keyword">guard</span> <span class="keyword">let</span> items = extensionContext?.inputItems <span class="keyword">as</span>? [<span class="type">NSExtensionItem</span>] <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 2</span></span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> items &#123;</span><br><span class="line">        <span class="keyword">for</span> attachment <span class="keyword">in</span> item.attachments ?? [] &#123;</span><br><span class="line">            <span class="comment">// 3</span></span><br><span class="line">            <span class="keyword">if</span> attachment.hasItemConformingToTypeIdentifier(kUTTypeURL <span class="keyword">as</span> <span class="type">String</span>) &#123;</span><br><span class="line">                <span class="comment">// 4</span></span><br><span class="line">                attachment.loadItem(forTypeIdentifier: kUTTypeURL <span class="keyword">as</span> <span class="type">String</span>, options: <span class="literal">nil</span>) &#123; (item, error) <span class="keyword">in</span></span><br><span class="line">                                                                                            <span class="keyword">if</span> error == <span class="literal">nil</span> &#123;</span><br><span class="line">                                                                                                <span class="built_in">print</span>(<span class="string">"found an url: \(item)"</span>)</span><br><span class="line">                                                                                            &#125;</span><br><span class="line">                                                                                           &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Inform the host that we're done, so it un-blocks its UI. Note: Alternatively you could call super's -didSelectPost, which will similarly complete the extension context.</span></span><br><span class="line">    <span class="keyword">self</span>.extensionContext!.completeRequest(returningItems: [], completionHandler: <span class="literal">nil</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol><li><code>inputItems</code> æ˜¯ä¸€ä¸ª <code>[Any]</code> ç±»å‹çš„æ•°ç»„ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨ä¹‹å‰éœ€è¦è½¬æ¢ä¸€ä¸‹</li><li>å¦‚æœå…è®¸ç”¨æˆ·åˆ†äº«çš„æ—¶å€™å¤šé€‰çš„è¯ï¼Œéœ€è¦é€å±‚éå† <code>items</code> å’Œ <code>attachments</code></li><li>åˆ¤æ–­é™„ä»¶çš„ç±»å‹ï¼Œé™„ä»¶ç±»å‹ä½¿ç”¨ <a href="https://developer.apple.com/library/archive/documentation/Miscellaneous/Reference/UTIRef/Articles/System-DeclaredUniformTypeIdentifiers.html#//apple_ref/doc/uid/TP40009259-SW1" target="_blank" rel="noopener">UTIï¼ˆUniform Type Identifierï¼‰</a> æ¥è¡¨ç¤ºï¼Œåœ¨ iOS å¹³å°ä½¿ç”¨çš„æ—¶å€™éœ€è¦å…ˆæ‰§è¡Œ <code>import MobileCoreService</code></li><li>è¯»å–æŒ‡å®šç±»å‹çš„é™„ä»¶å†…å®¹ï¼Œå›è°ƒè¿‡æ¥çš„ <code>item</code> æ˜¯ <code>NSSecureCoding?</code> ç±»å‹çš„ï¼Œè¿™é‡Œåªç®€å•æ‰“å°äº†ä¸€ä¸‹ï¼ŒçœŸæ­£ä½¿ç”¨çš„æ—¶å€™è¿˜éœ€è¦è¡¥å……ä¸€äº›é¢å¤–å¤„ç†</li></ol><h2 id="æ€§èƒ½è¦æ±‚">æ€§èƒ½è¦æ±‚</h2><p>åº”ç”¨æ‰©å±•å¯¹äºç”¨æˆ·æ¥è¯´åº”è¯¥æ˜¯æ•æ·è€Œä¸”è½»é‡çš„å°å·¥å…·ï¼Œæ‰€ä»¥å®ƒçš„å¯åŠ¨é€Ÿåº¦åŠ¡å¿…è¦ä¿æŒåœ¨1ç§’ä»¥å†…ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å…³é—­å¯åŠ¨è€—æ—¶å¤ªé•¿çš„åº”ç”¨æ‰©å±•ã€‚</p><p>å¯¹äº Widget æ¥è¯´ï¼Œç•Œé¢ä¸Šé€šå¸¸ä¼šä¸€æ¬¡æ˜¾ç¤ºå¤šä¸ªï¼Œæ‰€ä»¥ Widget çš„å†…å­˜ä½¿ç”¨è¦æ±‚æ˜¯æœ€ä¸¥æ ¼çš„ï¼ˆå¤§æ¦‚æ˜¯16 MBï¼‰ï¼Œä¸€æ—¦è¶…å‡ºäº†é™åˆ¶ï¼Œä¼šæ˜¾ç¤º â€œUnable to Loadâ€ çš„å­—æ ·ï¼š<br><img src="/uploads/yet-another-ios-extension-article/TodayWidgetUnableToLoad.jpg" alt></p><p>å…¶ä»–ç±»å‹çš„åº”ç”¨æ‰©å±•å¯¹å†…å­˜çš„è¦æ±‚ä¼šæ¾ä¸€ç‚¹ï¼Œä½†è¿˜æ˜¯æ¯”ä¸€èˆ¬åº”ç”¨è¦ä¸¥æ ¼ï¼Œæ¯”å¦‚è‡ªå®šä¹‰é”®ç›˜è¦æ±‚ 48 MB ä»¥ä¸‹ï¼Œåˆ†äº«æ‰©å±•è¦æ±‚ 120 MB ä»¥ä¸‹ï¼Œå®é™…æƒ…å†µå¯èƒ½è·Ÿè®¾å¤‡ç›¸å…³ã€‚</p><p>å¦å¤–ï¼Œåº”ç”¨æ‰©å±•æ˜¯å…¬ç”¨åŒä¸€ä¸ªä¸»çº¿ç¨‹çš„ï¼Œæ‰€ä»¥ä¸è¦åœ¨åº”ç”¨æ‰©å±•çš„é€»è¾‘é‡Œåšå¯èƒ½ä¼šé˜»å¡ä¸»çº¿ç¨‹çš„æ“ä½œã€‚åŒç†ï¼ŒGPU ä¹Ÿæ˜¯è¿™æ ·ä¸€ä¸ªå…±äº«èµ„æºï¼Œå¦‚æœä¸€ä¸ªåº”ç”¨æ‰©å±•éœ€è¦æ‰§è¡Œå¤§é‡ç»˜å›¾é€»è¾‘ï¼Œç³»ç»Ÿä¼šå€¾å‘äºæŠŠå®ƒç»“æŸæ‰ã€‚</p><p>æ€»è€Œè¨€ä¹‹ï¼Œå¼€é”€å¤§çš„æ“ä½œéƒ½åº”è¯¥åœ¨è½½ä½“åº”ç”¨é‡Œåšï¼Œè€Œä¸æ˜¯è®©åº”ç”¨æ‰©å±•å»è´Ÿè´£ã€‚</p><h2 id="æ€»ç»“ä¸€ä¸‹">æ€»ç»“ä¸€ä¸‹</h2><p>æœ¬æ–‡ä»‹ç»äº†ä»€ä¹ˆæ˜¯åº”ç”¨æ‰©å±•ï¼Œå¹¶ä»‹ç»äº†ä¸€ä¸ªç®€å•çš„åˆ†äº«æ‰©å±•æ˜¯æ€ä¹ˆå®ç°çš„ã€‚æ–‡ç« å¤§ä½“æ˜¯æ¥æºäºå®˜æ–¹çš„æ–‡æ¡£ï¼Œè™½ç„¶æ–‡æ¡£å·²ç»è¢«è‹¹æœå½’æ¡£äº†ï¼Œä½†æ˜¯æ–‡ä¸­çš„ä»£ç éƒ½æ˜¯æˆ‘å†™å®Œç”¨æ¨¡æ‹Ÿå™¨éªŒè¯åå¾—æ¥çš„ï¼ˆ2018å¹´11æœˆ14æ—¥ï¼‰ï¼Œå¤§å®¶å¯ä»¥ç›´æ¥æ‹¿èµ°æŒ‰éœ€æœç”¨ :)</p><blockquote><p>æ²¡æƒ³åˆ°åªæ˜¯ä»‹ç»äº†ä¸€äº›åŸºç¡€å°±å†™äº†è¿™ä¹ˆå¤šã€‚å…¶å®æˆ‘è¿˜æ‰“ç®—è®²è®²åˆ†äº«ä¹‹åæ€ä¹ˆè·Ÿè½½ä½“åº”ç”¨äº¤äº’ï¼Œè¿˜æƒ³è¦çœ‹çœ‹ä»Šæ—¥å°ç»„ä»¶ï¼ˆToday Widgetï¼‰æ€ä¹ˆæ•´â€¦åªå¥½æ”¾åˆ°åé¢çš„æ–‡ç« é‡Œå»äº†ã€‚  æˆ‘å‘èª“åœ¨è¿™å‘¨ä¹‹å†…æŠŠè¿™ä¸¤éƒ¨åˆ†å†…å®¹éƒ½ç»™è¡¥ä¸Šæ¥ï¼</p><p>ä½ ä»¬çœ‹ï¼Œæˆ‘å†™å®Œäº†ï¼š</p><ul><li><a href="/2018/11/14/yet-another-ios-extension-article-2/" title="åˆä¸€ç¯‡ iOS Extension å…¥é—¨ï¼ˆ2/3ï¼‰â€” ä¸å®¹å™¨æ²Ÿé€š">åˆä¸€ç¯‡ iOS Extension å…¥é—¨ï¼ˆ2/3ï¼‰â€” ä¸å®¹å™¨æ²Ÿé€š</a></li><li><a href="/2018/11/15/yet-another-ios-extension-article-3/" title="åˆä¸€ç¯‡ iOS Extension å…¥é—¨ï¼ˆ3/3ï¼‰â€” Today å°ç»„ä»¶">åˆä¸€ç¯‡ iOS Extension å…¥é—¨ï¼ˆ3/3ï¼‰â€” Today å°ç»„ä»¶</a></li></ul></blockquote><h2 id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </h2><ul><li><a href="https://developer.apple.com/library/archive/documentation/General/Conceptual/ExtensibilityPG/index.html#//apple_ref/doc/uid/TP40014214-CH20-SW1" target="_blank" rel="noopener">App Extension Programming Guide: App Extensions Increase Your Impact</a></li><li><a href="https://developer.apple.com/library/archive/documentation/General/Conceptual/ExtensibilityPG/Share.html#//apple_ref/doc/uid/TP40014214-CH12-SW1" target="_blank" rel="noopener">App Extension Programming Guide: Share</a></li><li><a href="https://my.oschina.net/vimfung/blog/707448" target="_blank" rel="noopener">iOSæ‰©å±•å¼€å‘æ”»ç•¥(ä¸€) - Share Extension - vimfungçš„å¼€æºéƒ¨è½ - å¼€æºä¸­å›½</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åº”ç”¨æ‰©å±•ï¼ˆApp Extensionï¼‰è®©ä½ åº”ç”¨çš„åŠŸèƒ½å’Œå†…å®¹éƒ½å¾—åˆ°äº†æ›´å¤§çš„å»¶ä¼¸ï¼Œè¿™è®©ç”¨æˆ·åœ¨ä½¿ç”¨å…¶ä»–åº”ç”¨çš„æ—¶å€™æœ‰æœºä¼šä¸ä½ çš„åº”ç”¨å‘ç”Ÿäº¤äº’ã€‚åœ¨è¿™ä¸ªå¤§å®¶éƒ½æåŠ›äº‰å¤ºæ³¨æ„åŠ›çš„æ—¶ä»£ï¼Œåº”ç”¨æ‰©å±•æ— ç–‘ä¸ºæˆ‘ä»¬æ‰“å¼€äº†ä¸€æ‰‡æ–°çš„å¤§é—¨ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="ios" scheme="http://davidleee.com/tags/ios/"/>
    
      <category term="App Groups" scheme="http://davidleee.com/tags/App-Groups/"/>
    
      <category term="Extension" scheme="http://davidleee.com/tags/Extension/"/>
    
      <category term="Share" scheme="http://davidleee.com/tags/Share/"/>
    
      <category term="NSExtensionItem" scheme="http://davidleee.com/tags/NSExtensionItem/"/>
    
      <category term="NSItemProvider" scheme="http://davidleee.com/tags/NSItemProvider/"/>
    
  </entry>
  
  <entry>
    <title>æ€ä¹ˆåœ¨å‘½ä»¤è¡Œç»™ macOS è®¾ç½®å¼€æœºå¯åŠ¨ä»»åŠ¡</title>
    <link href="http://davidleee.com/2018/11/07/login-items-for-macos/"/>
    <id>http://davidleee.com/2018/11/07/login-items-for-macos/</id>
    <published>2018-11-07T08:16:12.000Z</published>
    <updated>2020-05-05T03:43:31.443Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘é€šè¿‡ docker + nginx åœ¨ ä¸€å° Mac mini ä¸Šé¢é…äº†ä¸ªç®€æ˜“æ–‡ä»¶ç³»ç»Ÿï¼Œå¥½è®©å…¶ä»–äººèƒ½æ–¹ä¾¿åœ°ä¸‹è½½ä¸€äº›é¢„å…ˆå†™å¥½çš„é…ç½®æ–‡ä»¶ï¼Œè¿™éƒ¨åˆ†å°±ä¸ç»†è¯´äº†ã€‚æ–‡ä»¶ç³»ç»Ÿè·‘èµ·æ¥ä¹‹åï¼Œè€ƒè™‘åˆ°ä¾¿åˆ©æ€§ï¼Œæƒ³è¦å†æ·»åŠ ä¸€ä¸ªå¼€æœºè‡ªå¯åŠ¨çš„é€»è¾‘ï¼Œè®©è¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿåœ¨ç”µè„‘é‡å¯ä¹‹åä¹Ÿèƒ½è‡ªå·±è·‘èµ·æ¥ã€‚</p><p>åœ¨ Linux ç³»ç»Ÿä¸‹é¢ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ <code>systemctl</code>  æˆ–è€…ç›´æ¥ä¿®æ”¹ <em>rc.local</em> æ–‡ä»¶<br>æ¥å®ç°å¯åŠ¨é¡¹çš„æ·»åŠ ã€‚ä½†æ˜¯è¿™ä¸€å¥—åœ¨ macOS ä¸Šé¢ç©ä¸è½¬äº†ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦é€šè¿‡ä¸€ä¸ªå®Œå…¨ä¸ä¸€æ ·çš„æœºåˆ¶â€”â€” <strong>Launch Daemon</strong> æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚</p><a id="more"></a><h2 id="è¦åšçš„äº‹æƒ…">è¦åšçš„äº‹æƒ…</h2><p>å› ä¸º macOS çš„å¯åŠ¨é¡¹æ˜¯é€šè¿‡ä¸€ä¸ª plist å»é…ç½®çš„ï¼Œé…ç½®ä¸€ä¸ªè„šæœ¬è¿œæ¯”é…ç½®ä¸€æ®µè¦æ‰§è¡Œçš„å‘½ä»¤è¡ŒæŒ‡ä»¤è¦ç®€å•ï¼Œæ‰€ä»¥è¿™é‡Œé‡‡ç”¨è„šæœ¬çš„æ–¹å¼å»å®ç°ã€‚</p><p>äºæ˜¯æˆ‘ä»¬è¦åšçš„äº‹æƒ…åªæœ‰ä¸¤æ­¥ï¼š</p><ol><li>åˆ›å»ºä¸€ä¸ªè„šæœ¬æ–‡ä»¶å»æ‰§è¡Œ docker-compose çš„å¯åŠ¨æŒ‡ä»¤</li><li>è®©è¿™ä¸ªè„šæœ¬åœ¨ç³»ç»Ÿå¯åŠ¨çš„æ—¶å€™æ‰§è¡Œï¼ˆä¸éœ€è¦ç”¨æˆ·ç™»å½•ï¼‰</li></ol><h2 id="å¼€å§‹å§">å¼€å§‹å§</h2><h3 id="åˆ›å»ºè„šæœ¬">åˆ›å»ºè„šæœ¬</h3><p>å…ˆåˆ›å»ºä¸€ä¸ªè„šæœ¬æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vim startup.sh</span><br></pre></td></tr></table></figure><p>ä¸è€ƒè™‘å¼‚å¸¸æƒ…å†µï¼Œå°±æ˜¯ç®€å•åœ°è¿›åˆ° docker-compose.yaml æ‰€åœ¨çš„ç›®å½•ï¼Œç„¶åæ‰§è¡Œä¸€ä¸‹å¯åŠ¨å‘½ä»¤ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">cd /Users/davidleee/Desktop/docker-nginx</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> make sure it runs</span></span><br><span class="line">while [ $(docker inspect -f '&#123;&#123;.State.Running&#125;&#125;' docker-nginx_nginx_1) != "true" ]</span><br><span class="line">do</span><br><span class="line">  echo "Launching file-service with docker-compose..."</span><br><span class="line">  docker-compose up -d</span><br><span class="line">  sleep 2</span><br><span class="line">done</span><br></pre></td></tr></table></figure><blockquote><p>ä¸ºäº†é¿å…æˆ‘ä»¬æ‰§è¡Œ <code>docker-compose</code> çš„æ—¶å€™ docker è‡ªå·±è¿˜æ²¡æœ‰è·‘èµ·æ¥ï¼Œæ‰€ä»¥ç”¨ä¸€ä¸ªå¾ªç¯å»æ£€æµ‹æˆ‘ä»¬çš„æœåŠ¡æ˜¯ä¸æ˜¯çœŸçš„å¯åŠ¨äº†ã€‚</p><p>å¦å¤–è¿˜è¦è®°å¾—æŠŠä¸Šé¢çš„ <code>docker-nginx_nginx_1</code> æ”¹æˆä½ çœŸæ­£çš„çš„å®¹å™¨åç§°ã€‚</p></blockquote><p>åˆ«å¿˜äº†ç»™è„šæœ¬åŠ ä¸Šæ‰§è¡Œæƒé™ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x startup.sh</span><br></pre></td></tr></table></figure><h3 id="é…ç½®å¯åŠ¨é¡¹">é…ç½®å¯åŠ¨é¡¹</h3><p>ç°åœ¨æˆ‘ä»¬è¦æŠŠä¸Šé¢çš„è„šæœ¬æ·»åŠ åˆ° <strong>Launch Daemon</strong> é‡Œé¢å»ã€‚</p><p>åœ¨æ­¤ä¹‹å‰ï¼Œè®©æˆ‘ä»¬å…ˆç†æ¸…ä¸€äº›æ¦‚å¿µã€‚</p><p>macOS é€šè¿‡ä¸€ç³»åˆ—çš„ plist æ–‡ä»¶æ¥é…ç½®å¯åŠ¨é¡¹ï¼Œè¿™äº› plist æ ¹æ®å­˜æ”¾ä½ç½®çš„ä¸åŒè€Œåˆ†ä¸º <strong>Launch Daemon</strong> å’Œ <strong>Launch Agent</strong>ã€‚å®ƒä»¬çš„åŒºåˆ«åœ¨äºï¼ŒAgent æ˜¯åœ¨ç”¨æˆ·ç™»å½•ä¹‹åä»¥è¯¥ç”¨æˆ·çš„èº«ä»½å»æ‰§è¡Œçš„ä»»åŠ¡ï¼Œè€Œ Daemon æ˜¯ä»¥æ ¹ç”¨æˆ·æˆ– <code>UserName</code> é‡ŒæŒ‡å®šçš„ç”¨æˆ·å»æ‰§è¡Œçš„ä»»åŠ¡ã€‚</p><p>å®ƒä»¬ä¸€èˆ¬å­˜æ”¾åœ¨è¿™ä¸¤ä¸ªåœ°æ–¹ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/Library/LaunchDaemons</span><br><span class="line"></span><br><span class="line">/Library/LaunchAgents/</span><br></pre></td></tr></table></figure><p>æˆ‘ä»¬è¿™æ¬¡çš„ä»»åŠ¡éœ€è¦ç”¨åˆ° root æƒé™ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†ä¼šåœ¨ LaunchDaemons é‡Œåˆ›å»ºä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim /Library/LaunchDaemons/com.file-service.plist</span><br></pre></td></tr></table></figure><p>ç„¶ååœ¨é‡Œé¢å¡«ä¸Šä»¥ä¸‹å†…å®¹ï¼šï¼ˆæ³¨é‡Šéƒ¨åˆ†å¯ä»¥å»æ‰å’¯ï¼‰</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">plist</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">"-//Apple//DTD PLIST 1.0//EN"</span> <span class="meta-string">" [http://www.apple.com/DTDs/PropertyList-1.0.dtd](http://www.apple.com/DTDs/PropertyList-1.0.dtd) "</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plist</span> <span class="attr">version</span>=<span class="string">"1.0"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Launch Daemon ä¸ä¸€å®šæœ‰æƒé™è®¿é—®æ‰€æœ‰éœ€è¦çš„ç¯å¢ƒå˜é‡</span></span><br><span class="line"><span class="comment">åœ¨æ²¡æœ‰æƒé™çš„æ—¶å€™ï¼Œå¯åŠ¨é¡¹æ‰§è¡Œä¼šå¤±è´¥ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨è¿™é‡Œé…ç½®ä¸€ä¸‹è„šæœ¬éœ€è¦çš„ç¯å¢ƒå˜é‡ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>EnvironmentVariables<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dict</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">key</span>&gt;</span>PATH<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">string</span>&gt;</span>/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>Label<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- ä¹ æƒ¯ä¸Šï¼Œæˆ‘ä»¬ä¼šç”¨ä¸€ä¸ª identifier æ ·å¼çš„åå­—æ¥ä½œä¸ºå¯åŠ¨é¡¹çš„åç§° --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>com.file-service<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>Program<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- è¦æ‰§è¡Œçš„è„šæœ¬çš„ç»å¯¹è·¯å¾„ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>/Users/davidleee/Desktop/docker-nginx/startup.sh<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- è¿™ä¸ª key å‘Šè¯‰ç³»ç»Ÿåœ¨å¯åŠ¨çš„æ—¶å€™æ‰§è¡Œæˆ‘ä»¬çš„è„šæœ¬</span></span><br><span class="line"><span class="comment">  å¯¹äº daemons æ¥è¯´æ˜¯ç³»ç»Ÿå¯åŠ¨ä¹‹åï¼Œå¯¹äº agent æ¥è¯´åˆ™æ˜¯ç”¨æˆ·ç™»å½•ä¹‹å --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>RunAtLoad<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- åˆ¤æ–­æ˜¯æŒ‰éœ€å¯åŠ¨æˆ‘ä»¬çš„å¯åŠ¨é¡¹ï¼Œè¿˜æ˜¯æ°¸è¿œè¿è¡Œä¸‹å»</span></span><br><span class="line"><span class="comment">ç°åœ¨æˆ‘ä»¬è‡ªå·±è·‘çš„æ˜¯è‡ªå·±çš„è„šæœ¬ï¼ŒæŒ‰éœ€å¯åŠ¨å°±å¯ä»¥äº† --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>KeepAlive<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">false</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>LaunchOnlyOnce<span class="tag">&lt;/<span class="name">key</span>&gt;</span>        </span><br><span class="line">    <span class="tag">&lt;<span class="name">true</span>/&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- åœ¨è°ƒè¯•è„šæœ¬çš„æ—¶å€™å¾ˆå¥½ç”¨ï¼Œå¯ä»¥æŒ‡å®šè„šæœ¬æ­£å¸¸/é”™è¯¯è¾“å‡ºçš„è·¯å¾„ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>StandardOutPath<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>/tmp/startup.stdout<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>StandardErrorPath<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>/tmp/startup.stderr<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">key</span>&gt;</span>UserName<span class="tag">&lt;/<span class="name">key</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- æ‰§è¡Œè„šæœ¬çš„ç”¨æˆ· --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">string</span>&gt;</span>davidleee<span class="tag">&lt;/<span class="name">string</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dict</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plist</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æœ€åå°±æ˜¯æŠŠè¿™ä¸ª plist åŠ è½½åˆ° launchctl é‡Œé¢å»äº†ï¼š</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># `-w` ä¼šæŠŠ plist æ°¸ä¹…æ·»åŠ åˆ° Launch Daemon é‡Œé¢</span></span><br><span class="line">sudo launchctl load -w /Library/LaunchDaemons/com.file-service.plist</span><br><span class="line"></span><br><span class="line"><span class="comment"># ...å¦‚æœä½ ä¸æƒ³è®©å®ƒè‡ªå¯åŠ¨äº†</span></span><br><span class="line">sudo launchctl unload -w /Library/LaunchDaemons/com.file-service.plist</span><br></pre></td></tr></table></figure><h2 id="å†™åœ¨æœ€å">å†™åœ¨æœ€å</h2><p>åœ¨æ‰§è¡Œå®Œä¸Šé¢çš„ <code>launchctl load</code> æŒ‡ä»¤ä¹‹åï¼Œplist é‡Œé¢é…ç½®çš„è„šæœ¬ä¼šé©¬ä¸Šè¢«æ‰§è¡Œï¼Œä½ å¯ä»¥é€šè¿‡ <code>launchctl start</code> å’Œ <code>launchctl stop</code> æ¥æ§åˆ¶å®ƒçš„å¼€å…³ï¼Œä¸è¿‡æˆ‘ä»¬è¿™é‡Œåªæ˜¯æ‰§è¡Œäº†ä¸€ä¸ªè„šæœ¬ï¼Œå¹¶ä¸ä¼šåƒå…¶ä»–åº”ç”¨é‚£æ ·é•¿é©»ï¼Œæ‰€ä»¥å…¶å®ä¹Ÿå°±æ²¡æœ‰â€œå¼€å…³â€ä¸€è¯´äº†ã€‚</p><h2 id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </h2><ul><li><a href="https://medium.com/@fahimhossain_16989/adding-startup-scripts-to-launch-daemon-on-mac-os-x-sierra-10-12-6-7e0318c74de1" target="_blank" rel="noopener">Adding Startup Scripts to Launch Daemon on Mac OS X Sierra 10.12.6</a></li><li><a href="https://developer.apple.com/library/archive/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingLaunchdJobs.html" target="_blank" rel="noopener">Creating Launch Daemons and Agents</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘é€šè¿‡ docker + nginx åœ¨ ä¸€å° Mac mini ä¸Šé¢é…äº†ä¸ªç®€æ˜“æ–‡ä»¶ç³»ç»Ÿï¼Œå¥½è®©å…¶ä»–äººèƒ½æ–¹ä¾¿åœ°ä¸‹è½½ä¸€äº›é¢„å…ˆå†™å¥½çš„é…ç½®æ–‡ä»¶ï¼Œè¿™éƒ¨åˆ†å°±ä¸ç»†è¯´äº†ã€‚æ–‡ä»¶ç³»ç»Ÿè·‘èµ·æ¥ä¹‹åï¼Œè€ƒè™‘åˆ°ä¾¿åˆ©æ€§ï¼Œæƒ³è¦å†æ·»åŠ ä¸€ä¸ªå¼€æœºè‡ªå¯åŠ¨çš„é€»è¾‘ï¼Œè®©è¿™ä¸ªæ–‡ä»¶ç³»ç»Ÿåœ¨ç”µè„‘é‡å¯ä¹‹åä¹Ÿèƒ½è‡ªå·±è·‘èµ·æ¥ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ Linux ç³»ç»Ÿä¸‹é¢ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ &lt;code&gt;systemctl&lt;/code&gt;  æˆ–è€…ç›´æ¥ä¿®æ”¹ &lt;em&gt;rc.local&lt;/em&gt; æ–‡ä»¶&lt;br&gt;
æ¥å®ç°å¯åŠ¨é¡¹çš„æ·»åŠ ã€‚ä½†æ˜¯è¿™ä¸€å¥—åœ¨ macOS ä¸Šé¢ç©ä¸è½¬äº†ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦é€šè¿‡ä¸€ä¸ªå®Œå…¨ä¸ä¸€æ ·çš„æœºåˆ¶â€”â€” &lt;strong&gt;Launch Daemon&lt;/strong&gt; æ¥å®ç°è¿™ä¸ªåŠŸèƒ½ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="macOS" scheme="http://davidleee.com/tags/macOS/"/>
    
      <category term="Launch Daemons" scheme="http://davidleee.com/tags/Launch-Daemons/"/>
    
      <category term="Launch Agent" scheme="http://davidleee.com/tags/Launch-Agent/"/>
    
      <category term="plist" scheme="http://davidleee.com/tags/plist/"/>
    
      <category term="launchctl" scheme="http://davidleee.com/tags/launchctl/"/>
    
  </entry>
  
  <entry>
    <title>SVG ä»â€œå®Œå…¨ä¸æ‡‚â€åˆ°â€œè¶³å¤Ÿå¼€ä¸ªå…¥é—¨åˆ†äº«â€</title>
    <link href="http://davidleee.com/2018/10/25/SVG-from-nothing-to-something/"/>
    <id>http://davidleee.com/2018/10/25/SVG-from-nothing-to-something/</id>
    <published>2018-10-25T07:08:10.000Z</published>
    <updated>2020-05-05T03:43:31.442Z</updated>
    
    <content type="html"><![CDATA[<p>æœ€è¿‘éœ€è¦åœ¨ React-Native é¡¹ç›®é‡Œå®ç°ä¸€ä¸ªå¡«æ»¡ç‰¹å®šå›¾å½¢çš„æ•ˆæœï¼Œæ‰¾å¾ˆä¹…éƒ½æ²¡å‘ç°èƒ½æ»¡è¶³éœ€æ±‚çš„å¼€æºåº“ï¼Œäºæ˜¯å°±æ‰“ç®—ç”¨ SVG è‡ªå·±æ€¼ä¸€ä¸ªã€‚å¥½åœ¨è¿™æ–¹é¢æ•™ç¨‹è¿˜ä¸å°‘ï¼Œè™½ç„¶ä¸èƒ½ä¸€æ­¥åˆ°ä½ï¼Œä½†å‡ ç¯‡æ–‡ç« åŠ ä¸€èµ·ä¹Ÿèƒ½æŠŠæ•ˆæœå®ç°å‡ºæ¥ï¼Œäºæ˜¯åœ¨è¿™é‡ŒæŠŠå…¥é—¨è¿‡ç¨‹è®°å½•ä¸€ä¸‹ï¼Œå¸Œæœ›å¸®åæ¥è€…çœç‚¹åŠŸå¤«ã€‚</p><a id="more"></a><h2 id="svg-æ˜¯ä¸ªå•¥ï¼Ÿ">SVG æ˜¯ä¸ªå•¥ï¼Ÿ</h2><p>SVGï¼ˆScalable Vector Graphicsï¼‰ æ˜¯ä¸€ç§åŸºäº XML è¯­æ³•çš„å›¾åƒæ ¼å¼ã€‚è·ŸåŸºäºåƒç´ å¤„ç†çš„å›¾ç‰‡æ ¼å¼ä¸åŒï¼Œå®ƒæ˜¯åŸºäºå¯¹å›¾åƒå½¢çŠ¶çš„æè¿°æ¥å®ç°çš„ï¼Œæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼Œä½“ç§¯ä¸Šè¾ƒå°ï¼Œè€Œä¸”åœ¨æ”¾å¤§çš„æ—¶å€™ä¹Ÿä¸ä¼šå¤±çœŸã€‚</p><p>å› ä¸º SVG æ˜¯åŸºäº XML è¯­æ³•çš„ï¼Œæ‰€ä»¥å¯¹äºå‰ç«¯å¼€å‘è€…æ¥è¯´ï¼Œå†™èµ·æ¥åº”è¯¥æ¯”è¾ƒé¡ºæ‰‹ï¼›å¯¹äº React-Native çš„é¡¹ç›®ï¼Œå› ä¸º JSX çš„å…³ç³»ï¼Œç”¨èµ· SVG æ¥ä¹Ÿæ˜¯æ²¡æœ‰â€œè¯­è¨€éšœç¢â€çš„ã€‚</p><h2 id="svg-é•¿ä»€ä¹ˆæ ·ï¼Ÿ">SVG é•¿ä»€ä¹ˆæ ·ï¼Ÿ</h2><p>ç›´æ¥ä¸Šæºç ï¼š</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">'100'</span> <span class="attr">height</span>=<span class="string">"100"</span> <span class="attr">viewBox</span>=<span class="string">"0 0 100 100"</span> <span class="attr">version</span>=<span class="string">"1.1"</span> <span class="attr">xmlns</span>=<span class="string">"http://www.w3.org/2000/svg"</span> <span class="attr">xmlns:xlink</span>=<span class="string">"http://www.w3.org/1999/xlink"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">defs</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">clipPath</span> <span class="attr">id</span>=<span class="string">"heart"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">"M81.495,13.923c-11.368-5.261-26.234-0.311-31.489,11.032C44.74,13.612,29.879,8.657,18.511,13.923  C6.402,19.539,0.613,33.883,10.175,50.804c6.792,12.04,18.826,21.111,39.831,37.379c20.993-16.268,33.033-25.344,39.819-37.379  C99.387,33.883,93.598,19.539,81.495,13.923z"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">clipPath</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">defs</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">rect</span> <span class="attr">x</span>=<span class="string">'0'</span> <span class="attr">y</span>=<span class="string">'0'</span> <span class="attr">fill</span>=<span class="string">'rgb(217,217,217)'</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">height</span>=<span class="string">"100%"</span> <span class="attr">clip-path</span>=<span class="string">"url(#heart)"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">rect</span> <span class="attr">x</span>=<span class="string">'0%'</span> <span class="attr">y</span>=<span class="string">"50%"</span> <span class="attr">fill</span>=<span class="string">'red'</span> <span class="attr">width</span>=<span class="string">"100%"</span> <span class="attr">height</span>=<span class="string">"100%"</span> <span class="attr">clip-path</span>=<span class="string">"url(#heart)"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™å¼  SVG å›¾æ¸²æŸ“å‡ºæ¥æ˜¯è¿™æ ·çš„ï¼š<br><img src="/uploads/SVG-from-nothing-to-something/57D524DA-6FD7-4538-A238-B002D099D91A.png" alt></p><blockquote><p>ç›´æ¥æŠŠä¸Šé¢çš„ä»£ç ä¿å­˜ä¸ºæ–‡æœ¬ï¼Œå°±å¯ä»¥ç”¨æµè§ˆå™¨æ‰“å¼€å¹¶æ˜¾ç¤ºäº†ã€‚macOS çš„ç”¨æˆ·è¿˜å¯ä»¥ç›´æ¥ç©ºæ ¼é¢„è§ˆã€‚</p></blockquote><p>é…åˆä¸€äº›å‚æ•°çš„æ”¹å˜ï¼ŒåšåŠ¨ç”»ä¹Ÿæ˜¯åˆ†åˆ†é’Ÿçš„äº‹æƒ…ã€‚å¯¹äºä¹‹å‰æ²¡æœ‰æ€ä¹ˆç”¨è¿‡ SVG çš„æˆ‘æ¥è¯´ï¼Œç®€ç›´æ˜¯æ‰“å¼€äº†æ–°ä¸–ç•Œçš„å¤§é—¨ã€‚</p><p>æ¥ä¸‹æ¥å°±è®©æˆ‘ä»¬ä¸€èµ·æ¢ç©¶ä¸€ä¸‹ä¸Šé¢è¿™ä¸ªå›¾æ˜¯æ€ä¹ˆæ¥çš„ã€‚</p><h2 id="svg-æ˜¾ç¤ºåŸç†">SVG æ˜¾ç¤ºåŸç†</h2><p>æ ¹æ®ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬å¯ä»¥å¤§èƒ†çŒœæµ‹ä¸€ä¸‹ï¼š <code>&lt;path&gt;</code> æ ‡ç­¾ä¸‹ <code>d</code> å±æ€§çš„å€¼å°±æ˜¯ç”¨æ¥æç»˜è¿™ä¸ªå¿ƒå½¢çš„å¤–æ¡†è·¯å¾„çš„ã€‚æ—¢ç„¶æç»˜è·¯å¾„å·²ç»æ˜¯ç¡®å®šçš„äº†ï¼Œé‚£ä¸€å¼  SVG å›¾ç‰‡æ˜¯æ€ä¹ˆå®ç°ç¼©æ”¾ä¸å¤±çœŸçš„ç‰¹æ€§çš„å‘¢ï¼Ÿ<br>è¦å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œå°±è¦è®©æˆ‘ä»¬å…ˆäº†è§£ä¸€ä¸‹ SVG çš„ä¸€äº›åŸºæœ¬æ˜¾ç¤ºåŸç†ã€‚</p><h3 id="the-svg-canvas">The SVG Canvas</h3><p>å‡è®¾æˆ‘ä»¬è¦å°†ä¸€ä¸ª SVG å›¾å½¢ç»˜åˆ¶åˆ°ä¸€å¼ ç”»å¸ƒï¼ˆCanvasï¼‰ä¸Šï¼Œæ¦‚å¿µä¸Šè¿™å¼ ç”»å¸ƒåº”è¯¥æ˜¯æ— é™å¤§çš„ï¼Œè¿™æ ·æˆ‘ä»¬çš„å›¾å½¢æ‰å¯ä»¥æ˜¯ä»»æ„å¤§å°ã€‚ç„¶è€Œï¼Œå®é™…ä¸Š SVG å›¾ç‰‡æ˜¯æ˜¾ç¤ºåœ¨ä¸€ä¸ªæœ‰é™çš„åŒºåŸŸé‡Œçš„ï¼Œå°±åƒæˆ‘ä»¬é€è¿‡çª—æˆ·çœ‹çª—å¤–çš„é£æ™¯ä¸€æ ·ï¼Œè¿™ä¸ªæœ‰é™åŒºåŸŸè¢«ç§°ä¸ºâ€œè§‚å¯Ÿå­”â€ï¼ˆViewportï¼‰ã€‚</p><h3 id="the-viewport">The Viewport</h3><p>â€œè§‚å¯Ÿå­”â€æŒ‡çš„æ˜¯ SVG å›¾ç‰‡å¯è§çš„é‚£ä¸€éƒ¨åˆ†ï¼Œæƒ³è±¡æˆ‘ä»¬é€è¿‡çª—æˆ·çœ‹çª—å¤–çš„é£æ™¯ï¼Œè¿™ä¸ªçª—å­å°±æ˜¯å¤–é¢é£æ™¯çš„è§‚å¯Ÿå­”ã€‚</p><blockquote><p>ç±»ä¼¼çš„ï¼Œæˆ‘ä»¬åœ¨æµè§ˆç½‘é¡µçš„æ—¶å€™é¢å¯¹çš„ä¹Ÿæ˜¯è¿™ç§æƒ…å†µï¼Œç½‘é¡µçš„å¤§å°é€šå¸¸æ¯”æµè§ˆå™¨çš„çª—å£è¦å¤§ï¼Œè¿™æ—¶å€™æµè§ˆå™¨å°±æ˜¯è¿™ä¸ªç½‘é¡µçš„è§‚å¯Ÿå­”äº†ã€‚</p></blockquote><p>æˆ‘ä»¬é€šè¿‡è®¾ç½® <code>&lt;svg&gt;</code> æ ‡ç­¾çš„ <code>width</code> å’Œ <code>height</code> å±æ€§æ¥ç¡®å®šè¿™å¼  SVG çš„è§‚å¯Ÿå­”å¤§å°ï¼Œå¯¹äºä¸Šé¢çš„å¿ƒå½¢æ¥è¯´ï¼Œè§‚å¯Ÿå­”æ˜¯ 100x100 çš„æ­£æ–¹å½¢ï¼š</p><figure class="highlight svg"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- the viewport will be 100px by 100px --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">"100"</span> <span class="attr">height</span>=<span class="string">"100"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- SVG content drawn onto the SVG canvas --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>åœ¨ SVG é‡Œï¼Œæ•°å€¼çš„å•ä½æ˜¯å¯é€‰çš„ã€‚åœ¨æˆ‘ä»¬ä¸ä¸»åŠ¨æä¾›çš„æ—¶å€™ï¼Œé»˜è®¤ä¼šä»¥ <code>px</code> ä¸ºå•ä½ã€‚å¯é€‰çš„å•ä½æœ‰ <code>em</code>ã€<code>ex</code>ã€<code>px</code>ã€<code>pt</code>ã€<code>pc</code>ã€<code>cm</code>ã€<code>mm</code>ã€<code>in</code> å’Œç™¾åˆ†æ¯”ã€‚</p></blockquote><h3 id="åæ ‡ç³»ç»Ÿ">åæ ‡ç³»ç»Ÿ</h3><p>åœ¨è§‚å¯Ÿå­”çš„å¤§å°ç¡®å®šä¸‹æ¥ä¹‹åï¼ŒSVG å°±ä¼šå»ºç«‹ä¸€å¥—åˆå§‹çš„åæ ‡ç³»ç»Ÿï¼šä»¥æœ€å·¦ä¸Šè§’ä¸º <code>(0, 0)</code> ç‚¹ï¼Œx è½´å’Œ y è½´åˆ†åˆ«å‘å³å’Œå‘ä¸‹å»¶ä¼¸ï¼ˆå°±åƒç§»åŠ¨å®¢æˆ·ç«¯å’Œç½‘é¡µæ˜¾ç¤ºé‡Œé‚£æ ·ï¼‰ã€‚åœ¨è¿™ä¸ªåŸºç¡€ä¸Šï¼Œæˆ‘ä»¬åˆšåˆšåˆ›å»ºçš„è§‚å¯Ÿå­”ä¹Ÿå°±æœ‰äº†å±äºè‡ªå·±çš„ä¸€å¥—ä½ç½®æ ‡è¯†ï¼š<code>(x: 0, y: 0, width: 100, height: 100)</code>ã€‚</p><h2 id="the-viewbox">The <code>viewbox</code></h2><p>åœ¨äº†è§£äº†ä¸Šè¿°çŸ¥è¯†ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥æ¥è¯´è¯´ <code>viewbox</code> è¿™ä¸ªå±æ€§äº†ã€‚</p><p>æˆ‘ä»¬å¯ä»¥æŠŠ <code>viewbox</code> ç†è§£ä¸ºâ€œçœŸæ­£çš„åæ ‡ç³»ç»Ÿâ€ï¼Œå› ä¸ºå®ƒå†³å®šäº† SVG å›¾å½¢æ˜¯æ€ä¹ˆç»˜åˆ¶åˆ°ç”»å¸ƒä¸Šçš„ã€‚ä¸€ä¸ª SVG å›¾å½¢çš„å¤§å°å¯ä»¥ä¸è§‚å¯Ÿå­”ä¸ä¸€æ ·ï¼Œå®ƒå¯èƒ½ä¼šå®Œæ•´åœ°æ˜¾ç¤ºå‡ºæ¥ï¼Œä¹Ÿå¯èƒ½ä¼šè¢«è§‚å¯Ÿå­”è£å‡æ‰ä¸€éƒ¨åˆ†ã€‚</p><blockquote><p>å°±åƒä¸€å¼ æ™®é€šå›¾ç‰‡ä¸€æ ·ï¼Œå½“ä½ éœ€è¦æŠŠå›¾å½¢å®Œæ•´åœ°æ”¾è¿›ä¸€ä¸ªè§†å›¾é‡Œé¢æ—¶ï¼Œå¯ä»¥è°ƒèŠ‚å›¾ç‰‡çš„æ‹‰ä¼¸æ¨¡å¼ï¼Œä¸€è¾¹è®©å›¾ç‰‡çš„å¤§å°æ›´ä¸ºåˆç†ã€‚SVG é‡Œå¯¹åº”çš„å±æ€§æ˜¯ <code>preserveAspectRatio</code>ã€‚</p></blockquote><p><code>viewbox</code>  ä¼šä¸€æ¬¡æ€§è®¾ç½®4ä¸ªå‚æ•°ï¼š</p><figure class="highlight svg"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">viewbox</span>=<span class="string">"&lt;min-x&gt; &lt;min-y&gt; &lt;width&gt; &lt;height&gt;"</span>&gt;</span><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å…¶ä¸­ï¼Œ<code>&lt;min-x&gt;</code> å’Œ <code>&lt;min-y&gt;</code> ä¸èƒ½è®¾ç½®ä¸ºè´Ÿæ•°ï¼Œ<code>&lt;width&gt;</code> å’Œ <code>&lt;height&gt;</code> è®¾ç½®ä¸º 0 çš„è¯ï¼Œå…ƒç´ å°±å‹æ ¹ä¸ä¼šç»˜åˆ¶äº†ã€‚</p><p>æ‰€ä»¥è¯´ï¼Œ<code>viewbox=&quot;0 0 100 100&quot;</code> å°±åšäº†ä¸‹é¢å‡ ä»¶äº‹æƒ…ï¼š</p><ol><li>åœ¨ç”»å¸ƒä¸Šåˆ’åˆ†å‡ºæ¥ä¸€ä¸ª 100x100 å¤§å°çš„åŒºåŸŸï¼Œæ”¾åœ¨ (0, 0) ç‚¹ä¸Š</li><li>æŠŠ SVG å›¾å½¢ç¼©æ”¾æˆåˆé€‚è¿™ä¸ªåŒºåŸŸçš„æ ·å­</li><li>å°†æ•´ä¸ªåŒºåŸŸï¼ˆåŒ…æ‹¬é‡Œé¢çš„å›¾å½¢ï¼‰æ”¾å¤§åˆ°é“ºæ»¡æ•´ä¸ªè§‚å¯Ÿå­”</li><li>å°†è¿™ä¸ªåæ ‡ç³»ç»Ÿ<strong>æŒ‰æ¯”ä¾‹</strong>æ˜ å°„åˆ°åˆ°åˆå§‹åæ ‡ç³»ç»Ÿä¸Š</li></ol><p>é‚£å¯¹äºä¸Šé¢çš„çˆ±å¿ƒå›¾ç‰‡æ¥è¯´ï¼Œæˆ‘ä»¬å°è¯•è°ƒæ•´ä¸€ä¸‹ <code>viewbox</code> çš„åŸç‚¹ï¼Œå°†å®ƒè®¾ç½®ä¸º <code>viewbox=&quot;50 50 100 100&quot;</code> è¯•è¯•ï¼š<br><img src="/uploads/SVG-from-nothing-to-something/353B4442-E68D-4F8A-8D53-CE5EEED21F36.png" alt><br>å¯ä»¥çœ‹åˆ°ï¼Œå°±åƒåœ°å›¾è½¯ä»¶ä¸€æ ·ï¼Œé•œå¤´å¾€ç”»é¢çš„å³ä¸‹æ–¹ç§»åŠ¨äº†ä¸€æ®µã€‚è¿™ä¹Ÿç›¸å½“äºæŠŠæ•´ä¸ªç”»é¢å¾€å·¦ä¸Šæ–¹æ¨äº†è¿‡å»ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®ç”»å¸ƒçš„ <code>transform</code> å±æ€§æ¥å®ç°ç›¸åŒçš„æ•ˆæœï¼š<code>transform=&quot;translate(-50 -50)&quot;</code>ã€‚</p><blockquote><p>å½“è®¾è®¡å¸ˆç»™ä½ ä¸€å¼  SVG å›¾ç‰‡çš„æ—¶å€™ï¼Œå…¶ä¸­çš„å›¾æ¡ˆè·¯å¾„å¯èƒ½æ˜¯æŒ‰ç…§ä¸€å®šçš„å¤§å°å’Œä½ç§»æ¥ç»˜åˆ¶çš„ï¼Œæ¯”å¦‚ä»(10, 10) ç‚¹å¼€å§‹ç”»çš„ä¸€å¼  40x40 çš„å›¾ï¼Œè¿™æ—¶å€™ä½ çš„ <code>viewbox</code> å°±åº”è¯¥è®¾ç½®ä¸º <code>viewbox=&quot;10 10 40 40&quot;</code> ï¼Œè®©å›¾ç‰‡æ”¾åˆ°æœ€åˆé€‚çš„åæ ‡ç³»ç»Ÿä¸Šã€‚</p></blockquote><h2 id="å°ç»“">å°ç»“</h2><p>ä¸Šé¢çš„ä¾‹å­æ¼”ç¤ºäº†ä¸€å¼  SVG å›¾çš„å¸¸è§„æ“ä½œï¼Œé™äºç¯‡å¹…åŸå› ï¼Œè¿˜æœ‰ä¸€äº›æœ‰æ„æ€çš„æƒ…å†µæ²¡æœ‰å±•ç¤ºåˆ°ï¼Œæ¯”å¦‚å½“ <code>viewbox</code> é‡Œè®¾ç½®çš„å®½é«˜æ¯”ä¸æˆ‘ä»¬åœ¨ <code>&lt;svg&gt;</code> æ ‡ç­¾é‡Œè®¾ç½®çš„å®½é«˜æ¯”ä¸ä¸€æ ·ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿè¿™ç§æƒ…å†µä¸‹ï¼Œå°±éœ€è¦æˆ‘ä»¬å»äº†è§£ä¸€ä¸‹ <code>preserveAspectRatio</code> å±æ€§äº†ã€‚</p><p>åœ¨å‚è€ƒæ–‡ç«  <a href="https://www.sarasoueidan.com/blog/svg-coordinate-systems/" target="_blank" rel="noopener">Understanding SVG Coordinate Systems and Transformations (Part 1) </a> é‡Œï¼Œæœ‰å¯¹è¿™æ–¹é¢æ›´è¯¦ç»†çš„è§£é‡Šï¼Œè€Œä¸”ä½œè€…è¿˜æä¾›äº†éå¸¸ç›´è§‚çš„åœ¨çº¿é¢„è§ˆå·¥å…·ï¼Œç›¸ä¿¡ä¼šå¯¹åå‘äºä½¿ç”¨å›¾åƒæ€ç»´çš„åŒå­¦ä»¬æ›´æœ‰å¸®åŠ©ã€‚</p><h2 id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </h2><ul><li><a href="https://www.sarasoueidan.com/blog/svg-coordinate-systems/" target="_blank" rel="noopener">Understanding SVG Coordinate Systems and Transformations (Part 1) </a></li><li><a href="http://www.ruanyifeng.com/blog/2018/08/svg.html" target="_blank" rel="noopener">SVG å›¾åƒå…¥é—¨æ•™ç¨‹ - é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æœ€è¿‘éœ€è¦åœ¨ React-Native é¡¹ç›®é‡Œå®ç°ä¸€ä¸ªå¡«æ»¡ç‰¹å®šå›¾å½¢çš„æ•ˆæœï¼Œæ‰¾å¾ˆä¹…éƒ½æ²¡å‘ç°èƒ½æ»¡è¶³éœ€æ±‚çš„å¼€æºåº“ï¼Œäºæ˜¯å°±æ‰“ç®—ç”¨ SVG è‡ªå·±æ€¼ä¸€ä¸ªã€‚å¥½åœ¨è¿™æ–¹é¢æ•™ç¨‹è¿˜ä¸å°‘ï¼Œè™½ç„¶ä¸èƒ½ä¸€æ­¥åˆ°ä½ï¼Œä½†å‡ ç¯‡æ–‡ç« åŠ ä¸€èµ·ä¹Ÿèƒ½æŠŠæ•ˆæœå®ç°å‡ºæ¥ï¼Œäºæ˜¯åœ¨è¿™é‡ŒæŠŠå…¥é—¨è¿‡ç¨‹è®°å½•ä¸€ä¸‹ï¼Œå¸Œæœ›å¸®åæ¥è€…çœç‚¹åŠŸå¤«ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="svg" scheme="http://davidleee.com/tags/svg/"/>
    
      <category term="xml" scheme="http://davidleee.com/tags/xml/"/>
    
      <category term="markup" scheme="http://davidleee.com/tags/markup/"/>
    
      <category term="react-native" scheme="http://davidleee.com/tags/react-native/"/>
    
      <category term="viewbox" scheme="http://davidleee.com/tags/viewbox/"/>
    
      <category term="clippath" scheme="http://davidleee.com/tags/clippath/"/>
    
  </entry>
  
  <entry>
    <title>CSS å¥æ³•</title>
    <link href="http://davidleee.com/2018/10/19/CSS-syntax/"/>
    <id>http://davidleee.com/2018/10/19/CSS-syntax/</id>
    <published>2018-10-19T11:54:42.000Z</published>
    <updated>2020-05-05T03:43:31.441Z</updated>
    
    <content type="html"><![CDATA[<p>CSS æ˜¯å£°æ˜å‹è¯­è¨€ï¼Œè¿™è®©å®ƒçš„å¥æ³•ï¼ˆsyntaxï¼‰éå¸¸ç›´ç™½æ˜“æ‡‚ã€‚</p><p>é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒè¿˜æœ‰å¾ˆå¥½çš„é”™è¯¯æ¢å¤æœºåˆ¶ï¼Œå®ƒèƒ½é¿å…åœ¨é”™è¯¯å‘ç”Ÿæ—¶æŠŠæ‰€æœ‰ä¸œè¥¿éƒ½å¼„å¾—ä¸€å›¢ä¹±ï¼šæ¯”å¦‚è¯´åœ¨å®ƒç¢°åˆ°ä¸è®¤è¯†çš„å£°æ˜æ—¶ï¼Œå®ƒä¼šç›´æ¥å¿½ç•¥æ‰è¿™ä¸ªä¸œè¥¿ã€‚ä½†ä»å¦ä¸€æ–¹é¢æ¥è¯´ï¼Œè¿™ä¹Ÿè®©é”™è¯¯æ›´éš¾è¢«å‘ç°äº†ã€‚</p><p>å€Ÿç€æœ€è¿‘å‰ç«¯åŒäº‹äº‹åŠ¡ç¹å¿™çš„æœºä¼šï¼Œæˆ‘è¿™å®¢æˆ·ç«¯å·¥ç¨‹å¸ˆèµ¶é¸­å­ä¸Šæ¶æ€¼äº†ä¸€ä¸ªé™æ€ç½‘é¡µå‡ºæ¥ï¼Œé¡ºä¾¿äº§ä¸‹äº†ä¸¤ç¯‡å‰¯äº§å“ï¼Œéƒ½ä¸ CSS åŸºç¡€ç›¸å…³ï¼Œè¿™æ˜¯ç¬¬äºŒç¯‡ï¼ˆç¬¬ä¸€ç¯‡åœ¨æ­¤ï¼š <a href="/2018/10/19/How-CSS-works/" title="CSS æ˜¯æ€ä¹ˆè¿ä½œçš„">CSS æ˜¯æ€ä¹ˆè¿ä½œçš„</a>ï¼‰ï¼Œå¸Œæœ›å¯¹å…¶ä»–å¯èƒ½æœ‰ç›¸åŒéœ€è¦çš„åŒå¿—é€ä¸Šä¸€äº›å¸®åŠ©ã€‚</p><a id="more"></a><h2 id="åè¯è§£é‡Š">åè¯è§£é‡Š</h2><p>æ­£å¦‚<a href="/2018/10/19/How-CSS-works/" title="ä¸Šä¸€ç¯‡æ–‡ç« ">ä¸Šä¸€ç¯‡æ–‡ç« </a>é‡Œè¯´åˆ°çš„ï¼ŒCSS æ˜¯ç”±é€‰æ‹©å™¨å’Œä¸€ç»„å±æ€§ç»„æˆçš„ã€‚å…¶ä¸­ï¼Œå±æ€§éƒ¨åˆ†æ˜¯ç”±ä¸€ç³»åˆ—çš„é”®å€¼å¯¹ç»„æˆï¼Œåœ¨ CSS çš„ä¸–ç•Œé‡Œï¼Œå®ƒä»¬æœ‰ç€è‡ªå·±çš„åå­—ï¼š</p><ul><li>å±æ€§ï¼ˆPropertiesï¼‰ï¼šä»¥â€œè¯´äººè¯â€çš„æ–¹å¼è¡¨æ˜è¿™ä¸ªç©æ„å„¿æ˜¯å¹²ä»€ä¹ˆçš„</li><li>å€¼ï¼ˆValuesï¼‰ï¼šæ¯ä¸ªå±æ€§éƒ½ä¼šæœ‰å¯¹åº”çš„å€¼ï¼Œè¡¨ç¤ºä½ æƒ³è¦æ€ä¹ˆä¿®æ”¹è¿™ä¸ªä¸œè¥¿</li></ul><p>è¿™æ ·çš„ä¸€ç»„â€œå±æ€§-å€¼â€çš„ç»„åˆï¼Œæˆ‘åœ¨å‰é¢ç›´æ¥ç§°å‘¼ä¸ºâ€œé”®å€¼å¯¹â€äº†ï¼Œä½†å®ƒåœ¨ CSS ä¸–ç•Œé‡Œçš„æœ¬åå…¶å®æ˜¯ <strong>CSS å£°æ˜ï¼ˆCSS declarationï¼‰</strong>ã€‚<br>è¢«ä¸€å¯¹å¤§æ‹¬å·åŒ…è£¹èµ·æ¥çš„ä¸€ç»„ CSS å£°æ˜è¢«ç§°ä¸º <strong>CSS å£°æ˜å—ï¼ˆCSS declaration blocksï¼‰</strong>ã€‚<br>æœ€åï¼Œä¸€ä¸ª CSS å£°æ˜å—ä¼šè·Ÿä¸€ä¸ªé€‰æ‹©å™¨æ­é…èµ·æ¥ï¼Œç§°ä¸º <strong>CSS è§„åˆ™ï¼ˆCSS Rulesets/Rulesï¼‰</strong>ã€‚</p><h3 id="css-å£°æ˜">CSS å£°æ˜</h3><p>æŠŠ CSS å±æ€§è®¾ç½®ä¸ºä¸€ä¸ªç‰¹å®šçš„å€¼ï¼Œå¯ä»¥è¯´æ˜¯ CSS è¿™é—¨è¯­è¨€çš„æœ€æ ¸å¿ƒåŠŸèƒ½äº†ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå±æ€§å’Œå€¼éƒ½æ˜¯åŒºåˆ†å¤§å°å†™çš„ï¼Œå®ƒä»¬ä¹‹é—´ç”¨ â€œ:â€ æ¥åˆ†éš”ã€‚</p><p>ç›®å‰ï¼ŒCSS ä¸–ç•Œé‡Œä¸€å…±æœ‰<a href="https://developer.mozilla.org/en-US/docs/Web/CSS/Reference" target="_blank" rel="noopener">300 ç§ä¸åŒçš„å±æ€§</a>ï¼Œæ¯ç§å±æ€§éƒ½æœ‰å…¶å¯¹åº”çš„å¯é€‰å€¼ã€‚</p><blockquote><p>åœ¨ CSS è¯­æ³•é‡Œï¼ˆåŒ…æ‹¬å…¶ä»– web æ ‡å‡†ä¸­ï¼‰ï¼Œç¾å¼æ‹¼å†™æ˜¯å”¯ä¸€çš„æ‹¼å†™æ ‡å‡†ã€‚æ¯”å¦‚è¯´ï¼Œåœ¨éœ€è¦è®¾ç½®é¢œè‰²çš„æ—¶å€™ï¼Œ<code>color</code> æ°¸è¿œä¼˜äº <code>colour</code>ã€‚</p></blockquote><h3 id="css-å£°æ˜å—">CSS å£°æ˜å—</h3><p>CSS å£°æ˜ä»¥ä»£ç å—çš„å½¢å¼å­˜åœ¨ï¼Œç”¨ä¸€å¯¹å¤§æ‹¬å·æ‹¬èµ·æ¥ã€‚</p><blockquote><p>CSS å£°æ˜å—å¯ä»¥æ˜¯ç©ºçš„ï¼ˆé‡Œé¢ä¸å¸¦ä»»ä½•å£°æ˜ï¼‰</p></blockquote><p>CSS å£°æ˜å—é‡Œçš„ä¸åŒå£°æ˜æ˜¯é€šè¿‡ â€œ;â€ æ¥åˆ†éš”çš„ã€‚</p><blockquote><p>å®é™…ä¸Šï¼Œæœ€åä¸€ç»„å£°æ˜æ˜¯å¯ä»¥ä¸ç”¨åˆ†å·ç»“å°¾çš„ï¼Œä½†æ˜¯å¥½å¥½çš„å¹²å˜›è¦é€¼æ­»å¼ºè¿«ç—‡å‘¢ï¼Ÿ</p></blockquote><h3 id="css-é€‰æ‹©å™¨å’Œè§„åˆ™">CSS é€‰æ‹©å™¨å’Œè§„åˆ™</h3><p>åœ¨å†™å¥½äº†å£°æ˜å—ä¹‹åï¼Œæˆ‘ä»¬è¿˜éœ€è¦å‘Šè¯‰æµè§ˆå™¨è¿™äº›å±æ€§è¦ç”¨åˆ°å“ªé‡Œå»ï¼Œè¿™å°±éœ€è¦åœ¨è¿™ä¸ªå£°æ˜å—å‰é¢åŠ ä¸Šä¸€ä¸ªå‰ç¼€â€”â€”é€‰æ‹©å™¨äº†ã€‚</p><p>é€‰æ‹©å™¨å¯ä»¥æ˜¯éå¸¸å¤æ‚çš„ï¼šä½ å¯ä»¥æŠŠä¸€ä¸ªå£°æ˜å—åº”ç”¨åˆ°å¥½å‡ ä¸ªé€‰æ‹©å™¨ä¸Šï¼Œé€šè¿‡é€—å·åˆ†éš”ï¼›ä½ è¿˜å¯ä»¥é“¾å¼åœ°æ„é€ ä¸€ä¸ªæŒ‡å‘æ€§æ›´æ˜ç¡®çš„é€‰æ‹©å™¨ï¼Œæ¯”å¦‚ï¼šé€‰æ‹©ä¸€ä¸ªç±»åæ˜¯ â€œabcâ€ çš„å…ƒç´ ï¼Œå®ƒè¦åœ¨ <code>&lt;article&gt;</code> æ ‡ç­¾ä¸‹ï¼Œè€Œä¸”åªæœ‰é¼ æ ‡ç§»åŠ¨åˆ°å®ƒä¸Šé¢çš„æ—¶å€™æ‰ç”Ÿæ•ˆã€‚</p><p>ä¸€ä¸ªå…ƒç´ å¯èƒ½è¢«å¤šä¸ªé€‰æ‹©å™¨çœ‹ä¸Šï¼Œæ‰€ä»¥åŒä¸€ä¸ªå±æ€§å¯èƒ½ä¼šè¢«æ”¹å˜å¤šæ¬¡ï¼ŒCSS ä¼šé€šè¿‡å±‚å ç®—æ³•ï¼ˆcascade algorithmï¼‰æ¥åˆ¤æ–­è¿™äº›å±æ€§ä¿®æ”¹çš„ä¼˜å…ˆçº§ã€‚</p><blockquote><p>å¯¹äºåŒä¸€ä¸ªå£°æ˜å—ï¼Œåœ¨ä½¿ç”¨å¤æ‚é€‰æ‹©å™¨çš„æ—¶å€™ï¼ˆæ¯”å¦‚å­˜åœ¨å¤šä¸ªé€‰æ‹©å™¨ï¼‰ï¼Œå¦‚æœå…¶ä¸­çš„æŸä¸€é¡¹é€‰æ‹©æœ‰è¯¯ï¼Œé‚£ä¹ˆå…¶ä»–çš„é€‰æ‹©å™¨æ˜¯ä¸ä¼šè¢«å½±å“çš„ï¼Œè¯¥æ€ä¹ˆå·¥ä½œè¿˜æ˜¯æ€ä¹ˆå·¥ä½œã€‚</p></blockquote><h3 id="css-è¯­å¥">CSS è¯­å¥</h3><p>é™¤äº†ä¸Šé¢çœ‹åˆ°çš„å£°æ˜å—ä¹‹å¤–ï¼Œ CSS é‡Œè¿˜æœ‰ä¸€äº›å…¶ä»–ç±»å‹çš„è¯­å¥ï¼š</p><ul><li><strong>At-è§„åˆ™</strong> ç”¨æ¥ä¼ è¾¾å…ƒæ•°æ®ã€æ¡ä»¶ä¿¡æ¯æˆ–å…¶ä»–æè¿°æ€§ä¿¡æ¯ã€‚æ¯”å¦‚è¯´ï¼š<ul><li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/@charset" target="_blank" rel="noopener">@charset</a>  å’Œ  <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/@import" target="_blank" rel="noopener">@import</a>  (å…ƒæ•°æ®)</li><li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/@media" target="_blank" rel="noopener">@media</a>  æˆ–è€…  <a href="https://developer.mozilla.org/en-US/docs/Web/CSS/@document" target="_blank" rel="noopener">@document</a>  (æ¡ä»¶ä¿¡æ¯ï¼Œä¹Ÿå«å†…éƒ¨è¯­æ³•)</li><li><a href="https://developer.mozilla.org/en-US/docs/Web/CSS/@font-face" target="_blank" rel="noopener">@font-face</a>  (æè¿°æ€§ä¿¡æ¯)<br>å®Œæ•´çš„å†™æ³•æ˜¯è¿™æ ·çš„ï¼š</li></ul></li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@import</span> <span class="string">'custom.css'</span>; <span class="comment">/* ä»å¦ä¸€ä¸ª css æ–‡ä»¶ä¸­å¼•å…¥è§„åˆ™ */</span></span><br></pre></td></tr></table></figure><ul><li><strong>å†…éƒ¨è¯­æ³•ï¼ˆNested statementsï¼‰</strong> æ˜¯ at-è§„åˆ™ çš„ä¸€ä¸ªå­é›†ï¼Œè¿™ç±»è§„åˆ™åªä¼šåœ¨ç‰¹å®šæ¡ä»¶ä¸‹æ‰ä¼šç”Ÿæ•ˆï¼š<ul><li><code>@media</code> è¿è¡Œè®¾å¤‡ç¬¦åˆæŸäº›æ¡ä»¶æ—¶æ‰æ‰§è¡Œ</li><li><code>@supports</code> æµè§ˆå™¨æ”¯æŒæŸäº›æµ‹è¯•ç‰¹æ€§çš„æ—¶å€™æ‰æ‰§è¡Œ</li><li><code>@document</code> å½“å‰é¡µé¢ç¬¦åˆæŸäº›æ¡ä»¶æ—¶æ‰æ‰§è¡Œ<br>ä¸¾ä¸ªä¾‹å­ï¼š</li></ul></li></ul><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@media</span> (<span class="attribute">min-width:</span> <span class="number">801px</span>) &#123;</span><br><span class="line">  <span class="selector-tag">body</span> &#123;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">800px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¿°é’ˆå¯¹ <code>body</code> çš„è§„åˆ™ï¼Œåªåœ¨è®¾å¤‡å®½åº¦å¤§äº 800px çš„æ—¶å€™æ‰ä¼šç”Ÿæ•ˆã€‚</p><h2 id="å°ç»“">å°ç»“</h2><p>åˆ†ä¸¤ç¯‡å™è¿°çš„ CSS ç›¸å…³çŸ¥è¯†å°±è®²å®Œäº†ã€‚è¿™ä¸¤ç¯‡æ–‡ç« çš„ä¸»è¦ç›®çš„æ˜¯æŠŠæˆ‘ä»¬é¢†è¿›å‰ç«¯ä¸–ç•Œçš„å¤§é—¨ï¼Œè¯»å®Œä¹‹åï¼Œæˆ‘ä»¬åº”è¯¥å¯ä»¥å®ç°ä¸€äº›ç®€å•çš„é™æ€é¡µé¢äº†ï¼<sub>ï¼ˆå°å£°è¯´ï¼šè™½ç„¶å…·ä½“æ€ä¹ˆç”¨è¿˜éœ€è¦è‡ªå·±å»è°·æ­Œç™¾åº¦ä¸€ä¸‹ï¼‰</sub>å½“ç„¶ï¼Œå‰ç«¯çš„é­…åŠ›è¿˜è¿œä¸æ­¢å¦‚æ­¤ï¼Œè¦æƒ³æŠŠ CSS ç©å‡ºèŠ±å„¿æ¥ï¼Œè¿˜éœ€è¦æŒç»­çš„ç£¨ç»ƒã€‚</p><p>æˆ‘è¿™ä¸ªåŠåŠå­çš„å‰ç«¯å·¥ç¨‹å¸ˆæ€»ç®—æ˜¯æŠŠæ•´ä¸ªé™æ€é¡µé¢çš„éœ€æ±‚ç»™æ€¼å‡ºæ¥å•¦ï¼æ¥ä¸‹æ¥å¦‚æœæœ‰æ—¶é—´çš„è¯ï¼Œæˆ‘ä¼šå†æŠŠé¡µé¢é‡Œç”¨åˆ°çš„ä¸€äº› JS å®ç°çš„é€»è¾‘ä¹Ÿæ‹‰å‡ºæ¥æºœä¸€æºœã€‚è¦æ˜¯è¿™ä¸‹ä¸€ç¯‡æ–‡ç« çœŸçš„æœ‰è¯ç”Ÿä¹‹æ—¥çš„è¯ï¼Œé‚£è¯»åˆ°å®Œæ•´ä¸‰ä¸ªéƒ¨åˆ†çš„åŒå­¦ä»¬å°±ä¼šåœ¨å‰ç«¯ç•Œå…­å¾—é£èµ·<sub>ï¼ˆå‡çš„ï¼‰</sub>äº†ï¼</p><h2 id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </h2><p><a href="https://developer.mozilla.org/en-US/docs/Learn/CSS/Introduction_to_CSS/Syntax" target="_blank" rel="noopener">CSS syntax - Learn web development | MDN</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;CSS æ˜¯å£°æ˜å‹è¯­è¨€ï¼Œè¿™è®©å®ƒçš„å¥æ³•ï¼ˆsyntaxï¼‰éå¸¸ç›´ç™½æ˜“æ‡‚ã€‚&lt;/p&gt;
&lt;p&gt;é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒè¿˜æœ‰å¾ˆå¥½çš„é”™è¯¯æ¢å¤æœºåˆ¶ï¼Œå®ƒèƒ½é¿å…åœ¨é”™è¯¯å‘ç”Ÿæ—¶æŠŠæ‰€æœ‰ä¸œè¥¿éƒ½å¼„å¾—ä¸€å›¢ä¹±ï¼šæ¯”å¦‚è¯´åœ¨å®ƒç¢°åˆ°ä¸è®¤è¯†çš„å£°æ˜æ—¶ï¼Œå®ƒä¼šç›´æ¥å¿½ç•¥æ‰è¿™ä¸ªä¸œè¥¿ã€‚ä½†ä»å¦ä¸€æ–¹é¢æ¥è¯´ï¼Œè¿™ä¹Ÿè®©é”™è¯¯æ›´éš¾è¢«å‘ç°äº†ã€‚&lt;/p&gt;
&lt;p&gt;å€Ÿç€æœ€è¿‘å‰ç«¯åŒäº‹äº‹åŠ¡ç¹å¿™çš„æœºä¼šï¼Œæˆ‘è¿™å®¢æˆ·ç«¯å·¥ç¨‹å¸ˆèµ¶é¸­å­ä¸Šæ¶æ€¼äº†ä¸€ä¸ªé™æ€ç½‘é¡µå‡ºæ¥ï¼Œé¡ºä¾¿äº§ä¸‹äº†ä¸¤ç¯‡å‰¯äº§å“ï¼Œéƒ½ä¸ CSS åŸºç¡€ç›¸å…³ï¼Œè¿™æ˜¯ç¬¬äºŒç¯‡ï¼ˆç¬¬ä¸€ç¯‡åœ¨æ­¤ï¼š &lt;a href=&quot;/2018/10/19/How-CSS-works/&quot; title=&quot;CSS æ˜¯æ€ä¹ˆè¿ä½œçš„&quot;&gt;CSS æ˜¯æ€ä¹ˆè¿ä½œçš„&lt;/a&gt;ï¼‰ï¼Œå¸Œæœ›å¯¹å…¶ä»–å¯èƒ½æœ‰ç›¸åŒéœ€è¦çš„åŒå¿—é€ä¸Šä¸€äº›å¸®åŠ©ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="css" scheme="http://davidleee.com/tags/css/"/>
    
      <category term="html" scheme="http://davidleee.com/tags/html/"/>
    
      <category term="web" scheme="http://davidleee.com/tags/web/"/>
    
  </entry>
  
  <entry>
    <title>CSS æ˜¯æ€ä¹ˆè¿ä½œçš„</title>
    <link href="http://davidleee.com/2018/10/19/How-CSS-works/"/>
    <id>http://davidleee.com/2018/10/19/How-CSS-works/</id>
    <published>2018-10-19T11:28:35.000Z</published>
    <updated>2020-05-05T03:43:31.441Z</updated>
    
    <content type="html"><![CDATA[<p>CSS å…¨ç§° Cascading Style Sheetsï¼Œç½‘é¡µå†…å®¹ï¼ˆHTMLï¼‰ä¼šè¢«æµè§ˆå™¨è½¬æ¢ä¸º DOMï¼ˆDocument Object Modelï¼‰ä»¥ä¾›æ˜¾ç¤ºï¼Œè€Œ CSS å°±æ˜¯ä½œç”¨åœ¨ DOM ä¸Šä»¥æ”¹å˜å®ƒä»¬çš„æ ·å¼ã€å¸ƒå±€æˆ–è¡Œä¸ºç­‰ã€‚å¯¹äºå‰ç«¯å·¥ç¨‹å¸ˆæ¥è¯´ï¼Œè¿™æ˜¯å¾ˆå¸¸è§çš„åŸºæœ¬æ“ä½œäº†ï¼Œä½†æ˜¯å¯¹å…¶ä»–ä¸å¸¸æ•²ç½‘é¡µä»£ç çš„ç¨‹åºå‘˜æ¥è¯´ï¼Œå´å¯èƒ½ä¼šæœ‰äº›é™Œç”Ÿã€‚</p><p>å€Ÿç€æœ€è¿‘å‰ç«¯åŒäº‹äº‹åŠ¡ç¹å¿™çš„æœºä¼šï¼Œæˆ‘è¿™å®¢æˆ·ç«¯å·¥ç¨‹å¸ˆèµ¶é¸­å­ä¸Šæ¶æ€¼äº†ä¸€ä¸ªé™æ€ç½‘é¡µå‡ºæ¥ï¼Œé¡ºä¾¿äº§ä¸‹äº†ä¸¤ç¯‡å‰¯äº§å“ï¼Œéƒ½ä¸ CSS åŸºç¡€ç›¸å…³ï¼Œè¿™æ˜¯ç¬¬ä¸€ç¯‡ï¼Œå¸Œæœ›èƒ½å¯¹å…¶ä»–å¯èƒ½æœ‰ç›¸åŒéœ€è¦çš„åŒå¿—é€ä¸Šä¸€äº›å¸®åŠ©ã€‚</p><a id="more"></a><blockquote><p>æ–‡ç« çš„å†…å®¹åŸºæœ¬æ˜¯ç¿»è¯‘ MDN æ–‡æ¡£æ¥çš„ï¼Œæ€•æœ‰ä»€ä¹ˆé—æ¼çš„åŒå­¦å¯ä»¥ç›´æ¥ç¿»åˆ°æ–‡æœ«çœ‹å®˜æ–‡ï¼Œä¹Ÿæ¬¢è¿æŒ‡å‡ºæœ¬æ–‡çš„é”™è¯¯ :)</p></blockquote><h2 id="css-æ˜¯æ€ä¹ˆä½œç”¨åˆ°-html-ä¸Šçš„ï¼Ÿ">CSS æ˜¯æ€ä¹ˆä½œç”¨åˆ° HTML ä¸Šçš„ï¼Ÿ</h2><p>ç½‘é¡µæµè§ˆå™¨ä¼šæŠŠ CSS è§„åˆ™åº”ç”¨åˆ°æ–‡æ¡£ä¸Šï¼Œä»¥æ”¹å˜æ–‡æ¡£å†…å®¹çš„è¡¨ç°å½¢å¼ï¼Œä¸€ä¸ªå•ä¸€çš„ CSS è§„åˆ™æ˜¯ç”±ä¸‹é¢è¿™ä¸¤ä¸ªä¸œè¥¿ç»„æˆçš„ï¼š</p><ol><li>ä¸€ç»„å±æ€§ï¼ˆPropertiesï¼‰ï¼šè¿™äº›å‚æ•°ä¼šæ›´æ–° HTML çš„å†…å®¹ï¼Œè®©å®ƒåœ¨æ˜¾ç¤ºçš„æ—¶å€™ä¸ä¼—ä¸åŒ</li><li>ä¸€ä¸ªé€‰æ‹©å™¨ï¼ˆSelectorï¼‰ï¼šç”¨æ¥æŒ‘é€‰è¦ä½œç”¨åˆ°å“ªä¸ªå…ƒç´ ä¸Š</li></ol><p>ä¸€ä¸ª CSS è§„åˆ™çº¦å®šäº†æŸä¸ªå…ƒç´ é•¿ä»€ä¹ˆæ ·ï¼Œä¸€ä¸ªåŒ…å«äº†ä¸€ç»„ CSS è§„åˆ™ï¼ˆRulesets/Rulesï¼‰çš„ <code>stylesheet</code> å°±å®šä¹‰äº†ä¸€ä¸ªç½‘é¡µçš„é•¿ç›¸ã€‚</p><h3 id="ä¸¾ä¸ªä¾‹å­">ä¸¾ä¸ªä¾‹å­</h3><p>æ¥çœ‹ä¸€ä¸ªç®€å•çš„ HTML æ–‡æ¡£ï¼Œè¿™ä¸ªä¾‹å­é‡ŒåŒ…å«äº† <code>&lt;h1&gt;</code> å’Œ <code>&lt;p&gt;</code> æ ‡ç­¾ï¼Œè€Œ <code>stylesheet</code> åˆ™æ˜¯é€šè¿‡ <code>&lt;link&gt;</code> å…ƒç´ å®ç°çš„ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>My CSS experiment<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"style.css"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello World!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>This is my first CSS example<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶åçœ‹ä¸¤ä¸ª CSS çš„è§„åˆ™ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">h1</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: blue;</span><br><span class="line">  <span class="attribute">background-color</span>: yellow;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid black;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: red;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¿™ä¸¤ä¸ª CSS è§„åˆ™æ˜¯å†™åœ¨ <em>style.css</em> æ–‡ä»¶é‡Œçš„ï¼Œè·Ÿä¸Šé¢çš„ <em>.html</em> æ–‡ä»¶æ”¾åœ¨ä¸€èµ·å°±å¯ä»¥é€šè¿‡ç›¸å¯¹è·¯å¾„å¼•ç”¨åˆ°</p></blockquote><p>å¤§æ‹¬å·ç­¾åçš„æ ‡ç­¾ï¼ˆ<code>h1</code> å’Œ <code>p</code>ï¼‰å°±æ˜¯é€‰æ‹©å™¨ï¼Œå®ƒå‘Šè¯‰æµè§ˆå™¨è¿™äº›è§„åˆ™è¦ä½œç”¨åœ¨ä»€ä¹ˆæ ‡ç­¾ä¸Šï¼›è€Œå¤§æ‹¬å·é‡Œçš„é”®å€¼å¯¹å°±çº¦å®šäº†è¿™äº›æ ‡ç­¾çš„å†…å®¹çš„æ˜¾ç¤ºè§„åˆ™ã€‚</p><h2 id="åŸç†å‘¢ï¼Ÿ">åŸç†å‘¢ï¼Ÿ</h2><p>æµè§ˆå™¨åœ¨å¤„ç†ç½‘é¡µçš„æ—¶å€™ï¼Œä¼šåˆ†ä¸¤æ­¥èµ°ï¼š</p><ol><li>æŠŠ HTML å’Œ CSS è½¬æ¢ä¸º DOMï¼ŒDOM ä¼šæŠŠå†…å®¹å’Œæ ·å¼èåˆåˆ°ä¸€èµ·</li><li>æŠŠ DOM çš„å†…å®¹æ˜¾ç¤ºå‡ºæ¥<br><img src="/uploads/How-CSS-works/D90AF498-F58B-4AEF-91B9-9E38F4863B92.png" alt="DOM"></li></ol><h2 id="ä»‹ç»ä¸€ä¸‹-dom">ä»‹ç»ä¸€ä¸‹ DOM</h2><p>ä¸€ä¸ª DOM çš„å†…å®¹æ˜¯ä»¥æ ‘çŠ¶ç»“æ„ä¿å­˜çš„ã€‚æ¯ä¸ªé€šè¿‡ markup è¯­è¨€è¡¨è¿°çš„å…ƒç´ ã€å±æ€§ã€æ–‡å­—ç­‰ä¼šå˜æˆ DOM èŠ‚ç‚¹ä¿å­˜åœ¨æ ‘ä¸Šã€‚</p><h3 id="dom-çš„çœŸé¢ç›®">DOM çš„çœŸé¢ç›®</h3><p>å‡è®¾æˆ‘ä»¬æœ‰ä¸€æ®µ HTML ä»£ç ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">  Let's use:</span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span>Cascading<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span>Style<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span>Sheets<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p>å°†å®ƒè½¬æ¢ä¸º DOM ä¹‹åï¼Œè¿™ä¸ª DOM ä¼šæ˜¯è¿™æ ·çš„ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">P</span><br><span class="line">â”œâ”€ &quot;Let&apos;s use:&quot;</span><br><span class="line">â”œâ”€ SPAN</span><br><span class="line">|  â””â”€ &quot;Cascading&quot;</span><br><span class="line">â”œâ”€ SPAN</span><br><span class="line">|  â””â”€ &quot;Style&quot;</span><br><span class="line">â””â”€ SPAN</span><br><span class="line">   â””â”€ &quot;Sheets&quot;</span><br></pre></td></tr></table></figure><p>ç°åœ¨æ¥åŠ ä¸€ä¸ª CSS çº¦æŸè¯•è¯•ï¼š</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">span</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid black;</span><br><span class="line">  <span class="attribute">background-color</span>: lime;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>emmmâ€¦è¿˜æ˜¯è·Ÿåˆšåˆšä¸€æ ·çš„ DOMï¼Œä¸è¿‡è¿™äº› CSS çº¦æŸä¼šè¢«åŠ åˆ° <code>span</code> é€‰æ‹©å™¨ä¸Šé¢å»ï¼Œäºæ˜¯æ¸²æŸ“å‡ºæ¥çš„æ ·å­å°±ä¸ä¸€æ ·äº†ã€‚</p><h2 id="ä¸‰ç§ä½¿ç”¨-css-çš„æ–¹æ³•">ä¸‰ç§ä½¿ç”¨ CSS çš„æ–¹æ³•</h2><h3 id="å¤–éƒ¨-stylesheet">å¤–éƒ¨ stylesheet</h3><p>å°±æ˜¯ä¸Šé¢ä¾‹å­é‡Œç”¨åˆ°çš„æ–¹æ³•ï¼ŒCSS çº¦æŸæ˜¯å†™åœ¨ä¸€ä¸ªå•ç‹¬çš„ <em>.css</em> æ–‡ä»¶é‡Œçš„</p><h3 id="å†…éƒ¨-stylesheet">å†…éƒ¨ stylesheet</h3><p>å³ç›´æ¥é€šè¿‡ <code>&lt;style&gt;</code> æ ‡ç­¾æ¥å®šä¹‰å…ƒç´ çš„é•¿ç›¸ï¼Œè¿™ä¸ª <code>&lt;style&gt;</code> éœ€è¦å†™åœ¨ <code>&lt;head&gt;</code> æ ‡ç­¾ä¸‹æ‰ä¼šç”Ÿæ•ˆï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>My CSS experiment<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">style</span>&gt;</span></span><br><span class="line">      h1 &#123;</span><br><span class="line">        color: blue;</span><br><span class="line">        background-color: yellow;</span><br><span class="line">        border: 1px solid black;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      p &#123;</span><br><span class="line">        color: red;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Hello World!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>This is my first CSS example<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªä¾‹å­è·Ÿä¹‹å‰çš„ä¾‹å­æ˜¯åŒæ ·æ•ˆæœçš„ã€‚</p><h3 id="å†…è”æ ·å¼">å†…è”æ ·å¼</h3><p>å¯¹äºåªæƒ³æ”¹å˜å•ç‹¬ä¸€ä¸ªæ ‡ç­¾å…ƒç´ çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡æ ‡ç­¾çš„ <code>style</code> å±æ€§å®ç°ï¼š</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>My CSS experiment<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span> <span class="attr">style</span>=<span class="string">"color: blue;background-color: yellow;border: 1px solid black;"</span>&gt;</span>Hello World!<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">"color:red;"</span>&gt;</span>This is my first CSS example<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>ç„¶è€Œè¿™ç§åšæ³•å¹¶æ²¡æœ‰å¾ˆå—å¾…è§ï¼Œå› ä¸ºè¿™æ ·å®šä¹‰çš„æ ·å¼æ²¡åŠæ³•å¤ç”¨ï¼Œä½ å¯èƒ½éœ€è¦åœ¨å¥½å‡ ä¸ªæ–‡æ¡£é‡Œé¢å†™ä¸ŠåŒæ ·çš„å‡ ä¸ªæ ·å¼ï¼Œç»´æŠ¤æˆæœ¬å¤§å¤§å‡é«˜äº†ã€‚</p><p>å¦ä¸€æ–¹é¢ï¼ŒæŠŠ HTML è¯­æ³•è·Ÿ CSS è¯­æ³•æ··åˆåœ¨ä¸€èµ·ï¼Œçœ‹èµ·æ¥å°±ä¸é‚£ä¹ˆæ¸…æ™°æ˜“æ‡‚äº†ï¼Œå»ºè®®æ˜¯æŠŠä¸åŒç±»å‹çš„ä»£ç åˆ†å¼€ï¼Œä¿æŒçº¯ç²¹ã€‚</p><h2 id="å°ç»“">å°ç»“</h2><p>åˆ°è¿™é‡Œï¼Œæˆ‘ä»¬å·²ç»ä¸æ­¢èƒ½å†™ HTML ç½‘é¡µäº†ï¼Œè¿˜èƒ½é€šè¿‡ CSS ç»™è¿™ç®€é™‹çš„ç½‘é¡µæŠ«ä¸Šåä¸½ä¸½çš„å¤–è¡£ã€‚åœ¨ä¸‹ä¸€ç¯‡æ–‡ç« é‡Œï¼Œæˆ‘ä»¬ä¼šç»§ç»­æ·±å…¥å­¦ä¹  CSS çš„å¥æ³•ï¼Œè·ç¦»è¸å…¥å‰ç«¯ä¸–ç•Œçš„å¤§é—¨åˆè¦è¿‘ä¸€äº›äº†ï¼</p><h2 id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </h2><p><a href="https://developer.mozilla.org/en-US/docs/Learn/CSS/Introduction_to_CSS/How_CSS_works" target="_blank" rel="noopener">How CSS works - Learn web development | MDN</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;CSS å…¨ç§° Cascading Style Sheetsï¼Œç½‘é¡µå†…å®¹ï¼ˆHTMLï¼‰ä¼šè¢«æµè§ˆå™¨è½¬æ¢ä¸º DOMï¼ˆDocument Object Modelï¼‰ä»¥ä¾›æ˜¾ç¤ºï¼Œè€Œ CSS å°±æ˜¯ä½œç”¨åœ¨ DOM ä¸Šä»¥æ”¹å˜å®ƒä»¬çš„æ ·å¼ã€å¸ƒå±€æˆ–è¡Œä¸ºç­‰ã€‚å¯¹äºå‰ç«¯å·¥ç¨‹å¸ˆæ¥è¯´ï¼Œè¿™æ˜¯å¾ˆå¸¸è§çš„åŸºæœ¬æ“ä½œäº†ï¼Œä½†æ˜¯å¯¹å…¶ä»–ä¸å¸¸æ•²ç½‘é¡µä»£ç çš„ç¨‹åºå‘˜æ¥è¯´ï¼Œå´å¯èƒ½ä¼šæœ‰äº›é™Œç”Ÿã€‚&lt;/p&gt;
&lt;p&gt;å€Ÿç€æœ€è¿‘å‰ç«¯åŒäº‹äº‹åŠ¡ç¹å¿™çš„æœºä¼šï¼Œæˆ‘è¿™å®¢æˆ·ç«¯å·¥ç¨‹å¸ˆèµ¶é¸­å­ä¸Šæ¶æ€¼äº†ä¸€ä¸ªé™æ€ç½‘é¡µå‡ºæ¥ï¼Œé¡ºä¾¿äº§ä¸‹äº†ä¸¤ç¯‡å‰¯äº§å“ï¼Œéƒ½ä¸ CSS åŸºç¡€ç›¸å…³ï¼Œè¿™æ˜¯ç¬¬ä¸€ç¯‡ï¼Œå¸Œæœ›èƒ½å¯¹å…¶ä»–å¯èƒ½æœ‰ç›¸åŒéœ€è¦çš„åŒå¿—é€ä¸Šä¸€äº›å¸®åŠ©ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="css" scheme="http://davidleee.com/tags/css/"/>
    
      <category term="html" scheme="http://davidleee.com/tags/html/"/>
    
      <category term="web" scheme="http://davidleee.com/tags/web/"/>
    
      <category term="dom" scheme="http://davidleee.com/tags/dom/"/>
    
  </entry>
  
  <entry>
    <title>å…³äº macOS è¾“å…¥æ¡†ä½ éœ€è¦äº†è§£çš„ä¸€äº›åŸºç¡€</title>
    <link href="http://davidleee.com/2018/09/11/the-basic-of-macos-text-view-system/"/>
    <id>http://davidleee.com/2018/09/11/the-basic-of-macos-text-view-system/</id>
    <published>2018-09-11T06:48:40.000Z</published>
    <updated>2020-05-05T03:43:31.445Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>è¿™æ˜¯ macOS å¼€å‘ç³»åˆ—çš„ç¬¬ä¸‰ç¯‡æ–‡ç«  â€”â€” æ–‡æœ¬è¾“å…¥ç³»ç»ŸåŸºç¡€ã€‚</p><p>ç”µè„‘çš„æ–‡å­—ç¼–è¾‘åŠŸèƒ½æ¯”æ‰‹æœºä¸Šçš„å¼ºå¤§ï¼ˆéš¾æï¼‰çœŸä¸æ˜¯å¹ï¼</p></blockquote><a id="more"></a><h2 id="è®¤è¯†è¾“å…¥æ¡†">è®¤è¯†è¾“å…¥æ¡†</h2><blockquote><p>The Macintosh operating system has provided sophisticated text handling and typesetting capabilities from its beginning. In fact, these features sparked the desktop publishing revolution. â€”â€” Apple</p></blockquote><p>åœ¨ macOS çš„ä¸–ç•Œé‡Œï¼Œè¦æ˜¾ç¤ºæˆ–è€…ç¼–è¾‘æ–‡å­—ä¸»è¦ä¼šç”¨åˆ°ä¸¤ä¸ªæ§ä»¶ï¼Œä¸€ä¸ªæ˜¯ <a href="https://developer.apple.com/documentation/appkit/nstextview" target="_blank" rel="noopener">NSTextView</a>ï¼Œå¦ä¸€ä¸ªæ˜¯ <a href="https://developer.apple.com/documentation/appkit/nstextfield" target="_blank" rel="noopener">NSTextField</a>ã€‚</p><blockquote><p>è™½ç„¶æ§ä»¶åº“é‡Œé¢æœ‰ä¸ªå« Label çš„ä¸œè¥¿ï¼Œä½†æ˜¯æ‹–å‡ºæ¥ä¹‹åå°±ä¼šå‘ç°ï¼Œå®ƒå…¶å®ä¹Ÿæ˜¯ä¸€ä¸ª  <a href="https://developer.apple.com/documentation/appkit/nstextfield" target="_blank" rel="noopener">NSTextField</a></p></blockquote><p>å®ƒä»¬çš„ç»§æ‰¿å…³ç³»æ˜¯è¿™æ ·çš„ï¼š<br><img src="/uploads/the-basic-of-macos-text-view-system/7004648D-1B33-476E-8788-8D894D8B08E9.png" alt></p><p>NSTextView æ˜¯è‹¹æœèŠ±äº†å¤§å¿ƒè¡€æ‰“é€ çš„ä¸€ä¸ªâ€œæ»¡è¶³å‡ ä¹æ‰€æœ‰æ˜¾ç¤ºå’Œç®¡ç†æ–‡å­—éœ€æ±‚â€çš„ä¸€ä¸ªæ§ä»¶ï¼Œä¹Ÿæ˜¯ macOS å¼•ä»¥ä¸ºå‚²çš„æ–‡å­—ç¼–è¾‘ç³»ç»Ÿçš„ä¸»å¿ƒéª¨ï¼›NSTextField åˆ™ç›¸å½“äºä¸€ä¸ªç®€åŒ–ç‰ˆçš„ NSTextViewï¼Œåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹å®ƒå¯ä»¥æ»¡è¶³å­—æ•°è¾ƒå°‘çš„è¾“å…¥éœ€æ±‚ã€‚</p><p>æ­£å¦‚æˆ‘ä»¬åœ¨ iOS å¼€å‘é‡Œå¸¸åšçš„é‚£æ ·ï¼Œåœ¨éœ€è¦ç”¨æˆ·è¾“å…¥çš„åœ°æ–¹ï¼Œé€šå¸¸æ˜¯ç›´æ¥å±•ç¤ºä¸€ä¸ª Text ç›¸å…³çš„æ§ä»¶ï¼Œç„¶åé€šè¿‡ delegate æ–¹æ³•æ¥æ§åˆ¶è¾“å…¥çš„å†…å®¹ï¼›åˆæˆ–è€…ç»§æ‰¿ä¸€ä¸ªå®˜æ–¹çš„æ§ä»¶ï¼Œç„¶ååœ¨å†…éƒ¨ç›´æ¥å®ç°æƒ³è¦çš„å†…å®¹æ§åˆ¶é€»è¾‘ã€‚</p><p>åœ¨ macOS ä¸Šï¼Œè¿™ä¸ªæµç¨‹ä¹Ÿæ˜¯å¤§è‡´ç›¸åŒçš„ã€‚</p><blockquote><p>ä»¥å‰å†™è¿‡ä¸€ç¯‡ç®€å•ä»‹ç» NSTextView ç”¨æ³•çš„æ–‡ç« ï¼ˆ <a href="/2017/09/11/Windows-in-macOS/" title="20åˆ†é’Ÿæ‰‹æŠŠæ‰‹æ•™ä½ å†™ macOS æ–‡æœ¬ç¼–è¾‘å™¨">20åˆ†é’Ÿæ‰‹æŠŠæ‰‹æ•™ä½ å†™ macOS æ–‡æœ¬ç¼–è¾‘å™¨</a>ï¼‰ï¼Œç­‰ä¸åŠçš„ç«¥é‹ä»¬å¯ä»¥åœ¨è¿™ç¯‡æ–‡ç« é‡Œè¿‡è¿‡ç˜¾ã€‚</p></blockquote><h2 id="æ–‡æœ¬è¾“å…¥çš„å¹•åç©å®¶">æ–‡æœ¬è¾“å…¥çš„å¹•åç©å®¶</h2><p>è™½ç„¶ä»ä½¿ç”¨ä¸Šæ¥çœ‹ï¼Œè·Ÿå¼€å‘è€…ç›´æ¥æ‰“äº¤é“çš„å°±æ˜¯ NSTextView å’Œ NSTextField è¿™ä¸¤ä¸ªç±»ï¼Œæœ€å¤šå†åŠ ä¸Šå®ƒä»¬å¸¦ç€çš„ä¸€äº›åè®®/ä»£ç†ï¼Œä½†æ˜¯ç»§ç»­å¾€æ·±äº†çœ‹ï¼Œä¼šå‘ç°æœ‰ä¸€ä¸ªæœªçŸ¥çš„ä¸–ç•Œåœ¨æ”¯æ’‘è¿™è¿™ä¸€åˆ‡ã€‚</p><h3 id="field-editor">Field Editor</h3><p>macOS ä¸Šæœ‰ä¸€ä¸ªå« Field Editor çš„æ¦‚å¿µã€‚</p><p>åœ¨è¾“å…¥æ¡†è·å¾—ç„¦ç‚¹çš„æ—¶å€™ï¼Œç³»ç»Ÿä¼šå®ä¾‹åŒ–ä¸€ä¸ª NSTextView ä½œä¸º Field Editorï¼Œå¹¶æŠŠå®ƒä½œä¸º first responder æ’å…¥åˆ°è¿™ä¸ªè¾“å…¥æ¡†çš„äº‹ä»¶å“åº”é“¾å½“ä¸­ã€‚å¦‚æ­¤ä¸€æ¥ï¼ŒField Editor ä¼šè´Ÿè´£å¤„ç†æ‰€æœ‰çš„ç”¨æˆ·è¾“å…¥äº‹ä»¶ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œè·å¾—ç„¦ç‚¹çš„è¾“å…¥æ¡†ä¼šä½œä¸º Field Editor çš„ä»£ç†ï¼Œä»¥ä¾¿å¯¹æ–‡æœ¬çš„å†…å®¹è¿›è¡Œæ§åˆ¶å¤„ç†ã€‚</p><p><img src="/uploads/the-basic-of-macos-text-view-system/field_editor_2x.png" alt></p><blockquote><p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ NSWindow çš„ <code>firstResponder</code> è¿”å›çš„æ˜¯ä¸€ä¸ªä¸å¯è§çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯æˆ‘ä»¬è·å–äº†ç„¦ç‚¹çš„è¾“å…¥æ¡†ï¼Œå› ä¸ºè¿™ä¸ªå¯¹è±¡å°±æ˜¯ä¸Šé¢è¯´çš„ Field Editorã€‚</p></blockquote><p>Field Editor æ˜¯åŒä¸€ä¸ªçª—å£é‡Œæ‰€æœ‰è¾“å…¥æ¡†å…±ç”¨çš„ï¼Œæ‰€ä»¥åœ¨æˆ‘ä»¬ç”¨ Tab é”®åˆ‡æ¢è¾“å…¥æ¡†çš„æ—¶å€™ï¼ŒField Editor å°±ä¼šåˆ‡æ¢äº‹ä»¶å“åº”çš„å¯¹è±¡ã€‚å¦ä¸€æ–¹é¢ï¼Œè¿™ä¸ªæœºåˆ¶ä¹Ÿç¡®ä¿äº†åŒä¸€ä¸ªçª—å£ä¸­åªèƒ½æœ‰ä¸€ä¸ªæ§ä»¶å»å“åº”ç”¨æˆ·è¾“å…¥äº‹ä»¶ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å®ç°è‡ªå®šä¹‰çš„ Field Editor æ¥æ¨ç¿»ä¸Šé¢è¯´çš„è¿™äº›åŠŸèƒ½ã€‚</p><blockquote><p>è™½ç„¶ Field Editor ä¸€èˆ¬ä¼šæ˜¯ä¸€ä¸ª NSTextView çš„å®ä¾‹ï¼Œä½†æ˜¯å®ƒä»¬å¯¹ Tab å’Œ Return çš„äº‹ä»¶å¤„ç†æ˜¯ä¸åŒçš„ã€‚å¯¹äº Field Editor æ¥è¯´ï¼Œè¿™ä¸¤ä¸ªé”®ç›˜äº‹ä»¶æ˜¯â€œç»“æŸç¼–è¾‘â€çš„æ„æ€ã€‚</p></blockquote><h3 id="nstextinputcontext">NSTextInputContext</h3><p>è¿™æ˜¯å¤–ç•Œå’Œæ–‡æœ¬è¾“å…¥ç³»ç»Ÿä¹‹é—´æ²Ÿé€šçš„æ¡¥æ¢ã€‚</p><p>åœ¨ç”¨æˆ·è¿›è¡Œè¾“å…¥çš„æ—¶å€™ï¼Œ<code>keyDown</code> æ¶ˆæ¯ä¼šè¢«ä¼ é€’åˆ°è·å–äº†ç„¦ç‚¹çš„è¾“å…¥æ¡†é‡Œï¼Œè¾“å…¥æ¡†æ¥ä¸‹æ¥ä¼šè°ƒç”¨ <a href="https://developer.apple.com/documentation/appkit/nstextinputcontext" target="_blank" rel="noopener">NSTextInputContext</a> çš„ <code>handleEvent</code> æ–¹æ³•ï¼Œä»¥ä¾¿è®© NSTextInputContext å‘Šè¯‰è‡ªå·±éœ€è¦æ€ä¹ˆå¤„ç†è¿™ä¸ªç”¨æˆ·äº‹ä»¶ã€‚è€Œä½œä¸ºå“åº”ï¼ŒNSTextInputContext ä¼šæŠŠå¤„ç†ç»“æœé€šè¿‡ <a href="https://developer.apple.com/documentation/appkit/nstextinputclient" target="_blank" rel="noopener">NSTextInputClient</a> è¿™ä¸ªåè®®å‘ŠçŸ¥è¾“å…¥æ¡†ã€‚</p><p><img src="/uploads/the-basic-of-macos-text-view-system/F200783C-8569-4396-BC36-4DAD92E810DF.png" alt></p><p>ä»ä¸Šå›¾å¯ä»¥çœ‹åˆ°ï¼ŒNSTextInputContext ä¼šè·Ÿä¸€ä¸ªå« Key-bindings dictionary çš„å­—å…¸ä¿æŒå¯†åˆ‡è”ç³»ã€‚è¿™ä¸ªå­—å…¸é»˜è®¤æ¥è‡ªäº AppKit å†…éƒ¨çš„ä¸€ä¸ªæ–‡ä»¶ï¼ˆ<em>/System/Library/Frameworks/AppKit.framework/Resources/StandardKeyBinding.dict</em>ï¼‰ï¼Œé‡Œé¢ä¿å­˜äº†ç³»ç»Ÿé»˜è®¤å®šä¹‰å¥½çš„æ‰€æœ‰å¿«æ·é”®ï¼Œåªæœ‰å½“ç”¨æˆ·è¾“å…¥çš„å€¼åœ¨è¿™ä¸ªå­—å…¸é‡Œæ‰¾ä¸åˆ°åŒ¹é…çš„é”®å€¼å¯¹æ—¶ï¼Œè¿™æ¬¡è¾“å…¥æ‰ä¼šä½œä¸ºæ™®é€šå­—ç¬¦å›è°ƒç»™è¾“å…¥æ¡†ï¼Œå¦åˆ™ NSTextInputContext å°±ä¼šåœ¨è¿™é‡ŒæŠŠè¿™æ¬¡è¾“å…¥æ‹¦æˆªä¸‹æ¥ï¼Œå¹¶è®©è¾“å…¥æ¡†æ‰§è¡Œç›¸åº”çš„ç‰¹æ®Šæ“ä½œã€‚</p><blockquote><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿®æ”¹ <em>~/Library/KeyBindings/DefaultKeyBinding.dict</em> é‡Œçš„å€¼æ¥è¦†ç›–é»˜è®¤çš„å¿«æ·é”®</p></blockquote><h2 id="å°ç»“">å°ç»“</h2><p>åˆ°æ­¤ä¸ºæ­¢ï¼ŒmacOS æ–‡æœ¬ç¼–è¾‘ç³»ç»Ÿçš„ä¸€äº›å†…åœ¨æœºç†å·²ç»äº†è§£åœ°å·®ä¸å¤šäº†ã€‚åœ¨å¾€åä½¿ç”¨ NSTextView å’Œ NSTextField çš„è¿‡ç¨‹ä¸­ï¼Œç¢°åˆ°ä¸€äº›ä¸æ˜è§‰å‰çš„é—®é¢˜ä¹Ÿèƒ½æœ‰ä¸ªå¤§æ¦‚çš„é—®é¢˜æ’æŸ¥æ–¹å‘äº†ã€‚ï¼ˆä¸è¿‡ä¹Ÿä»…é™äºâ€œå¤§æ¦‚æ–¹å‘â€äº†ï¼‰</p><p>å¥½å§ï¼Œæˆ‘çŸ¥é“è¿™ç¯‡æ–‡ç« åç†è®ºäº†ä¸€äº›ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ä¹Ÿä¸ä¼šç”¨åˆ°ã€‚æ›´å¤šè¯¦ç»†çš„è¯´æ˜å¯ä»¥åœ¨æ–‡ç« é‡Œæä¾›çš„å„ç§é“¾æ¥ä¸Šæ‰¾åˆ°ã€‚</p><p>åœ¨åç»­çš„æ–‡ç« é‡Œï¼Œè¿˜ä¼šè®²åˆ° NSTextField å®é™…åº”ç”¨ä¸Šçš„ä¸€äº›å†…å®¹ã€‚NSTextView å› ä¸ºæš‚æ—¶æ²¡æœ‰ç”¨ä¸Šï¼Œæ‰€ä»¥å¯èƒ½ä¼šç­‰æœ‰æœºä¼šç ”ç©¶æ¸…æ¥šäº›å†è®²å’¯ã€‚</p><h2 id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </h2><p><a href="https://developer.apple.com/library/archive/documentation/TextFonts/Conceptual/CocoaTextArchitecture/Introduction/Introduction.html#//apple_ref/doc/uid/TP40009459-CH1-SW1" target="_blank" rel="noopener">About the Cocoa Text System</a></p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;è¿™æ˜¯ macOS å¼€å‘ç³»åˆ—çš„ç¬¬ä¸‰ç¯‡æ–‡ç«  â€”â€” æ–‡æœ¬è¾“å…¥ç³»ç»ŸåŸºç¡€ã€‚&lt;/p&gt;
&lt;p&gt;ç”µè„‘çš„æ–‡å­—ç¼–è¾‘åŠŸèƒ½æ¯”æ‰‹æœºä¸Šçš„å¼ºå¤§ï¼ˆéš¾æï¼‰çœŸä¸æ˜¯å¹ï¼&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="macOS" scheme="http://davidleee.com/tags/macOS/"/>
    
      <category term="AppKit" scheme="http://davidleee.com/tags/AppKit/"/>
    
      <category term="NSTextField" scheme="http://davidleee.com/tags/NSTextField/"/>
    
      <category term="Cocoa" scheme="http://davidleee.com/tags/Cocoa/"/>
    
      <category term="NSTextView" scheme="http://davidleee.com/tags/NSTextView/"/>
    
      <category term="Text System" scheme="http://davidleee.com/tags/Text-System/"/>
    
      <category term="Field Editor" scheme="http://davidleee.com/tags/Field-Editor/"/>
    
  </entry>
  
  <entry>
    <title>react-navigation-redux-helpers ä» v1 åˆ° v2</title>
    <link href="http://davidleee.com/2018/09/10/upgrade-react-navigation-redux-helpers-to-v2/"/>
    <id>http://davidleee.com/2018/09/10/upgrade-react-navigation-redux-helpers-to-v2/</id>
    <published>2018-09-10T08:40:21.000Z</published>
    <updated>2020-05-05T03:43:31.445Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ä½¿ç”¨ <a href="https://reactnavigation.org" target="_blank" rel="noopener">React Navigation</a> çš„é¡¹ç›®ä¸­ï¼Œæƒ³è¦é›†æˆ redux å°±å¿…é¡»è¦å¼•å…¥ <a href="https://github.com/react-navigation/react-navigation-redux-helpers" target="_blank" rel="noopener">react-navigation-redux-helpers</a> è¿™ä¸ªåº“ã€‚æœ€è¿‘æ•´ç†ç¬¬ä¸‰æ–¹åº“çš„æ—¶å€™ï¼Œå‘ç°è¿™ä¸¤ä¸ªåº“çš„ç‰ˆæœ¬éƒ½æ¯”è¾ƒæ—§äº†ï¼Œåœ¨å°è¯•æ›´æ–°çš„æ—¶å€™è¸©äº†ä¸€äº›å‘ï¼Œäºæ˜¯å°±æœ‰äº†è¿™ç¯‡æ–‡ç« ã€‚</p><a id="more"></a><h2 id="navigator">Navigator</h2><p>å‡çº§ä¹‹åï¼Œé…ç½®ä¸Šå”¯ä¸€çš„ä¸åŒåœ¨äº v2 ç‰ˆæœ¬ä¸­å¹²æ‰äº† <code>createReduxBoundAddListener(Key)</code> æ–¹æ³•ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ <code>reduxifyNavigator(Navigator, Key)</code>ã€‚</p><p>åœ¨ v1 ç‰ˆæœ¬ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æŠŠå‰è€…æ„é€ å‡ºæ¥çš„ <code>addListener</code> ä½œä¸ºå‚æ•°ä¼ ç»™ AppNavigatorï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  StackNavigator,</span><br><span class="line">  addNavigationHelpers,</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'react-navigation'</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  createReduxBoundAddListener</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'react-navigation-redux-helpers'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> AppNavigator = StackNavigator(AppRouteConfigs)</span><br><span class="line"><span class="keyword">const</span> addListener = createReduxBoundAddListener(<span class="string">"root"</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">App</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;AppNavigator navigation=&#123;addNavigationHelpers(&#123;</span><br><span class="line">        dispatch: <span class="keyword">this</span>.props.dispatch,</span><br><span class="line">        state: <span class="keyword">this</span>.props.nav,</span><br><span class="line">        addListener, <span class="comment">// --&gt; å°±æ˜¯è¿™é‡Œ</span></span><br><span class="line">      &#125;)&#125; /&gt;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è€Œåœ¨ v2 ç‰ˆæœ¬ä¸­ï¼Œä½¿ç”¨æ–°æ–¹æ³•å¯ä»¥ç®€åŒ–ä¸Šè¿°æ­¥éª¤ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  createStackNavigator, <span class="comment">// new creator of StackNavigator</span></span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'react-navigation'</span></span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  reduxifyNavigator</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">'react-navigation-redux-helpers'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> AppNavigator = createStackNavigator(AppRouteConfigs)</span><br><span class="line"><span class="keyword">const</span> App = reduxifyNavigator(AppNavigator, <span class="string">"root"</span>) <span class="comment">// --&gt; å¹²å‡€æ¸…çˆ½ï¼</span></span><br></pre></td></tr></table></figure><h2 id="mapstatetoprops">mapStateToProps</h2><p>åŸæ¥ <code>state.nav</code> å¯¹åº”çš„ <code>props</code> é”®å« â€œnavâ€ï¼Œç°åœ¨æ”¹ä¸º â€œstateâ€ äº†ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// v1</span></span><br><span class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state</span>) =&gt;</span> (&#123;</span><br><span class="line">  nav: state.nav</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// v2</span></span><br><span class="line"><span class="keyword">const</span> mapStateToProps = <span class="function">(<span class="params">state</span>) =&gt;</span> (&#123;</span><br><span class="line">  state: state.nav, <span class="comment">// nav -&gt; state</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>å¦å¤–ï¼Œä¹‹å‰ä¸ºäº†å¤„ç† Android è¿”å›æŒ‰é’®çš„é—®é¢˜ï¼Œå¯èƒ½ä¼šè‡ªå®šä¹‰ä¸€ä¸ªç±»åŒ…è£¹ç€ä¸Šé¢æ„é€ å‡ºæ¥çš„ AppNavigatorï¼Œç„¶åé€šè¿‡ react-redux çš„ <code>connect</code> æ–¹æ³•æŠŠ <code>mapStateToProps</code> ç»™ä½œç”¨åˆ°è¿™ä¸ªè‡ªå®šä¹‰çš„ç±»ä¸Šå»ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ReduxNavigation</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* additional setup for back button handling */</span></span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="comment">/* more setup code here! this is not a runnable snippet */</span>*</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">AppNavigator</span> <span class="attr">navigation</span>=<span class="string">&#123;navigation&#125;</span> /&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> connect(mapStateToProps)(ReduxNavigation)</span><br></pre></td></tr></table></figure><p>ç»æµ‹è¯•å‘ç°ï¼Œåœ¨ v2 ç‰ˆæœ¬é‡Œï¼Œè¿™ç§æ“ä½œä¼šæŠ¥ â€œundefined is not an object(evaluating â€˜state.routesâ€™)â€ çš„é”™è¯¯ï¼ŒçŒœæµ‹å¯èƒ½è·Ÿ Props çš„é”®å€¼å˜åŒ–æœ‰å…³ã€‚æŠŠ <code>connect</code> çš„è°ƒç”¨æå‰ï¼Œè®©å®ƒå…ˆä½œç”¨åˆ° AppNavigator å†åŒ…è£¹åˆ°è‡ªå®šä¹‰ç±»é‡Œé¢å³å¯ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> ConnectedNavigator = connect(mapStateToProps)(AppNavigator)</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ReduxNavigation</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* additional setup for back button handling */</span></span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="comment">/* more setup code here! this is not a runnable snippet */</span>*</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">ConnectedNavigator</span> <span class="attr">navigation</span>=<span class="string">&#123;navigation&#125;/</span>&gt;</span></span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> ReduxNavigation</span><br></pre></td></tr></table></figure><h2 id="full-example">Full Example</h2><p>å¯¹äºåŒä¸€ä¸ª Navigatorï¼Œ <code>reduxifyNavigator</code> å¦‚æœåœ¨ <code>connect</code> ä¹‹åè°ƒç”¨ï¼Œä¼šæŠ¥é‡å¤å®šä¹‰<code>navigation</code> å±æ€§çš„é”™è¯¯ã€‚æ‰€ä»¥åŠ ä¸Šå‰é¢çš„é…ç½®è¿‡ç¨‹ï¼Œå®Œæ•´çš„ä¾‹å­åº”è¯¥é•¿è¿™æ ·ï¼š</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* importing the whole world */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> AppNavigator = createStackNavigator(AppRouteConfigs)</span><br><span class="line"><span class="comment">// ä¸‹é¢ä¸¤å¥é¡ºåºä¸èƒ½å˜</span></span><br><span class="line"><span class="keyword">const</span> App = reduxifyNavigator(AppNavigator, <span class="string">"root"</span>)</span><br><span class="line"><span class="keyword">const</span> ConnectedNavigator = connect(mapStateToProps)(App)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ReduxNavigation</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* additional setup for back button handling */</span></span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="comment">/* more setup code here! this is not a runnable snippet */</span>*</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">ConnectedNavigator</span>/&gt;</span></span> <span class="comment">// ä¸éœ€è¦ `navigation` å‚æ•°äº†</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> ReduxNavigation</span><br></pre></td></tr></table></figure><h2 id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </h2><p><a href="https://reactnavigation.org/docs/en/redux-integration.html" target="_blank" rel="noopener">Redux integration Â· React Navigation</a><br><a href="https://v1.reactnavigation.org/docs/redux-integration.html" target="_blank" rel="noopener">Redux integration Â· React Navigation (v1)</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨ä½¿ç”¨ &lt;a href=&quot;https://reactnavigation.org&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;React Navigation&lt;/a&gt; çš„é¡¹ç›®ä¸­ï¼Œæƒ³è¦é›†æˆ redux å°±å¿…é¡»è¦å¼•å…¥ &lt;a href=&quot;https://github.com/react-navigation/react-navigation-redux-helpers&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;react-navigation-redux-helpers&lt;/a&gt; è¿™ä¸ªåº“ã€‚æœ€è¿‘æ•´ç†ç¬¬ä¸‰æ–¹åº“çš„æ—¶å€™ï¼Œå‘ç°è¿™ä¸¤ä¸ªåº“çš„ç‰ˆæœ¬éƒ½æ¯”è¾ƒæ—§äº†ï¼Œåœ¨å°è¯•æ›´æ–°çš„æ—¶å€™è¸©äº†ä¸€äº›å‘ï¼Œäºæ˜¯å°±æœ‰äº†è¿™ç¯‡æ–‡ç« ã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="react-native" scheme="http://davidleee.com/tags/react-native/"/>
    
      <category term="react-navigation" scheme="http://davidleee.com/tags/react-navigation/"/>
    
      <category term="redux" scheme="http://davidleee.com/tags/redux/"/>
    
      <category term="react-navigation-redux-helpers" scheme="http://davidleee.com/tags/react-navigation-redux-helpers/"/>
    
  </entry>
  
  <entry>
    <title>è®©äººçœ¼èŠ±ç¼­ä¹±çš„ macOS èœå•</title>
    <link href="http://davidleee.com/2018/08/22/how-menus-work/"/>
    <id>http://davidleee.com/2018/08/22/how-menus-work/</id>
    <published>2018-08-22T09:44:37.000Z</published>
    <updated>2020-05-05T03:43:31.443Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>è¿™æ˜¯ macOS å¼€å‘ç³»åˆ—çš„ç¬¬äºŒç¯‡æ–‡ç« â€”â€”è®©äººçœ¼èŠ±ç¼­ä¹±çš„ macOS èœå•ã€‚</p><p>è¿™æœ‰ä»€ä¹ˆå¥½è¯´çš„ï¼Œä½ ä¸è¦éª—æˆ‘ï¼æ‰‹æœºä¸Šçš„èœå•éƒ½æ˜¯æˆ‘ç”¨è‡ªå®šä¹‰è§†å›¾æ’¸å‡ºæ¥çš„ï¼</p></blockquote><a id="more"></a><h2 id="èœå•çš„ç±»å‹">èœå•çš„ç±»å‹</h2><p>åœ¨ macOS å¼€å‘ä¸­ï¼Œæ‰€è°“â€œèœå•â€å¹¶ä¸åªæ˜¯ä¸€ä¸ªè‡ªå®šä¹‰è§†å›¾äº†ï¼ˆè™½ç„¶è‡ªå®šä¹‰è§†å›¾ä¹Ÿå¯ä»¥å®ç°ï¼‰ï¼Œåœ¨ AppKit é‡Œé¢åå­—ç›´æ¥å«â€œèœå•â€çš„ç±»å°±å äº†ä¸¤å¸­ä¹‹åœ°ï¼Œåˆ†åˆ«æ˜¯ <a href="https://developer.apple.com/documentation/appkit/nsmenu" target="_blank" rel="noopener">NSMenu</a> å’Œ <a href="https://developer.apple.com/documentation/appkit/nsmenuitem" target="_blank" rel="noopener">NSMenuItem</a>ã€‚</p><p>åœ¨å®é™…åº”ç”¨ä¸­ï¼Œèœå•å¯¹åº”äº† 5 ç§è¡¨ç°å½¢å¼ï¼š</p><ul><li><p>åº”ç”¨çš„èœå•æ ï¼Œåœ¨å±å¹•çš„æœ€ä¸Šæ–¹<br><img src="/uploads/how-menus-work/D54DBE49-05EB-4638-AEC3-FA37D500ECC7.png" alt></p></li><li><p>å¼¹å‡ºèœå•ï¼Œå¯ä»¥å‡ºç°åœ¨å½“å‰çª—å£ä¸­çš„ä»»ä½•åœ°æ–¹<br><img src="/uploads/how-menus-work/3D50179E-F77C-4A53-85E5-9296B53895D7.png" alt></p></li><li><p>çŠ¶æ€æ ï¼Œä»å±å¹•ä¸Šæ–¹çš„èœå•æ å³è¾¹å¼€å§‹å‘å·¦å»¶ä¼¸<br><img src="/uploads/how-menus-work/WX20180821-170602@2x.png" alt></p></li><li><p>â€œä¸Šä¸‹æ–‡èœå•â€ï¼ˆContextual Menusï¼‰ï¼Œç‚¹å‡»å³é”®æˆ– â€œcontrol + å·¦é”®â€ è§¦å‘<br><img src="/uploads/how-menus-work/56863C68-CAB1-4BCE-B0DD-82C7E4C03F5F.png" alt></p></li><li><p>Dock èœå•ï¼Œå¯¹ç¨‹åºåï¼ˆDockï¼‰çš„åº”ç”¨å›¾ç‰‡ç‚¹å‡»å³é”®æˆ– â€œcontrol + å·¦é”®â€ è§¦å‘<br><img src="/uploads/how-menus-work/4948EFFA-1E19-4922-AB52-5FD4518F4268.png" alt></p></li></ul><p>çœ‹ç€æŒºå¤šï¼Œä½†æ˜¯ç”¨èµ·æ¥å€’æ˜¯æŒºç®€å•æ–¹ä¾¿çš„ã€‚ä¸‹é¢å°±æŠŠè¿™å‡ ä¸ªæ–°ç©å…·éƒ½æ‹‰å‡ºæ¥æºœä¸€æºœï½</p><h2 id="åº”ç”¨èœå•æ -application-menu">åº”ç”¨èœå•æ ï¼ˆApplication Menuï¼‰</h2><p>è¿™ä¸ªèœå•æ åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ï¼ˆ<a href="/2018/08/21/storyboard-in-macos/" title="ä¸ä¸€æ ·çš„ macOS Storyboard">ä¸ä¸€æ ·çš„ macOS Storyboard</a>ï¼‰é‡Œå·²ç»çº ç»“è¿‡äº†ã€‚</p><p>æ¦‚æ‹¬ä¸€ä¸‹ï¼šæ¯ä¸ªåº”ç”¨åˆå§‹åŒ–çš„æ—¶å€™å°±è‡ªå¸¦äº†ä¸€ä¸ªåº”ç”¨èœå•æ ï¼Œå¦‚æœæ˜¯ä½¿ç”¨ Storyboard å¼€å‘çš„é¡¹ç›®ï¼Œåœ¨ â€œMain.storyboardâ€ é‡Œé¢å°±å¯ä»¥ç›´æ¥å¯¹è¿™ä¸ªèœå•æ è¿›è¡Œå„ç§å„æ ·åŠŸèƒ½ä¸Šçš„è°ƒæ•´äº†ï¼ˆä¹Ÿå°±é™äºé€»è¾‘ï¼Œæ ·å­å¤§æ¦‚æ˜¯æ”¹ä¸åŠ¨äº†ï¼Œåªèƒ½ç”¨ç³»ç»Ÿæ§ä»¶â€¦ï¼‰</p><h2 id="å¼¹å‡ºèœå•-pop-up-menu">å¼¹å‡ºèœå•ï¼ˆPop-up Menuï¼‰</h2><p>è¿™ç§èœå•çš„å«ä¹‰æ¯”è¾ƒå®½æ³›ï¼Œæ‰€æœ‰åœ¨å½“å‰çª—å£é‡Œé¢å‡ºç°çš„ã€å¸¦æœ‰â€œå¼¹å‡ºâ€æ„Ÿè§‰çš„èœå•éƒ½å¯ä»¥å±äºè¿™ä¸€ç±»ã€‚ä»è§†è§‰ä¸Šå¤§è‡´å¯ä»¥åˆ†æˆä¸¤ç§ï¼šå¯¹è¯æ¡†å‹ &amp; æŒ‰é’®å‹ã€‚</p><h3 id="å¯¹è¯æ¡†å‹">å¯¹è¯æ¡†å‹</h3><p>è¿™ä¸­æ–‡åæ˜¯æˆ‘è‡ªå·±å–çš„â€¦å› ä¸ºå®ƒé•¿å¾—åƒå‘€ï¼å®ƒå°±æ˜¯ä¸Šé¢ç±»å‹ä»‹ç»é‡Œçš„å›¾ç‰‡æ‰€ç¤ºçš„æ ·å­ï¼Œå¯¹åº”çš„ç±»æ˜¯ <a href="https://developer.apple.com/documentation/appkit/nspopover" target="_blank" rel="noopener">NSPopover</a>ã€‚</p><p>è¿™ç©æ„å„¿åœ¨ iOS 9 å’Œæ›´è€çš„ç‰ˆæœ¬ä¸­æœ‰ç±»ä¼¼çš„ç”¨æ³•å« <a href="https://developer.apple.com/documentation/uikit/uipopovercontroller" target="_blank" rel="noopener">UIPopoverController</a>ï¼Œåœ¨ iOS 9 ä¹‹åå°±å˜æˆäº† UIViewController çš„ä¸€ç§å±•ç°æ–¹å¼äº†ï¼Œå…·ä½“å‚è§ <a href="https://developer.apple.com/documentation/uikit/uipopoverpresentationcontroller" target="_blank" rel="noopener">UIPopoverPresentationController</a>ã€‚</p><p>NSPopover ç”¨èµ·æ¥è·Ÿä¸Šé¢è¯´çš„å‡ ä¸ªç±»ä¹Ÿæ˜¯å·®ä¸å¤šçš„ï¼Œåªæ˜¯å®ƒæœ¬èº«ä¸æ˜¯ä¸€ä¸ª ViewControllerï¼Œæ‰€ä»¥åœ¨å±•ç¤ºä¹‹å‰éœ€è¦å…ˆè®¾ç½® <code>contentViewController</code> ä»¥è´Ÿè´£ç•Œé¢çš„æ˜¾ç¤ºã€‚</p><p>æ›´å¤šé£éªšçš„ç”¨æ³•è¿˜æ˜¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ä¸ºå¥½ -  <a href="https://developer.apple.com/documentation/appkit/nspopover" target="_blank" rel="noopener">NSPopover</a>ã€‚</p><h3 id="æŒ‰é’®å‹">æŒ‰é’®å‹</h3><p>é¡¾åæ€ä¹‰ï¼Œè¿™æ˜¯ä¸ªçœ‹èµ·æ¥å¾ˆåƒæŒ‰é’®çš„èœå•ï¼Œæ‰“å¼€ç³»ç»Ÿåå¥½è®¾ç½® -&gt; é€šç”¨ï¼Œå°±èƒ½è§åˆ°å¤§æŠŠçš„æŒ‰é’®å‹å¼¹å‡ºèœå•ï¼Œå®ƒä»¬å¯¹åº”çš„ç±»æ˜¯ <a href="https://developer.apple.com/documentation/appkit/nspopupbutton" target="_blank" rel="noopener">NSPopUpButton</a>ã€‚</p><p>åœ¨ xib æˆ–è€… storyboard é‡Œé¢æ‹–ä¸€ä¸ªå‡ºæ¥ï¼Œèƒ½çœ‹åˆ°å®ƒè·Ÿæ™®é€šæŒ‰é’®ç›¸æ¯”å¤šå‡ºäº†è¿™ä¹ˆä¸€äº›ç‹¬æœ‰çš„é…ç½®ï¼š<br><img src="/uploads/how-menus-work/A7088EFE-96C5-4124-BA69-05E917716EB1.png" alt></p><p>å…¶ä¸­ â€œTypeâ€ éƒ¨åˆ†æœ‰ä¸¤ä¸ªå¯é€‰å€¼ï¼šPop up &amp; Pull Downï¼Œå®ƒä»¬æœ€ç›´è§‚çš„åŒºåˆ«åœ¨äºæŒ‰é’®åé¢è·Ÿç€çš„è“è‰²éƒ¨åˆ†ï¼Œå‰è€…æ˜¯ä¸Šä¸‹ç®­å¤´ï¼Œåè€…åˆ™åªæœ‰ä¸€ä¸ªå‘ä¸‹çš„ç®­å¤´ï¼š<br><img src="/uploads/how-menus-work/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-08-22%20%E4%B8%8B%E5%8D%884.40.57.png" alt></p><p>å½“ç„¶ï¼Œå®ƒä»¬åœ¨åˆ—è¡¨å±•å¼€æ–¹å¼å’Œä½¿ç”¨åœºæ™¯ä¸Šä¹Ÿæ˜¯ä¸ä¸€æ ·çš„ï¼Œæƒ³è¦è¿½ç©¶å…¶ä¸­ç»†èŠ‚çš„ç«¥é‹ä»¬ï¼Œæ¨èä¸€ç¯‡å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://developer.apple.com/library/archive/documentation/Cocoa/Conceptual/MenuList/Articles/ManagingPopUpItems.html#//apple_ref/doc/uid/20000274-BAJDEEJA" target="_blank" rel="noopener">Managing Pop-Up Buttons and Pull-Down Lists</a></p><h2 id="çŠ¶æ€æ -status-bar">çŠ¶æ€æ ï¼ˆStatus Barï¼‰</h2><p>ä½œä¸ºä¸€ä¸ªä¸­è§„ä¸­çŸ©çš„èœå•ï¼ŒçŠ¶æ€æ èœå•ä¹Ÿæ˜¯ç”±ä¸¤ä¸ªéƒ¨ä»¶ç»„æˆçš„ï¼š<a href="https://developer.apple.com/documentation/appkit/nsstatusbar" target="_blank" rel="noopener">NSStatusBar</a> &amp; <a href="https://developer.apple.com/documentation/appkit/nsstatusitem" target="_blank" rel="noopener">NSStatusItem</a>ï¼Œä»åå­—å°±èƒ½çœ‹å‡ºå®ƒä»¬çš„å…³ç³»äº†ï¼Œå…·ä½“ç”¨æ³•ä¹Ÿæ˜¯çœ‹æ–‡æ¡£å’¯ã€‚</p><blockquote><p>é¢å¤–æ¨èä¸€ç¯‡å¾ˆè¯¦ç»†çš„æ–‡ç« ï¼š<a href="https://www.raywenderlich.com/450-menus-and-popovers-in-menu-bar-apps-for-macos" target="_blank" rel="noopener">Menus and Popovers in Menu Bar Apps for macOS | Ray Wenderlich</a></p></blockquote><p>æ ¹æ®å®˜æ–¹çš„è¯´æ³•ï¼ŒçŠ¶æ€æ çš„ä½ç½®ç¨€ç¼ºï¼Œä¸ä¿è¯ä½ åº”ç”¨çš„èœå•åœ¨ä¸Šé¢ä¸€ç›´æ˜¯å¯ç”¨çš„ï¼Œæ‰€ä»¥å»ºè®®æŠŠå®ƒæ”¾åœ¨æœ€åè€ƒè™‘ï¼ˆæ˜¯çš„ï¼Œç”šè‡³åœ¨ Dock Menu ä¹‹åï¼‰ã€‚åšäº‹æ¯”è¾ƒå…‹åˆ¶çš„å¾®ä¿¡åªæŠŠå®ƒç”¨æ¥æ˜¾ç¤ºæœªè¯»æ¶ˆæ¯æ¡æ•°ï¼Œç‚¹å‡»å›è°ƒä¹Ÿåªæ˜¯æ‰“å¼€å¾®ä¿¡ä¸»çª—å£è€Œå·²ã€‚</p><p>è€Œä¸”è‹¹æœè¿˜å»ºè®®æˆ‘ä»¬æä¾›ä¸€ä¸ªéšè—çš„é€‰é¡¹ï¼Œåœ¨å¿…è¦æ—¶ç»™ç”¨æˆ·éšè—æ‰æˆ‘ä»¬çŠ¶æ€æ å›¾æ ‡çš„æœºä¼šã€‚</p><p>Emmmâ€¦.è™½ç„¶è‹¹æœçš„è¯æˆ‘ä»¬ä¹Ÿä¸ä¸€å®šå¬å°±æ˜¯äº†â€¦</p><h2 id="ä¸Šä¸‹æ–‡èœå•-contextual-menus">â€œä¸Šä¸‹æ–‡èœå•â€ï¼ˆContextual Menusï¼‰</h2><p>ä¹Ÿå°±æ˜¯ä¿—ç§°çš„å³é”®èœå•ï¼Ÿ</p><blockquote><p>macOS ä¸Šè¿˜å¯ä»¥ç”¨ control + å·¦é”®è§¦å‘</p></blockquote><p>å®ƒè·Ÿåº”ç”¨èœå•æ ä¸€æ ·ï¼Œæ˜¯é€šè¿‡æœ€å¸¸è§çš„èœå•æ ·å¼æ¥å±•ç°çš„ï¼Œå¯¹åº”çš„ç±»æ˜¯ï¼š <a href="https://developer.apple.com/documentation/appkit/nsmenu" target="_blank" rel="noopener">NSMenu</a> &amp; <a href="https://developer.apple.com/documentation/appkit/nsmenuitem" target="_blank" rel="noopener">NSMenuItem</a>ã€‚</p><p>å”¯ä¸€ä¸åŒçš„æ˜¯ï¼Œå®ƒä¸æ˜¯é€šè¿‡ç‚¹å‡»ä¸€ä¸ªä»€ä¹ˆæŒ‰é’®å»è§¦å‘çš„ï¼Œè€Œæ˜¯é€šè¿‡é‡è½½ NSView çš„ <code>defaultMenu</code> å±æ€§æ¥å®ç°çš„ï¼Œæˆ‘ä»¬åªéœ€è¦å®šä¹‰å¥½èœå•çš„æ ·å­å’Œå†…éƒ¨é€»è¾‘ï¼Œæ‰“å¼€/æ”¶èµ·èœå•è¿™æ ·çš„çäº‹å°±äº¤ç»™ç³»ç»Ÿå»åšå¥½äº†ã€‚</p><p>åœ¨ xib æˆ– storyboard é‡Œï¼ŒæŠŠèœå•é“¾æ¥åˆ°å…¶ä»–è§†å›¾çš„ Outlets -&gt; menu ä¸Šé¢ï¼ŒåŒæ ·èƒ½å®ç°å³é”®è§¦å‘çš„æ•ˆæœï¼š<br><img src="/uploads/how-menus-work/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202018-08-22%20%E4%B8%8B%E5%8D%885.16.55.png" alt></p><p>è¯è¯´ä¸Šå›¾è¿™ä¸ªç•Œé¢æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ª Contextual Menu å‘¢ã€‚</p><h2 id="dock-èœå•-dock-menu">Dock èœå•ï¼ˆDock Menuï¼‰</h2><p>é˜¿å“ˆï¼è¿™ä¹Ÿæ˜¯ä¸ªæ™®æ™®é€šé€šçš„ Menuï¼Œé€šè¿‡å®ç° <a href="https://developer.apple.com/documentation/appkit/nsdocktileplugin" target="_blank" rel="noopener">NSDockTilePlugIn</a> è¿™ä¸ªåè®®é‡Œçš„ <code>dockMenu()</code> æ–¹æ³•å°±å¯ä»¥è¿”å›ä¸€ä¸ªæˆ‘ä»¬è‡ªå®šä¹‰çš„èœå•å•¦ã€‚</p><p>æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡å®ƒæ¥è‡ªå®šæˆ‘ä»¬çš„åº”ç”¨å›¾æ ‡åœ¨ Dock ä¸Šé¢çš„æ ·å­ï¼Œæ¯”å¦‚åŠ ä¸ªè§’æ ‡æˆ–è€…æ”¹ä¸€ä¸‹å›¾æ ‡é¢œè‰²ä»€ä¹ˆçš„ï¼Œä¸è¿‡åœ¨è¿™æ ·åšä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜éœ€è¦çœ‹çœ‹è¿™ä¸ªç±» <a href="https://developer.apple.com/documentation/appkit/nsdocktile" target="_blank" rel="noopener">NSDockTile</a>ã€‚è¿™å°±è¶…çº²äº†å•Šï¼Œä¸è¯´äº†ä¸è¯´äº†ã€‚</p><h2 id="æ€»ç»“">æ€»ç»“</h2><p>è™½è¯´è‡ªå®šä¹‰è§†å›¾å’Œæ˜¾éšé€»è¾‘ä¹Ÿå¯ä»¥å®ç°èœå•çš„åŠŸèƒ½ï¼Œä½†æ˜¯ AppKit å·²ç»ä¸ºæˆ‘ä»¬å°è£…äº†å¥½å‡ ä¸ªç±»ï¼Œè®©æˆ‘ä»¬å¯ä»¥æ–¹ä¾¿å¿«æ·åœ°æ€¼å‡ºä¸€ä¸ªåŠŸèƒ½ä¸°å¯Œçš„åº”ç”¨äº†ï¼Œå®ƒä»¬æ˜¯ï¼š</p><ul><li><a href="https://developer.apple.com/documentation/appkit/nsmenu" target="_blank" rel="noopener">NSMenu</a> &amp; <a href="https://developer.apple.com/documentation/appkit/nsmenuitem" target="_blank" rel="noopener">NSMenuItem</a></li><li><a href="https://developer.apple.com/documentation/appkit/nspopover" target="_blank" rel="noopener">NSPopover</a> &amp; <a href="https://developer.apple.com/documentation/appkit/nspopupbutton" target="_blank" rel="noopener">NSPopUpButton</a></li><li><a href="https://developer.apple.com/documentation/appkit/nsstatusbar" target="_blank" rel="noopener">NSStatusBar</a> &amp; <a href="https://developer.apple.com/documentation/appkit/nsstatusitem" target="_blank" rel="noopener">NSStatusItem</a></li><li><a href="https://developer.apple.com/documentation/appkit/nsdocktile" target="_blank" rel="noopener">NSDockTile</a> &amp; <a href="https://developer.apple.com/documentation/appkit/nsdocktileplugin" target="_blank" rel="noopener">NSDockTilePlugIn</a></li></ul><p>é™¤äº†ä¸€äº›ç‰¹æ®Šçš„åº”ç”¨ä¹‹å¤–ï¼Œæˆ‘ä»¬çš„ä¸»è¦åŠŸèƒ½åº”è¯¥æ˜¯åœ¨çª—å£é‡Œé¢æä¾›çš„ï¼Œè€Œèœå•é€šå¸¸éƒ½æ˜¯äº›é”¦ä¸Šæ·»èŠ±çš„ä¸œè¥¿ã€‚ä¸è¿‡åœ¨æœ‰ä½™åŠ›çš„æ—¶å€™ï¼Œä¸ºæˆ‘ä»¬çš„ç”¨æˆ·å¢æ·»ä¸€åˆ†â€œæ„å¤–ä¹‹å–œâ€ä¹Ÿæ˜¯æå¥½çš„å§ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;blockquote&gt;
&lt;p&gt;è¿™æ˜¯ macOS å¼€å‘ç³»åˆ—çš„ç¬¬äºŒç¯‡æ–‡ç« â€”â€”è®©äººçœ¼èŠ±ç¼­ä¹±çš„ macOS èœå•ã€‚&lt;/p&gt;
&lt;p&gt;è¿™æœ‰ä»€ä¹ˆå¥½è¯´çš„ï¼Œä½ ä¸è¦éª—æˆ‘ï¼æ‰‹æœºä¸Šçš„èœå•éƒ½æ˜¯æˆ‘ç”¨è‡ªå®šä¹‰è§†å›¾æ’¸å‡ºæ¥çš„ï¼&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="Swift" scheme="http://davidleee.com/tags/Swift/"/>
    
      <category term="macOS" scheme="http://davidleee.com/tags/macOS/"/>
    
      <category term="AppKit" scheme="http://davidleee.com/tags/AppKit/"/>
    
      <category term="NSMenus" scheme="http://davidleee.com/tags/NSMenus/"/>
    
      <category term="NSPopover" scheme="http://davidleee.com/tags/NSPopover/"/>
    
      <category term="NSPopupButton" scheme="http://davidleee.com/tags/NSPopupButton/"/>
    
      <category term="Dock" scheme="http://davidleee.com/tags/Dock/"/>
    
      <category term="NSDockTile" scheme="http://davidleee.com/tags/NSDockTile/"/>
    
      <category term="NSStatusBar" scheme="http://davidleee.com/tags/NSStatusBar/"/>
    
  </entry>
  
  <entry>
    <title>ä¸ä¸€æ ·çš„ macOS Storyboard</title>
    <link href="http://davidleee.com/2018/08/21/storyboard-in-macos/"/>
    <id>http://davidleee.com/2018/08/21/storyboard-in-macos/</id>
    <published>2018-08-21T01:12:40.000Z</published>
    <updated>2020-05-05T03:43:31.444Z</updated>
    
    <content type="html"><![CDATA[<p>ä» iOS è½¬æ¥ macOS é˜µè¥å·²ç»æœ‰å‡ ä¸ªæœˆäº†ï¼Œæ–­æ–­ç»­ç»­è¸©äº†ä¸€äº›è¿™æ ·é‚£æ ·çš„å‘ï¼Œç‰¹æ­¤å†™ä¸€ä¸ªç³»åˆ—è®°å½•ä¸‹æ¥ã€‚è¿™ä¸ªç³»åˆ—ç¢°åˆ°çš„é—®é¢˜éƒ½æ˜¯å·²ç»æ‰¾åˆ°äº†è§£å†³æ–¹æ³•çš„ï¼Œå¸Œæœ›å¯¹å…¶ä»–äººä¹Ÿèƒ½æœ‰äº›å¸®åŠ©ã€‚</p><blockquote><p>è¿™æ˜¯ macOS å¼€å‘ç³»åˆ—çš„ç¬¬ä¸€ç¯‡æ–‡ç« ã€‚</p><p>ä»é¡¹ç›®å¼€å§‹çš„åœ°æ–¹è®²èµ· â€”â€” Storyboardã€‚</p></blockquote><a id="more"></a><h2 id="main-storyboard">Main.Storyboard</h2><p>æ–°å»º macOS é¡¹ç›®çš„æ—¶å€™ï¼Œå¦‚æœå‹¾ä¸Šäº† â€œUse Storyboardsâ€ çš„è¯ï¼Œå·¥ç¨‹é‡Œä¼šè‡ªå¸¦äº†ä¸€ä¸ª â€œMain.storyboardâ€ã€‚</p><p>æ‰“å¼€çœ‹çœ‹ï¼Œå‘ç°è·Ÿ iOS é¡¹ç›®ä¸­çš„æ ·å­å¤§åŒå°å¼‚ï¼Œä¸åŒçš„åœ°æ–¹åœ¨äºï¼ŒåŸæ¥çš„ â€œNavigation Controllerâ€ åœ¨è¿™é‡Œå˜æˆäº† â€œWindow Controllerâ€ï¼Œè€Œä¸”ä¸Šé¢è¿˜å¤šäº†ä¸€ä¸ªæ²¡è§è¿‡çš„ â€œMain Menuâ€ã€‚ï¼ˆå…³äºèœå•çš„å†…å®¹ä¼šåœ¨ç¬¬ä¸‰ç¯‡æ–‡ç« é‡Œè®²åˆ°ï¼‰</p><p><img src="/uploads/storyboard-in-macos/4BB6559C-64F4-421D-A8D5-6427C96EF774.png" alt></p><p>å¦‚æœæŠŠåº”ç”¨è·‘èµ·æ¥ï¼Œä¼šå‘ç° â€œWindow Controllerâ€ å¯¹åº”çš„æ˜¯åº”ç”¨çš„å¯åŠ¨çª—å£ï¼Œè€Œ â€œMain Menuâ€ å¯¹åº”çš„æ˜¯æ˜¾ç¤ºåœ¨é¡¶éƒ¨çš„ç³»ç»Ÿèœå•æ ã€‚</p><p><img src="/uploads/storyboard-in-macos/6D230E15-056A-495D-8063-96FA6F4E9792.png" alt></p><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä¸€åˆ‡éƒ½è¿˜æ˜¯åˆä¹é€»è¾‘çš„ï¼Œç›´åˆ°æŸå¤©æˆ‘æ‰‹è´±æŠŠ Main.storyboard åˆ æ‰äº†â€¦</p><h2 id="è‡ªå®šä¹‰-storyboard">è‡ªå®šä¹‰ Storyboard</h2><p>æŒ‰ç…§æˆ‘ä»¬åœ¨ iOS é‡Œå­¦æ¥çš„ç»éªŒï¼Œè¿™æ²¡ä»€ä¹ˆå¤§ä¸äº†çš„å˜›ï¼</p><p>è®©æˆ‘ä»¬é‡æ–°åˆ›å»ºä¸€ä¸ª Storyboard<br><img src="/uploads/storyboard-in-macos/AAA78593-47E1-4E34-A6FE-34D08C3D5328.png" alt></p><p>æ‹–ä¸€ä¸ª â€œWindow Controllerâ€ å‡ºæ¥ï¼Œç¨‹åºå…¥å£ä¹Ÿè¦è®¾ç½®ä¸Šï¼ˆå°±æ˜¯å›¾ç‰‡ä¸­é—´é‚£ä¸ªå°ç®­å¤´ï¼Œä½ç½®åœ¨ Window Controller -&gt; Attributes Inspector -&gt; â€œIs Initial Controllerâ€ï¼‰<br><img src="/uploads/storyboard-in-macos/7BCBD120-A01E-48A9-9146-9A07CD956C81.png" alt></p><p>ç„¶ååˆ°é¡¹ç›®é…ç½®é‡Œè®¾ç½®ä¸€ä¸‹<br><img src="/uploads/storyboard-in-macos/35E29846-E2B3-4A94-A221-C9CB866FFC42.png" alt></p><p>Doneï¼å¥½åƒå¿˜äº†ç‚¹ä»€ä¹ˆâ€¦ä¸è¿‡å…ˆè·‘èµ·æ¥çœ‹çœ‹ï¼<br><img src="/uploads/storyboard-in-macos/7AC50D3E-EF1B-43AE-80CE-0D12D5520CFE.png" alt></p><p>Emmmâ€¦.èœå•æ ä½ æ€ä¹ˆäº†ï¼æˆ‘çš„èœå•æ å‘¢ï¼</p><h2 id="æ‹¯æ•‘è¢«è¯¯åˆ çš„-main-storyboard">æ‹¯æ•‘è¢«è¯¯åˆ çš„ Main.storyboard</h2><p>å›åˆ°æ–°å»ºçš„ â€Main.storyboardâ€œ é‡Œç…ç…ï¼Œå‘ç°è·Ÿè‡ªå¸¦çš„ Storyboard ç›¸æ¯”ï¼Œå°‘äº† â€œMain Menuâ€œ è¿™ä¸ªç©æ„å„¿ï¼Œç›¸åº”çš„ï¼Œåœ¨å·¦è¾¹çš„åœºæ™¯åˆ—è¡¨é‡Œï¼Œåº”è¯¥è¦æœ‰ä¸€ä¸ªå« â€œApplication Sceneâ€ çš„åœºæ™¯ã€‚</p><p><img src="/uploads/storyboard-in-macos/BCD3A74F-812C-47F1-992C-E8BA3E1B5EE1.png" alt></p><p>ç¿»éäº†æ§ä»¶åº“ï¼Œéƒ½æ²¡æœ‰æ‰¾åˆ°ä»»ä½•ä¸ â€œApplicationâ€ å’Œ â€œMain Menuâ€ ç›¸å…³çš„ä¸œè¥¿ï¼Œæœ€ååœ¨ä¸€ä¸ª StackOverflow çš„é—®é¢˜é‡Œæ‰¾åˆ°äº†ç­”æ¡ˆ</p><blockquote><p><a href="https://stackoverflow.com/questions/24418936/create-application-scene-in-blank-os-x-storyboard" target="_blank" rel="noopener">macos - Create Application Scene in blank OS X Storyboard - Stack Overflow</a></p></blockquote><p>ç®€å•æ€»ç»“ä¸€ä¸‹å°±æ˜¯ï¼šå³ä½¿æ—¶éš”å¤šå¹´ï¼ŒmacOS ä¸Šè¿˜æ˜¯ä¸æ€ä¹ˆæ”¯æŒè®©ä¸€ä¸ªä¸æ˜¯åŸºäº Storyboard å¼€å‘çš„åº”ç”¨å‡çº§åˆ°ä½¿ç”¨ Storyboard çš„ç‰ˆæœ¬ï¼Œæ‰€ä»¥æ§ä»¶åº“é‡Œå‹æ ¹å°±æ²¡æœ‰æä¾› Application Sceneã€‚</p><p>éš¾é“å°±æ²¡æœ‰åŠæ³•äº†ï¼Ÿ</p><p>è™½ç„¶æ²¡æœ‰è¯•è¿‡åœ¨é Storyboard é¡¹ç›®ä¸Šé›†æˆ Storyboardï¼Œä½†æ˜¯å¯¹äºè¯¯åˆ çš„æƒ…å†µè¿˜æ˜¯æœ‰æ•‘çš„ï¼šï¼ˆç­”æ¡ˆä¹Ÿæ¥è‡ªäºä¸Šé¢çš„é“¾æ¥é‡Œï¼‰</p><ol><li>åˆ›å»ºä¸€ä¸ªæ–°çš„ã€å¸¦ Storyboard çš„é¡¹ç›®</li><li>æŸ¥çœ‹æ–°é¡¹ç›®é‡Œçš„ Main.storyboard çš„æºç </li><li>å°†ä¸‹å›¾ <code>&lt;!--Application--&gt;</code> æ³¨é‡Šä¸‹é¢çš„ <code>&lt;Scene&gt;...&lt;/Scene&gt;</code> çš„å…¨éƒ¨å†…å®¹éƒ½æ‹·è´åˆ°æˆ‘ä»¬åˆšåˆšæ–°åˆ›å»ºçš„ Storyboard é‡Œé¢<br><img src="/uploads/storyboard-in-macos/35685F05-E093-4A08-93B4-80332BE704B0.png" alt></li></ol><p>ä¿å­˜åé‡æ–°æ‰“å¼€ Storyboardï¼Œä½ ä¼šå‘ç°ä¸–ç•Œåˆæ¢å¤åˆ°åŸæœ¬çš„æ ·å­äº†ï¼æˆ‘ä»¬çš„èœå•æ ç»ˆäºåˆå›æ¥äº†ï¼</p><p>å½“ç„¶ï¼Œå› ä¸ºæ˜¯å¤åˆ¶ç²˜è´´è¿‡æ¥çš„ï¼Œèœå•æ é‡Œçš„ä¸€äº›ä¿¡æ¯è¿˜æ˜¯æ–°é¡¹ç›®é‡Œçš„æ ·å­ï¼Œåœ¨ Storyboard ç¨åŠ ä¿®æ”¹å°±å¯ä»¥äº†ã€‚</p><h2 id="æ€»ç»“">æ€»ç»“</h2><p>è™½è¯´é•¿å¾—å·®ä¸å¤šï¼Œä½† macOS å¼€å‘é‡Œç”¨åˆ°çš„ Storyboard å’Œ iOS ä¸Šçš„è¿˜æ˜¯æœ‰ä¸å°‘çš„å‡ºå…¥ã€‚</p><p>æ¯”å¦‚æœ‰æ—¶å€™ IB é‡Œä¿®æ”¹äº†æ–‡æ¡ˆï¼Œä½†æ˜¯è·‘èµ·æ¥å´ä¸ä¸€æ ·äº†ï¼Œé‚£å¯èƒ½æ˜¯ Storyboard ç”Ÿæˆäº†å›½é™…åŒ–é…ç½®æ–‡ä»¶ï¼Œåœ¨é‡Œé¢æœç´¢ä¸€ä¸‹ä¹Ÿè®¸ä¼šæ‰¾åˆ°å…ƒå‡¶ï¼š<br><img src="/uploads/storyboard-in-macos/E490581B-53D5-4537-97B2-FC377985545E.png" alt></p><p>è€Œæ›´å¤šçš„æ—¶å€™ï¼Œåœ¨ IB é‡Œè°ƒæ•´äº†é¢œè‰²ä¹‹ç±»çš„é…ç½®æ˜¯ä¸èƒ½ç›´æ¥çœ‹åˆ°æ•ˆæœçš„ï¼Œè¿˜æ˜¯è¦è·‘èµ·æ¥éªŒè¯ä¸€ä¸‹ï¼Œä»¥å®é™…è¿è¡Œæ•ˆæœä¸ºå‡†ã€‚</p><p>æ€»è€Œè¨€ä¹‹ï¼Œåœ¨ macOS å¼€å‘è¿‡ç¨‹ä¸­ä½¿ç”¨ Storyboard éœ€è¦æ›´å¤šçš„è€å¿ƒå’Œå®é™…è¿è¡ŒéªŒè¯ï¼Œè¿™æ ·çš„æƒ…å†µä¹Ÿè®¸è¦åˆ° macOS æ”¯æŒ UIKit çš„æ—¶å€™æ‰èƒ½æ”¹å–„äº†ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä» iOS è½¬æ¥ macOS é˜µè¥å·²ç»æœ‰å‡ ä¸ªæœˆäº†ï¼Œæ–­æ–­ç»­ç»­è¸©äº†ä¸€äº›è¿™æ ·é‚£æ ·çš„å‘ï¼Œç‰¹æ­¤å†™ä¸€ä¸ªç³»åˆ—è®°å½•ä¸‹æ¥ã€‚è¿™ä¸ªç³»åˆ—ç¢°åˆ°çš„é—®é¢˜éƒ½æ˜¯å·²ç»æ‰¾åˆ°äº†è§£å†³æ–¹æ³•çš„ï¼Œå¸Œæœ›å¯¹å…¶ä»–äººä¹Ÿèƒ½æœ‰äº›å¸®åŠ©ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;è¿™æ˜¯ macOS å¼€å‘ç³»åˆ—çš„ç¬¬ä¸€ç¯‡æ–‡ç« ã€‚&lt;/p&gt;
&lt;p&gt;ä»é¡¹ç›®å¼€å§‹çš„åœ°æ–¹è®²èµ· â€”â€” Storyboardã€‚&lt;/p&gt;
&lt;/blockquote&gt;
    
    </summary>
    
    
      <category term="Swift" scheme="http://davidleee.com/tags/Swift/"/>
    
      <category term="macOS" scheme="http://davidleee.com/tags/macOS/"/>
    
  </entry>
  
  <entry>
    <title>å°å¿ƒé¿å¼€ RxSwift é‡Œçš„å‘ï¼ˆTop Mistakes in RxSwift you want to avoidï¼‰</title>
    <link href="http://davidleee.com/2018/04/24/Top-Mistakes-in-RxSwift/"/>
    <id>http://davidleee.com/2018/04/24/Top-Mistakes-in-RxSwift/</id>
    <published>2018-04-24T00:56:05.000Z</published>
    <updated>2020-05-05T03:43:31.442Z</updated>
    
    <content type="html"><![CDATA[<p>æ¯å½“æˆ‘ä»¬è¦å­¦ä¹ ä¸€æ ·æ–°çš„è¯­è¨€æˆ–è€…æ¡†æ¶æ—¶ï¼Œæ€»æ˜¯ä¼šçŠ¯ä¸‹è¿™æ ·é‚£æ ·çš„é”™è¯¯ã€‚è¿™å°±æ˜¯äººç±»å­¦ä¹ æ–°çŸ¥è¯†çš„æ–¹æ³•ã€‚ä¸‹æ–‡åˆ—å‡ºäº†ä¸€äº›ä½¿ç”¨ RxSwift è¿‡ç¨‹ä¸­å¸¸è§çš„é”™è¯¯ï¼Œä¾›å¤§å®¶å‚è€ƒã€‚</p><a id="more"></a><p>åŸæ–‡é“¾æ¥åœ¨æ–‡æœ«ã€‚</p><h2 id="combinelatest-vs-withlatestfrom">combineLatest vs withLatestFrom</h2><p>å‰è€…ä¼šåœ¨å†…éƒ¨çš„ä»»æ„ä¸€ä¸ª Observable å‘å‡ºæ¶ˆæ¯æ—¶å‘å‡ºä¸€ä¸ªæ€»çš„æ¶ˆæ¯ï¼Œæ‰€ä»¥æŠŠä¸¤ä¸ªæŒ‰é’®çš„ tap äº‹ä»¶ combineLatest ä¸æ˜¯ä¸€ä¸ªåˆç†çš„åšæ³•ã€‚è¿™ç§æƒ…å†µå°±è¦çœ‹çœ‹åè€…çš„ä½¿ç”¨æ–¹å¼äº†ã€‚</p><h2 id="observable-åº”è¯¥å»¶è¿Ÿåˆå§‹åŒ–">Observable åº”è¯¥å»¶è¿Ÿåˆå§‹åŒ–</h2><p>å½“ä¸€ä¸ª Observable æ˜¯ä¸ºäº†æŠŠè€—æ—¶æ“ä½œçš„ç»“æœé€šçŸ¥å‡ºå»æ—¶ï¼Œè¿™ä¸ª Observable æœ¬èº«åº”è¯¥è¢«å»¶è¿Ÿåˆå§‹åŒ–ï¼Œè¿™æ ·æ‰èƒ½é¿å…åœ¨æœ‰äºº subscribe ä¹‹å‰å°±åœ¨åšé‚£ä¸ªè€—æ—¶æ“ä½œã€‚<br>ä¸¾ä¸ªæ —å­ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">rx_myFunction</span><span class="params">()</span></span> -&gt; <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">let</span> someCalculationResult: <span class="type">Int</span> = calculate()</span><br><span class="line">    <span class="keyword">return</span> .just(someCalculationResult)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>calculte()</code> æ˜¯ä¸€ä¸ªè€—æ—¶æ“ä½œï¼Œè¿™æ ·ç”¨æˆ·åœ¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•çš„æ—¶å€™å°±å·²ç»åœ¨è·‘çœŸæ­£çš„è®¡ç®—äº†ï¼Œè€Œæˆ‘ä»¬å†™è¿™ä¸ªæ–¹æ³•çš„æœ¬æ„åº”è¯¥æ˜¯æœ‰äºº subscribe çš„æ—¶å€™æ‰å»æ‰§è¡Œæ“ä½œã€‚æ‰€ä»¥ä¸Šé¢çš„æ–¹æ³•åº”è¯¥åšä¸€ä¸‹è¿™æ ·çš„å°ä¿®æ”¹ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">rx_myFunction</span><span class="params">()</span></span> -&gt; <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="type">Observable</span>.deferred &#123;</span><br><span class="line">        <span class="keyword">let</span> someCalculationResult: <span class="type">Int</span> = <span class="keyword">self</span>.calculate()</span><br><span class="line">        <span class="keyword">return</span> .just(someCalculationResult)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="disposebag-çš„é”™è¯¯ä½¿ç”¨">DisposeBag çš„é”™è¯¯ä½¿ç”¨</h2><p>è¿™ç©æ„å„¿çš„ä½œç”¨æ˜¯æŠŠä¸€å † <code>Disposable</code> åœ¨æŸä¸ªå¯¹è±¡ <code>deinit</code> çš„æ—¶å€™å…¨éƒ¨ç»“æŸæ‰ï¼Œæ‰€ä»¥è¿™ä¸ªç®¡ç†å¯¹è±¡çš„é€‰æ‹©å°±å°¤ä¸ºé‡è¦ã€‚</p><p>æ¯”å¦‚æˆ‘ä»¬åœ¨ tableViewCell é‡Œé¢è¿›è¡Œäº†ä¸€äº›è®¢é˜…ï¼Œè¯¥ç”¨çš„ DisposeBag æ˜¯ cell æœ¬èº«å£°æ˜çš„ä¸€ä¸ªå±æ€§ï¼Œè€Œä¸åº”è¯¥ç›´æ¥ç”¨ VC é‡Œé¢çš„é‚£ä¸ªï¼Œå› ä¸º cell ä¼šå‘ç”Ÿé‡ç”¨ï¼Œæ‰€ä»¥è¿™é‡Œçš„ Disposable çš„ç®¡ç†åº”è¯¥æ›´ç§¯æä¸€ç‚¹ï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">dataSource.configureCell = &#123; <span class="number">_</span>, tableView, indexPath, cellViewModel <span class="keyword">in</span></span><br><span class="line"><span class="keyword">let</span> cell: <span class="type">TheCell</span> = tableView.dequeueCell(at: indexPath)</span><br><span class="line">cellViewModel.image</span><br><span class="line">.drive(cell.avatarView.image)</span><br><span class="line">.disposed(by: cell.disposeBag)</span><br><span class="line"><span class="keyword">return</span> cell</span><br><span class="line">&#125;</span><br><span class="line">        </span><br><span class="line"><span class="comment">//somewhere in TheCell.swift file</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TheCell</span>: <span class="title">UITableViewCell</span> </span>&#123;</span><br><span class="line"><span class="keyword">private</span>(<span class="keyword">set</span>) <span class="keyword">var</span> disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line">    </span><br><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">prepareForReuse</span><span class="params">()</span></span> &#123;</span><br><span class="line">disposeBag = <span class="type">DisposeBag</span>()</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ²¡æœ‰åœ¨-ui-å±‚ä½¿ç”¨-drivers">æ²¡æœ‰åœ¨ UI å±‚ä½¿ç”¨ drivers</h2><p>Driver çš„è®¾è®¡æ˜¯ä¸ºäº†é¿å…çº¿ç¨‹çš„æ··ä¹±ï¼Œå¯¹äº Driver çš„è®¢é˜…çš„é€šçŸ¥éƒ½ä¼šå‘ç”Ÿåœ¨ä¸»çº¿ç¨‹ä¸Šï¼Œæ‰€ä»¥å¯ä»¥é™ä½çº¿ç¨‹é—®é¢˜çš„æ¦‚ç‡ã€‚å…·ä½“è¦çœ‹çœ‹è¿™ä¸ªä¸œè¥¿çš„è¯¦ç»†ç”¨æ³•ã€‚</p><h2 id="å¼‚å¸¸å¤„ç†">å¼‚å¸¸å¤„ç†</h2><p>å½“ Observable æŠ›å‡ºå¼‚å¸¸çš„æ—¶å€™ï¼Œå®ƒä¼šç»ˆæ­¢æ•´ä¸ªæµç¨‹ã€‚å¦‚æœä½¿ç”¨äº† <code>flatMap</code> è¿™ç±»è½¬æ¢æ–¹æ³•ï¼Œé‚£æŠ›å‡ºå¼‚å¸¸çš„æ—¶å€™è¢«ç»ˆæ­¢çš„æ˜¯æºå¤´çš„ä¸»æµç¨‹ã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæŠŠä¸€ä¸ªå¯èƒ½æŠ›å‡ºå¼‚å¸¸çš„æµç¨‹ç»‘å®šåˆ°äº†æŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶ä¸Šï¼Œä¸€æ—¦è¿™ä¸ªæµç¨‹æŠ›å‡ºäº†å¼‚å¸¸ï¼ŒæŒ‰é’®çš„ç‚¹å‡»äº‹ä»¶å°±å†ä¹Ÿä¸ä¼šå“åº”äº†ã€‚</p><p>è§£å†³æ–¹æ³•æ˜¯ä½¿ç”¨ <code>Observable&lt;Result&lt;User&gt;&gt;</code> æˆ–è€… <code>materialize()</code> ä¹‹ç±»çš„æ–¹æ³•ã€‚</p><h2 id="åŒä¸€ä¸ª-observable-è®¢é˜…å¤šæ¬¡">åŒä¸€ä¸ª Observable è®¢é˜…å¤šæ¬¡</h2><p>Observable æ˜¯ä¸å¯å˜çš„ç±»ã€‚æ¯ä¸€ä¸ªå¤„ç†æ–¹æ³•éƒ½æ˜¯è¿”å›ä¸€ä¸ªæ–°çš„ Observable è€Œä¸ä¼šå¯¹åŸæ¥çš„é‚£ä¸ªåšä»»ä½•å˜åŠ¨ã€‚</p><p>åœ¨éœ€è¦å…±äº«æŸäº›æµç¨‹çš„ç»“æœæ—¶ï¼Œå¯èƒ½ä¼šå¯¹æŸä¸ª Observable è¿›è¡Œåˆ†åˆ«å¤„ç†å’Œè®¢é˜…ï¼Œè¿™æ—¶å€™å°±åº”è¯¥ç”¨ <code>share</code> æˆ–è€… <code>shareReplay(1)</code> æ¥é¿å…äº‹ä»¶çš„é‡å¤å‘å‡ºï¼š</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> items: <span class="type">Observable</span>&lt;[<span class="type">Item</span>]&gt; = itemsProvider.items</span><br><span class="line">.share()</span><br><span class="line">    </span><br><span class="line"><span class="keyword">let</span> <span class="built_in">count</span>: <span class="type">Observable</span>&lt;<span class="type">Int</span>&gt; = items</span><br><span class="line">.<span class="built_in">map</span> &#123; $<span class="number">0</span>.<span class="built_in">count</span> &#125;</span><br><span class="line">    </span><br><span class="line">items.subscribe(onNext: &#123; items <span class="keyword">in</span> </span><br><span class="line"><span class="comment">//do something with items</span></span><br><span class="line">&#125;) </span><br><span class="line">    </span><br><span class="line">numberOfItems.subscribe(onNext: &#123; <span class="built_in">count</span> <span class="keyword">in</span> </span><br><span class="line"><span class="comment">//do something with count</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœä¸åŠ  <code>share()</code>ï¼Œä¸‹é¢çš„ä¸¤æ¬¡ <code>subscribe</code> å°±ä¼šè§¦å‘ä¸¤æ¬¡ <code>itemProvider.items</code> çš„ <code>get</code> æ–¹æ³•ï¼Œä½†æ˜¯æ˜¾ç„¶æˆ‘ä»¬åªéœ€è¦è·å–ä¸€æ¬¡å°±å¯ä»¥æ»¡è¶³ä¸‹é¢ä¸¤ä¸ªè®¢é˜…äº†</p></blockquote><h2 id="è¿‡åº¦ä½¿ç”¨-subjects-variables">è¿‡åº¦ä½¿ç”¨ subjects &amp; variables</h2><p>Rx çš„ä¸–ç•Œåº”è¯¥æ˜¯ç”±â€œä¸å¯å˜å˜é‡â€ç»„æˆçš„ï¼Œä¸€æ—¦ä¸€ä¸ªäº‹ä»¶å·²ç»å½¢æˆï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸åº”è¯¥å¯¹å®ƒæœ¬èº«åšå‡ºä»»ä½•æ”¹åŠ¨ï¼Œè€Œæ˜¯æ“ä½œäº‹ä»¶çš„æµå‘æœ€ç»ˆå¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ç»“æœã€‚</p><p>è€Œ Subjects &amp; Variables æ­£æ˜¯ Rx ä¸–ç•Œé‡Œçš„â€œå¯å˜å˜é‡â€ã€‚</p><p>ä¸æ˜¯è¯´ä¸èƒ½ç”¨å®ƒä»¬ï¼Œè€Œæ˜¯è¯´æˆ‘ä»¬åœ¨å¤§å¤šæ•°æ—¶å€™å¹¶ä¸éœ€è¦ç”¨ä¸Šå®ƒä»¬ã€‚åœ¨æ›´å¤šæƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨ <code>merge</code> ã€<code>concat</code>ã€<code>publish</code>&amp;<code>refCount</code> ã€<code>defer</code> å’Œå…¶ä»–ä¸€äº›æ–¹æ³•å»æ›¿ä»£è¿™ä¸¤ä¸ªç©æ„å„¿ã€‚</p><ul><li>åŸæ–‡é“¾æ¥ï¼š<a href="http://adamborek.com/top-7-rxswift-mistakes/" target="_blank" rel="noopener">Top mistakes in RxSwift you want to avoid - Code in a suit</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ¯å½“æˆ‘ä»¬è¦å­¦ä¹ ä¸€æ ·æ–°çš„è¯­è¨€æˆ–è€…æ¡†æ¶æ—¶ï¼Œæ€»æ˜¯ä¼šçŠ¯ä¸‹è¿™æ ·é‚£æ ·çš„é”™è¯¯ã€‚è¿™å°±æ˜¯äººç±»å­¦ä¹ æ–°çŸ¥è¯†çš„æ–¹æ³•ã€‚ä¸‹æ–‡åˆ—å‡ºäº†ä¸€äº›ä½¿ç”¨ RxSwift è¿‡ç¨‹ä¸­å¸¸è§çš„é”™è¯¯ï¼Œä¾›å¤§å®¶å‚è€ƒã€‚&lt;/p&gt;
    
    </summary>
    
    
      <category term="Swift" scheme="http://davidleee.com/tags/Swift/"/>
    
      <category term="Reactive" scheme="http://davidleee.com/tags/Reactive/"/>
    
      <category term="RxSwift" scheme="http://davidleee.com/tags/RxSwift/"/>
    
  </entry>
  
</feed>
